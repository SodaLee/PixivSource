[
    {
        "bookSourceComment": "Pixiv Â∞èËØ¥ÔºàÊõ¥Êñ∞üìÜÔºö2025-10-08Ôºâ\n\n‰π¶Ê∫êÁâàÊú¨Ôºö2.3.8\n‰ΩøÁî®ËØ¥ÊòéÔºöüìåÈòÖËØªÁâàÊú¨ 3.25.0527 Âèä‰πãÂêéÁâàÊú¨ÂèØÁî®\nÂèØÁî®ÂäüËÉΩÔºö‚úÖÊêúÁ¥¢‚úÖÂèëÁé∞‚úÖÊ∑ªÂä†ÁΩëÂùÄ‚úÖËÆ¢ÈòÖÊ∫ê\nÊêúÁ¥¢Â∞èËØ¥Ôºö‚úÖÂçïÁØá‚úÖÁ≥ªÂàó‚úÖÊ†áÁ≠æ‚úÖ‰ΩúËÄÖ\nÂèëÁé∞Â∞èËØ¥Ôºö‚úÖÂÖ≥Ê≥®‚úÖËøΩÊõ¥‚úÖÊé®Ëçê‚úÖÂèëÁé∞\nÂèëÁé∞Â∞èËØ¥Ôºö‚úÖÊî∂Ëóè‚úÖ‰π¶Á≠æ‚úÖÈ¶ñÈ°µ‚úÖÊéíË°å\nÊ∑ªÂä†ÁΩëÂùÄÔºö‚úÖÂ∞èËØ¥‚úÖÁ≥ªÂàó‚úÖ‰ΩúËÄÖ\nËÆ¢ÈòÖÁî®Ê≥ïÔºöÁÇπÂáªËÆ¢ÈòÖÊ∫êÊâìÂºÄÂ∞èËØ¥/Á≥ªÂàóÂ∞èËØ¥Ôºå„ÄêÂà∑Êñ∞„ÄëÔºåÁÇπÂáª„ÄêÂä†ÂÖ•‰π¶Êû∂„ÄëÊåâÈíÆÔºåÊ∑ªÂä†Âà∞‰π¶Êû∂\n\n‰π¶Ê∫êÂèëÂ∏ÉÔºöÂÖΩ‰∫∫ÈòÖËØªÈ¢ëÈÅì https://t.me/FurryReading\nÈ°πÁõÆÂú∞ÂùÄÔºöhttps://github.com/windyhusky/PixivSource\n‰ΩøÁî®ÊïôÁ®ãÔºöhttps://github.com/windyhusky/PixivSource/blob/main/doc/Pixiv.md\n\nËßÑÂàôËÆ¢ÈòÖÔºöimport ËÆ¢ÈòÖÊ∫ê\nhttps://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/import.json\nhttps://raw.githubusercontent.com/windyhusky/PixivSource/main/import.json\n\n‚öôÔ∏è ‰π¶Ê∫êËÆæÁΩÆÔºö\nËÆæÁΩÆ1Ô∏è‚É£ÔºöÊâìÂºÄÂ∞èËØ¥ - ËèúÂçï - ÁôªÂΩï - ÁÇπÂáª‰∏ãÊñπÊåâÈíÆ\nËÆæÁΩÆ2Ô∏è‚É£ÔºöÁºñËæë‰π¶Ê∫ê - Âü∫Êú¨ - ÂèòÈáèËØ¥Êòé - ‰øÆÊîπÂπ∂‰øùÂ≠ò\n\nüö´ Â±èËîΩ‰ΩúËÄÖ(Êú¨Âú∞)Ôºö\n‚ñ∂Ô∏èËÆæÁΩÆÊñπÊ≥ïÔºöÊâìÂºÄÂ∞èËØ¥ - ËèúÂçï - ÁôªÂΩï - üö´ Â±èËîΩ‰ΩúËÄÖ\n\nüö´ Â±èËîΩÊ†áÁ≠æ/ÊèèËø∞(Êú¨Âú∞)Ôºö\n1Ô∏è‚É£ÁºñËæë‰π¶Ê∫êÔºöËèúÂçï - ÁôªÂΩï - ÁÇπÂáª„Äê üëÄ Êü•ÁúãÂ±èËîΩ„Äë\n2Ô∏è‚É£ÂàáÊç¢ÂàóË°®ÔºöÁÇπÂáªÊåâÈíÆÔºåÂàáÊç¢Ëá≥„ÄêÁõ∏Â∫îÂ±èËîΩÂàóË°®„Äë\n3Ô∏è‚É£ËæìÂÖ•ÂÜÖÂÆπÔºöÂú®„ÄêËæìÂÖ•ÂÜÖÂÆπ„ÄëÂ§ÑËæìÂÖ•Â±èËîΩÂÜÖÂÆπ\n4Ô∏è‚É£Â±èËîΩ‰ΩúËÄÖÔºöÁÇπÂáª„Äêüö´ Âä†ÂÖ•Â±èËîΩ„ÄëÔºåÂ±èËîΩËØ•ÂÜÖÂÆπ\n\nüìå ÂñúÊ¨¢Ê†áÁ≠æ(Êú¨Âú∞)Ôºö\n1Ô∏è‚É£ÁºñËæë‰π¶Ê∫êÔºöËèúÂçï - ÁôªÂΩï ÔºåÊâæÂà∞ËæìÂÖ•ÂÜÖÂÆπ\n2Ô∏è‚É£ËæìÂÖ•ÂÜÖÂÆπÔºöËæìÂÖ•Ê†áÁ≠æÔºåÁÇπÂáª„Äêüìå ÂñúÊ¨¢Ê†áÁ≠æ„Äë\n\n‚ù§Ô∏è Êü•Áúã‰ªñ‰∫∫Êî∂ËóèÔºö\n1Ô∏è‚É£ÁºñËæë‰π¶Ê∫êÔºöËèúÂçï - ÁôªÂΩï ÔºåÊâæÂà∞ËæìÂÖ•ÂÜÖÂÆπ\n2Ô∏è‚É£ËæìÂÖ•ÂÜÖÂÆπÔºöËæìÂÖ•‰ΩúËÄÖIDÔºåÁÇπÂáª„Äê‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè„Äë",
        "bookSourceGroup": "üîû Pixiv",
        "bookSourceName": "üÖøÔ∏è Pixiv Â∞èËØ¥",
        "bookSourceType": 0,
        "bookSourceUrl": "https://www.pixiv.net/novel",
        "bookUrlPattern": "(https?://)?(www\\.)?pixiv\\.net(/ajax)?/(novel/(show\\.php\\?id=|series/)?|users?/)\\d+.*",
        "concurrentRate": "3/2000",
        "customOrder": 0,
        "enabled": true,
        "enabledCookieJar": true,
        "enabledExplore": true,
        "exploreUrl": "@js:\nlet SHOW_R18_GENRE, SHOW_GENERAL_NEW, SHOW_GENERAL_RANK, SHOW_GENERAL_GENRE\ntry {\n    settings = JSON.parse(String(source.variableComment).match(RegExp(/{([\\s\\S]*?)}/gm)))\n    SHOW_R18_GENRE = settings.SHOW_R18_GENRE         // ÂèëÁé∞ÔºöÁÉ≠Èó®ÂàÜÁ±ªÊòæÁ§∫R18Â∞èËØ¥\n    SHOW_GENERAL_NEW = settings.SHOW_GENERAL_NEW     // ÂèëÁé∞ÔºöÊúÄÊñ∞„ÄÅ‰ºÅÂàí„ÄÅÁ∫¶Á®øÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n    SHOW_GENERAL_RANK = settings.SHOW_GENERAL_RANK   // ÂèëÁé∞ÔºöÊéíË°åÊ¶úÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n    SHOW_GENERAL_GENRE = settings.SHOW_GENERAL_GENRE // ÂèëÁé∞ÔºöÁÉ≠Èó®ÂàÜÁ±ªÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n} catch (e) {\n    SHOW_R18_GENRE = false\n    SHOW_GENERAL_NEW = false\n    SHOW_GENERAL_RANK = false\n    SHOW_GENERAL_GENRE = false\n}\n\nli = [\n    {\"‚≠êÔ∏è ÂÖ≥Ê≥®\": \"https://www.pixiv.net/ajax/follow_latest/novel?p={{page}}&mode=r18&lang=zh\"},\n    {\"üìÉ ËøΩÊõ¥\": \"https://www.pixiv.net/ajax/watch_list/novel?p={{page}}&new=1&lang=zh\"},\n    {\"üíØ Êé®Ëçê\": \"https://www.pixiv.net/ajax/top/novel?mode=r18&lang=zh\"},\n    {\"üîç ÂèëÁé∞\": \"https://www.pixiv.net/ajax/novel/discovery?mode=r18&lang=zh\"},\n    {\"‚ù§Ô∏è Êî∂Ëóè\": \"https://www.pixiv.net/ajax/user/{{cache.get(\\\"pixiv:uid\\\")}}/novels/bookmarks?tag=&offset={{(page-1)*24}}&limit=24&rest=show&lang=zh\"},\n    {\"„äôÔ∏è Êî∂Ëóè\": \"https://www.pixiv.net/ajax/user/{{cache.get(\\\"pixiv:uid\\\")}}/novels/bookmarks?tag=&offset={{(page-1)*24}}&limit=24&rest=hide&lang=zh\"},\n    {\"üè∑Ô∏è ‰π¶Á≠æ\": \"https://www.pixiv.net/novel/marker_all.php\"},\n    {\"üè† È¶ñÈ°µ\": \"https://www.pixiv.net\"},\n]\n\nnormal = [\n    {\"‚úÖ Â∏∏ËßÑ Â∞èËØ¥ Êé®Ëçê ‚úÖ\": \"\"},\n    {\"‚≠êÔ∏è ÂÖ≥Ê≥®\": \"https://www.pixiv.net/ajax/follow_latest/novel?p={{page}}&mode=all&lang=zh\"},\n    {\"üíØ Êé®Ëçê\": \"https://www.pixiv.net/ajax/top/novel?mode=all&lang=zh\"},\n    {\"üîç ÂèëÁé∞\": \"https://www.pixiv.net/ajax/novel/discovery?mode=safe&lang=zh\"},\n    {\"üÜô Êõ¥Êñ∞\": \"https://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/pixiv.json\"},\n]\n\nr18New = [\n    {\"üÜï ÊúÄÊñ∞ ‰ºÅÂàí Á∫¶Á®ø üí∞\": \"\"},\n    {\"üÜï ÊúÄÊñ∞\": \"https://www.pixiv.net/ajax/novel/new?lastId=0&limit=20&r18=true&lang=zh\"},\n    {\"üìë ‰ºÅÂàí\": \"https://www.pixiv.net/ajax/user_event/portal/novels?mode=r18&p={{page}}&lang=zh\"},\n    {\"üí∞ Á∫¶Á®ø\": \"https://www.pixiv.net/ajax/commission/page/request/complete/novels?mode=r18&p={{page}}&lang=zh\"},\n    {\"üîç ÂèëÁé∞\": \"https://www.pixiv.net/ajax/novel/discovery?mode=all&lang=zh\"},\n]\n\ngeneralNew = [\n    {\"‚úÖ ÊúÄÊñ∞ ‰ºÅÂàí Á∫¶Á®ø ‚úÖ\": \"\"},\n    {\"ÊúÄÊñ∞\": \"https://www.pixiv.net/ajax/novel/new?lastId=0&limit=20&r18=false&lang=zh\"},\n    {\"‰ºÅÂàí\": \"https://www.pixiv.net/ajax/user_event/portal/novels?mode=all&p={{page}}&lang=zh\"},\n    {\"Á∫¶Á®ø\": \"https://www.pixiv.net/ajax/commission/page/request/complete/novels?mode=all&p={{page}}&lang=zh\"},\n    {\"ÁºñËæë\": \"https://www.pixiv.net/novel/editors_picks\"},\n]\n\nr18Rank = [\n    {\"üëë ÊéíË°åÊ¶úÂçï üëë\": \"\"},\n    {\"‰ªäÊó•\": \"https://www.pixiv.net/novel/ranking.php?mode=daily_r18\"},\n    {\"Êú¨Âë®\": \"https://www.pixiv.net/novel/ranking.php?mode=weekly_r18\"},\n    {\"R18G\": \"https://www.pixiv.net/novel/ranking.php?mode=r18g\"},\n    {\"Áî∑ÊÄß\": \"https://www.pixiv.net/novel/ranking.php?mode=male_r18\"},\n    {\"Â•≥ÊÄß\": \"https://www.pixiv.net/novel/ranking.php?mode=female_r18\"}\n]\n\ngeneralRank = [\n    {\"üèÜ ÊéíË°åÊ¶úÂçï üèÜ\": \"\"},\n    {\"‰ªäÊó•\": \"https://www.pixiv.net/novel/ranking.php?mode=daily\"},\n    {\"Êú¨Âë®\": \"https://www.pixiv.net/novel/ranking.php?mode=weekly\"},\n    {\"Êú¨Êúà\": \"https://www.pixiv.net/novel/ranking.php?mode=monthly\"},\n    {\"Áî∑ÊÄß\": \"https://www.pixiv.net/novel/ranking.php?mode=male\"},\n    {\"Â•≥ÊÄß\": \"https://www.pixiv.net/novel/ranking.php?mode=female\"},\n    {\"Êñ∞‰∫∫\": \"https://www.pixiv.net/novel/ranking.php?mode=rookie\"},\n    {\"ÂéüÂàõ\": \"https://www.pixiv.net/novel/ranking.php?mode=weekly_original\"},\n    {\"AIÁîüÊàê\": \"https://www.pixiv.net/novel/ranking.php?mode=weekly_ai\"}\n]\n\nr18Genre = [\n    {\"üî• ÂéüÂàõÁÉ≠Èó® üî•\": \"\"},\n    {\"Áî∑ÊÄß\": \"https://www.pixiv.net/ajax/genre/novel/male?mode=r18&lang=zh\"},\n    {\"Â•≥ÊÄß\": \"https://www.pixiv.net/ajax/genre/novel/female?mode=r18&lang=zh\"},\n    {\"ÊÅãÁà±\": \"https://www.pixiv.net/ajax/genre/novel/romance?mode=r18&lang=zh\"},\n    {\"ÂºÇ‰∏ñÁïåÂ•áÂπª\": \"https://www.pixiv.net/ajax/genre/novel/isekai_fantasy?mode=r18&lang=zh\"},\n    {\"Áé∞‰ª£Â•áÂπª\": \"https://www.pixiv.net/ajax/genre/novel/contemporary_fantasy?mode=r18&lang=zh\"},\n    {\"ÊÇ¨Áñë\": \"https://www.pixiv.net/ajax/genre/novel/mystery?mode=r18&lang=zh\"},\n    {\"ÊÅêÊÄñ\": \"https://www.pixiv.net/ajax/genre/novel/horror?mode=r18&lang=zh\"},\n    {\"ÁßëÂπª\": \"https://www.pixiv.net/ajax/genre/novel/sci-fi?mode=r18&lang=zh\"},\n    {\"ÊñáÂ≠¶\": \"https://www.pixiv.net/ajax/genre/novel/literature?mode=r18&lang=zh\"},\n    {\"ÊÉÖÊÑü\": \"https://www.pixiv.net/ajax/genre/novel/drama?mode=r18&lang=zh\"},\n    {\"ÂéÜÂè≤\": \"https://www.pixiv.net/ajax/genre/novel/historical_pieces?mode=r18&lang=zh\"},\n    {\"ËÄΩÁæé\": \"https://www.pixiv.net/ajax/genre/novel/bl?mode=r18&lang=zh\"},\n    {\"ÁôæÂêà\": \"https://www.pixiv.net/ajax/genre/novel/yuri?mode=r18&lang=zh\"},\n    {\"Êï£Êñá¬∑ËØóÊ≠å\": \"https://www.pixiv.net/ajax/genre/novel/poetry?mode=r18&lang=zh\"},\n    {\"ÈöèÁ¨î¬∑Á∫™ÂÆû\": \"https://www.pixiv.net/ajax/genre/novel/non-fiction??mode=r18&lang=zh\"},\n    {\"ÂâßÊú¨\": \"https://www.pixiv.net/ajax/genre/novel/screenplays?mode=r18&lang=zh\"},\n    {\"ËØÑËÆ∫\": \"https://www.pixiv.net/ajax/genre/novel/reviews?mode=r18&lang=zh\"},\n    {\"ÂÖ∂‰ªñ\": \"https://www.pixiv.net/ajax/genre/novel/other?mode=r18&lang=zh\"}\n]\n\ngeneralgGenre = [\n    {\"‚ù§Ô∏è‚Äçüî• ÂéüÂàõÁÉ≠Èó® ‚ù§Ô∏è‚Äçüî•\": \"\"},\n    {\"ÁªºÂêà\": \"https://www.pixiv.net/ajax/genre/novel/all?mode=safe&lang=zh\"},\n    {\"ÊÅãÁà±\": \"https://www.pixiv.net/ajax/genre/novel/romance?mode=safe&lang=zh\"},\n    {\"ÂºÇ‰∏ñÁïåÂ•áÂπª\": \"https://www.pixiv.net/ajax/genre/novel/isekai_fantasy?mode=safe&lang=zh\"},\n    {\"Áé∞‰ª£Â•áÂπª\": \"https://www.pixiv.net/ajax/genre/novel/contemporary_fantasy?mode=safe&lang=zh\"},\n    {\"ÊÇ¨Áñë\": \"https://www.pixiv.net/ajax/genre/novel/mystery?mode=safe&lang=zh\"},\n    {\"ÊÅêÊÄñ\": \"https://www.pixiv.net/ajax/genre/novel/horror?mode=safe&lang=zh\"},\n    {\"ÁßëÂπª\": \"https://www.pixiv.net/ajax/genre/novel/sci-fi?mode=safe&lang=zh\"},\n    {\"ÊñáÂ≠¶\": \"https://www.pixiv.net/ajax/genre/novel/literature?mode=safe&lang=zh\"},\n    {\"ÊÉÖÊÑü\": \"https://www.pixiv.net/ajax/genre/novel/drama?mode=safe&lang=zh\"},\n    {\"ÂéÜÂè≤\": \"https://www.pixiv.net/ajax/genre/novel/historical_pieces?mode=safe&lang=zh\"},\n    {\"ËÄΩÁæé\": \"https://www.pixiv.net/ajax/genre/novel/bl?mode=safe&lang=zh\"},\n    {\"ÁôæÂêà\": \"https://www.pixiv.net/ajax/genre/novel/yuri?mode=safe&lang=zh\"},\n    {\"Êï£Êñá¬∑ËØóÊ≠å\": \"https://www.pixiv.net/ajax/genre/novel/poetry?mode=safe&lang=zh\"},\n    {\"ÈöèÁ¨î¬∑Á∫™ÂÆû\": \"https://www.pixiv.net/ajax/genre/novel/non-fiction??mode=safe&lang=zh\"},\n    {\"ÂâßÊú¨\": \"https://www.pixiv.net/ajax/genre/novel/screenplays?mode=safe&lang=zh\"},\n    {\"ËØÑËÆ∫\": \"https://www.pixiv.net/ajax/genre/novel/reviews?mode=safe&lang=zh\"},\n    {\"ÂÖ∂‰ªñ\": \"https://www.pixiv.net/ajax/genre/novel/other?mode=safe&lang=zh\"}\n]\n\nlet likeTagLinks = [{\"üìå ÂñúÊ¨¢Ê†áÁ≠æ üìå\":\"\"}]\nlet othersBookmarks = [{\"‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè ‚ù§Ô∏è\": \"\"}]\n\nli = li.concat(normal)\nli = li.concat(r18New)\nif (SHOW_GENERAL_NEW === true) {\n    li = li.concat(generalNew)\n}\nli = li.concat(r18Rank)\nif (SHOW_GENERAL_RANK === true) {\n    li = li.concat(generalRank)\n}\nif (SHOW_R18_GENRE === true) {\n    li = li.concat(r18Genre)\n}\nif (SHOW_GENERAL_GENRE === true) {\n    li = li.concat(generalgGenre)\n}\nsleepToast('‰ΩøÁî®ÊåáÂçóüîñ\\n\\nÂèëÁé∞ - Êõ¥Êñ∞ - ÁÇπÂáª\"üî∞ ‰ΩøÁî®ÊåáÂçó\" - Êü•Áúã')\n\n// Êî∂ËóèÊ†áÁ≠æ\nlet likeTags = getFromCache(\"likeTags\")\nif (likeTags !== null && likeTags.length >= 1) {\n    likeTags.forEach(tag => {\n        let tagLink = {}\n        tagLink[tag] = `${urlSearchNovel(tag, \"{{page}}\")}`\n        likeTagLinks.push(tagLink)\n    })\n    li = li.concat(likeTagLinks)\n}\n\n// ‰ªñ‰∫∫Êî∂Ëóè\nlet likeAuthors = getFromCacheMap(\"likeAuthors\")\nif (likeAuthors.size > 0) {\n    likeAuthors.forEach((authorName, authorId) => {\n        let bookmark = {}\n        bookmark[authorName] = urlUserBookmarks(authorId)\n        othersBookmarks.push(bookmark)\n    })\n    li = li.concat(othersBookmarks)\n}\n\n// Ê∑ªÂä†Ê†ºÂºè\nli.forEach(item => {\n    item.title = Object.keys(item)[0]\n    item.url = Object.values(item)[0]\n    delete item[Object.keys(item)[0]]\n    item.style = {}\n    item.style.layout_flexGrow = 1\n    item.style.layout_flexShrink = 1\n    item.style.layout_alignSelf = \"auto\"\n    item.style.layout_wrapBefore = \"false\"\n    if (item.url === \"\") {\n        item.style.layout_flexBasisPercent = 1\n    } else {\n        item.style.layout_flexBasisPercent = -1\n    }\n})\n\nJSON.stringify(li)",
        "header": "{\"referer\":\"https://www.pixiv.net\"}",
        "jsLib": "var util = {}\n\nfunction objStringify(obj) {\n    return JSON.stringify(obj, (n, v) => {\n        if (typeof v == \"function\")\n            return v.toString();\n        return v;\n    });\n}\nfunction isBackupSource() {\n    let isBackupSource = source.bookSourceName.includes(\"Â§áÁî®\")\n    cache.put(\"isBackupSource\", isBackupSource)\n    return isBackupSource\n}\n// Ê£ÄÊµã Ê∫êÈòÖ\n// ÂèØÁî® java.ajax() ‰∏çÂèØÁî® java.webview() java.ajaxAll()\n// ÂèØÁî® java.getCookie() cache.put() cache.get() ÈªòËÆ§ÂÄº‰∏∫ undefined\n// ÂèØÁî® java.startBrowser() ‰∏çÂèØÁî® java.startBrowserAwaitAwait\n// ÂèØÁî® source.bookSourceName source.getVariable() source.setVariable()Á≠â\n// java.getUserAgent() java.getWebViewUA() ÁõÆÂâçËøîÂõûÂÜÖÂÆπÁõ∏Âêå\nfunction isSourceRead() {\n    let isSourceReadStatus = java.getUserAgent() === java.getWebViewUA()\n    cache.put(\"isSourceRead\", isSourceReadStatus)\n    return isSourceReadStatus\n}\n\nfunction publicFunc() {\n    let u = {}, settings\n    // ËæìÂá∫‰π¶Ê∫ê‰ø°ÊÅØ\n    java.log(`üÖøÔ∏è ${source.bookSourceComment.split(\"\\n\")[0]}`)\n    java.log(`üìå ${source.bookSourceComment.split(\"\\n\")[2]}`)\n    if (isSourceRead()) {\n        java.log(`üìÜ Êõ¥Êñ∞Êó∂Èó¥Ôºö${java.timeFormat(source.lastUpdateTime)}`)\n        java.log(\"üì± ËΩØ‰ª∂Âπ≥Âè∞Ôºöüçé Ê∫êÈòÖ SourceRead\")\n    } else {\n        java.log(`üìÜ Êõ¥Êñ∞Êó∂Èó¥Ôºö${timeFormat(source.lastUpdateTime)}`)\n        java.log(\"üì± ËΩØ‰ª∂Âπ≥Âè∞Ôºöü§ñ ÂºÄÊ∫êÈòÖËØª Leagdo\")\n    }\n\n    // Ëé∑ÂèñËÆæÁΩÆÔºåÂ§áÁî®‰π¶Ê∫ê‰ΩøÁî®ÊóßÁâàËÆæÁΩÆÔºå‰π¶Ê∫ê‰ªéÁºìÂ≠òËé∑ÂèñËÆæÁΩÆ\n    if (isBackupSource()) {\n        settings = JSON.parse(String(source.variableComment).match(RegExp(/{([\\s\\S]*?)}/gm)))\n    } else {\n        // cache.delete(\"pixivSettings\")\n        settings = getFromCache(\"pixivSettings\")\n    }\n    if (settings !== null) {\n        java.log(\"‚öôÔ∏è ‰ΩøÁî®Ëá™ÂÆö‰πâËÆæÁΩÆ\")\n    } else {\n        settings = {}\n        settings.SEARCH_AUTHOR = true       // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n        settings.CONVERT_CHINESE = true     // ÊêúÁ¥¢ÔºöÊêúÁ¥¢Êó∂ËøõË°åÁπÅÁÆÄËΩ¨Êç¢\n        settings.SHOW_LIKE_NOVELS = true    // ÊêúÁ¥¢ÔºöÊêúÁ¥¢ÁªìÊûúÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥\n        settings.SHOW_WATCHED_SERIES = true // ÊêúÁ¥¢ÔºöÊêúÁ¥¢ÁªìÊûúÊòæÁ§∫ËøΩÊï¥Á≥ªÂàóÂ∞èËØ¥\n        settings.MORE_INFORMATION = false   // ËØ¶ÊÉÖÔºö‰π¶Á±çÁÆÄ‰ªãÊòæÁ§∫Êõ¥Â§ö‰ø°ÊÅØ\n        settings.SHOW_UPDATE_TIME = true    // ÁõÆÂΩïÔºöÊòæÁ§∫Êõ¥Êñ∞Êó∂Èó¥Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Â∞ëËÆ∏ËØ∑Ê±Ç\n        settings.SHOW_ORIGINAL_LINK = true  // ÁõÆÂΩïÔºöÊòæÁ§∫ÂéüÂßãÈìæÊé•Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Â§ßÈáèËØ∑Ê±Ç\n        settings.REPLACE_TITLE_MARKS = true // Ê≠£ÊñáÔºöÊ≥®Èü≥ÂÜÖÂÆπ‰∏∫Ê±âÂ≠óÊó∂ÔºåÊõøÊç¢‰∏∫‰π¶ÂêçÂè∑\n        settings.SHOW_CAPTIONS = true       // Ê≠£ÊñáÔºöÁ´†È¶ñÊòæÁ§∫ÊèèËø∞\n        settings.SHOW_COMMENTS = true       // Ê≠£ÊñáÔºöÁ´†Â∞æÊòæÁ§∫ËØÑËÆ∫\n        settings.FAST  = false              // ÂÖ®Â±ÄÔºöÂø´ÈÄüÊ®°Âºè\n        settings.DEBUG = false              // ÂÖ®Â±ÄÔºöË∞ÉËØïÊ®°Âºè\n        java.log(\"‚öôÔ∏è ‰ΩøÁî®ÈªòËÆ§ËÆæÁΩÆÔºàÊó†Ëá™ÂÆö‰πâËÆæÁΩÆ Êàñ Ëá™ÂÆö‰πâËÆæÁΩÆÊúâËØØÔºâ\")\n    }\n    if (settings.FAST === true) {\n        settings.SEARCH_AUTHOR = false        // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n        settings.CONVERT_CHINESE = false      // ÊêúÁ¥¢ÔºöÁπÅÁÆÄÈÄöÊêú\n        settings.SHOW_UPDATE_TIME = false     // ÁõÆÂΩïÔºöÊòæÁ§∫Á´†ËäÇÊõ¥Êñ∞Êó∂Èó¥\n        settings.SHOW_ORIGINAL_LINK = false   // ÁõÆÂΩïÔºöÊòæÁ§∫Á´†ËäÇÊ∫êÈìæÊé•\n        settings.SHOW_COMMENTS = false        // Ê≠£ÊñáÔºöÊòæÁ§∫ËØÑËÆ∫\n    } else {\n        settings.SEARCH_AUTHOR = true        // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n    }\n    settings.IS_LEGADO = !isSourceRead()\n    settings.IS_SOURCE_READ = isSourceRead()\n    settings.IS_BACKUP_SOURCE = isBackupSource()\n    u.settings = settings\n    putInCache(\"pixivSettings\", settings)  // ËÆæÁΩÆÂÜôÂÖ•ÁºìÂ≠ò\n\n    u.debugFunc = (func) => {\n        if (util.settings.DEBUG === true) {\n            func()\n        }\n    }\n\n    u.checkStatus = function(status) {\n        if (status === true) return \"‚úÖ Â∑≤\"\n        else if (status === false) return \"‚ùå Êú™\"\n        else if (status === undefined) return \"üàöÔ∏è Êó†Êï∞ÊçÆÔºö\"\n    }\n\n    u.login = function() {\n        let resp = java.startBrowserAwait(`https://accounts.pixiv.net/login,\n    {\"headers\": {\"User-Agent\": \"${java.getWebViewUA()}\"}}`, 'ÁôªÂΩïË¥¶Âè∑', false)\n        if (resp.code() === 200) {\n            this.getCsrfToken(); this.getCookie()\n        } else {\n            java.log(resp.code()); sleepToast(\"‚ö†Ô∏è ÁôªÂΩïÂ§±Ë¥•\")\n        }\n    }\n\n    u.logout = function() {\n        this.removeCookie()\n        java.startBrowser(\"https://www.pixiv.net/logout.php\", \"ÈÄÄÂá∫Ë¥¶Âè∑\")\n        this.removeCookie()\n        sleepToast(`‚úÖ Â∑≤ÈÄÄÂá∫ÂΩìÂâçË¥¶Âè∑\\n\\nÈÄÄÂá∫ÂêéËØ∑ÁÇπÂáªÂè≥‰∏äËßíÁöÑ ‚úîÔ∏è ÈÄÄÂá∫\\n\\nÁôªÂΩïËØ∑ÁÇπÂáª„ÄêÁôªÂΩïË¥¶Âè∑„ÄëËøõË°åÁôªÂΩï`)\n    }\n\n    u.getCookie = function() {\n        let pixivCookie = String(java.getCookie(\"https://www.pixiv.net/\", null))\n        if (isLogin()) cache.put(\"pixivCookie\", pixivCookie, 60*60)  // ÁºìÂ≠ò1h\n    }\n\n    u.removeCookie = function() {\n        cookie.removeCookie('https://www.pixiv.net')\n        cookie.removeCookie('https://accounts.pixiv.net')\n        cookie.removeCookie('https://accounts.google.com')\n        cookie.removeCookie('https://api.weibo.com')\n        cache.delete(\"pixivCookie\")\n        cache.delete(\"pixiv:uid\")\n        cache.delete(\"csfrToken\")  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥\n        cache.delete(\"headers\")\n    }\n\n    // Ëé∑Âèñ Csrf TokenÔºå‰ª•‰æøËøõË°åÊî∂ËóèÁ≠âËØ∑Ê±Ç\n    // Ëé∑ÂèñÊñπÊ≥ïÊù•Ëá™ËÑöÊú¨ Pixiv Previewer\n    // https://github.com/Ocrosoft/PixivPreviewer\n    // https://greasyfork.org/zh-CN/scripts/30766-pixiv-previewer/code\n    u.getCsrfToken = function() {\n        let csfrToken = cache.get(\"csfrToken\")\n        if (!csfrToken) {\n            let html = java.webView(null, \"https://www.pixiv.net/\", null)\n            try {\n                csfrToken = html.match(/token\\\\\":\\\\\"([a-z0-9]{32})/)[1]\n                cache.put(\"csfrToken\", csfrToken)  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n            } catch (e) {\n                csfrToken = null\n                cache.delete(\"csfrToken\")  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n                // sleepToast(\"‚ö†Ô∏è Êú™ÁôªÂΩïË¥¶Âè∑(csfrToken)\")\n            }\n            java.log(`csfrToken:\\n${csfrToken}`)\n        }\n        return csfrToken\n    }\n\n    // Â∞ÜÂ§ö‰∏™ÈïøÁØáÂ∞èËØ¥Ëß£Êûê‰∏∫‰∏ÄÊú¨‰π¶\n    u.combineNovels = function(novels) {\n        return novels.filter(novel => {\n            // ÂçïÊú¨Áõ¥Êé•Ëß£Êûê‰∏∫‰∏ÄÊú¨‰π¶\n            if (novel.seriesId === undefined || novel.seriesId === null) {\n                return true\n            }\n            // ÈõÜÂêà‰∏≠Ê≤°ÊúâËØ•Á≥ªÂàóËß£Êûê‰∏∫‰∏ÄÊú¨‰π¶\n            if (!seriesSet.has(novel.seriesId)) {\n                seriesSet.add(novel.seriesId)\n                return true\n            }\n            return false\n        })\n    }\n\n    // Â±èËîΩ‰ΩúËÄÖ\n    u.authorFilter = function(novels) {\n        let authors = getFromCache(\"blockAuthorList\")\n        if (authors !== null && authors.length >= 0) {\n            java.log(`üö´ Â±èËîΩ‰ΩúËÄÖIDÔºö${JSON.stringify(authors)}`)\n            authors.forEach(author => {\n                novels = novels.filter(novel => novel.userId !== String(author))\n            })\n        }\n        return novels\n    }\n\n\n    // ËøáÊª§Êî∂Ëóè‰∏éËøΩÊõ¥\n    u.novelFilter = function(novels) {\n        let novels1 = [], novels2 = [], msg\n        let likeNovels = getFromCache(\"likeNovels\")\n        let watchedSeries = getFromCache(\"watchedSeries\")\n        let novels0 = novels.map(novel => novel.id)\n\n        msg = util.checkStatus(util.settings.SHOW_LIKE_NOVELS).replace(\"Êú™\",\"‰∏ç\")\n        java.log(`${msg}ÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥`)\n        if (util.settings.SHOW_LIKE_NOVELS === false) {\n            novels = novels.filter(novel => !likeNovels.includes(Number(novel.id)))\n            novels1 = novels.map(novel => novel.id)\n            java.log(`‚è¨ ËøáÊª§Êî∂ËóèÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels1.length}`)\n        }\n\n        msg = util.checkStatus(util.settings.SHOW_WATCHED_SERIES).replace(\"Êú™\",\"‰∏ç\")\n        java.log(`${msg}ÊòæÁ§∫ËøΩÊõ¥Á≥ªÂàó`)\n        if (util.settings.SHOW_WATCHED_SERIES === false) {\n            novels = novels.filter(novel => !watchedSeries.includes(Number(novel.seriesId)))\n            novels2 = novels.map(novel => novel.id)\n            if (novels1.length >= 1) novels0 = novels1\n            java.log(`‚è¨ ËøáÊª§ËøΩÊõ¥ÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n        }\n\n        let novels3 = novels.map(novel => novel.id)\n        if (novels0.length >= 1 && novels3.length === 0) {\n            let msg = `‚è¨ ËøáÊª§Â∞èËØ¥\\n‚ö†Ô∏è ËøáÊª§ÂêéÊó†ÁªìÊûú\\n\\nËØ∑Ê†πÊçÆÈúÄË¶Å\\n`\n            if (util.settings.SHOW_LIKE_NOVELS === false) msg += \"ÂºÄÂêØÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥\\n\"\n            if (util.settings.SHOW_WATCHED_SERIES === false) msg += \"ÂºÄÂêØÊòæÁ§∫ËøΩÊõ¥Á≥ªÂàó\"\n            sleepToast(msg, 1)\n        }\n\n        util.debugFunc(() => {\n            // java.log(JSON.stringify(novels0))\n            java.log(JSON.stringify(novels0.length))\n            // java.log(JSON.stringify(novels1))\n            java.log(JSON.stringify(novels1.length))\n            // java.log(JSON.stringify(novels2))\n            java.log(JSON.stringify(novels2.length))\n        })\n        return novels\n    }\n\n    // ËøáÊª§ÊèèËø∞‰∏éÊ†áÁ≠æÔºàÂ±èËîΩÊ†áÁ≠æ/Â±èËîΩÊèèËø∞Ôºâ\n    u.novelFilter2 = function(novels) {\n        let novels0 = novels.map(novel => novel.id)\n        let captionBlockWords = getFromCache(\"captionBlockWords\")\n        if (captionBlockWords === null) captionBlockWords = []\n        if (captionBlockWords) {\n            // ‰ªÖ‰øùÁïôÊ≤°Êúâ‰ªª‰ΩïÂ±èËîΩËØçÁöÑÂ∞èËØ¥\n            // novels = novels.filter(novel => {\n            //     return !captionBlockWords.some(item => {\n            //         if (novel.description !== undefined) return novel.description.includes(item)\n            //     })\n            // })\n            novels = novels.filter(novel => !captionBlockWords.some(item => novel.description.includes(item)))\n            let novels2 = novels.map(novel => novel.id)\n            java.log(`üö´ Â±èËîΩÊèèËø∞Ôºö${captionBlockWords.join(\"\\n\")}`)\n            java.log(`üö´ Â±èËîΩÊèèËø∞ÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n        }\n\n        let tagsBlockWords = getFromCache(\"tagsBlockWords\")\n        if (tagsBlockWords === null) tagsBlockWords = []\n        if (tagsBlockWords) {\n            // ‰ªÖ‰øùÁïôÊ≤°Êúâ‰ªª‰ΩïÂ±èËîΩËØçÁöÑÂ∞èËØ¥\n            // novels = novels.filter(novel => {\n            //     return !tagsBlockWords.some(item => {\n            //         if (novel.tags !== undefined) return novel.tags.includes(item)\n            //     })\n            // })\n            novels = novels.filter(novel => !tagsBlockWords.some(item => novel.tags.includes(item)))\n            let novels2 = novels.map(novel => novel.id)\n            java.log(`üö´ Â±èËîΩÊ†áÁ≠æÔºö${tagsBlockWords.join(\"„ÄÅ\")}`)\n            java.log(`üö´ Â±èËîΩÊ†áÁ≠æÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n        }\n        return novels\n    }\n\n    // Êî∂ËóèÂ∞èËØ¥/ËøΩÊõ¥Á≥ªÂàó ÂÜôÂÖ•ÁºìÂ≠ò\n    u.saveNovels = function(listInCacheName, list) {\n        let listInCache = getFromCache(listInCacheName)\n        if (listInCache === null) listInCache = []\n\n        listInCache = listInCache.concat(list)\n        listInCache = Array.from(new Set(listInCache))\n        cache.put(listInCacheName, JSON.stringify(listInCache))\n\n        if (listInCacheName === \"likeNovels\") listInCacheName = \"‚ù§Ô∏è Êî∂ËóèÂ∞èËØ¥ID\"\n        else if (listInCacheName === \"watchedSeries\") listInCacheName = \"üìÉ ËøΩÊõ¥Á≥ªÂàóID\"\n        java.log(`${listInCacheName}Ôºö${JSON.stringify(listInCache)}`)\n    }\n\n    // Â§ÑÁêÜ novels ÂàóË°®\n    u.handNovels = function(novels) {\n        let likeNovels = [], watchedSeries = []\n        novels = util.authorFilter(novels)\n        novels.forEach(novel => {\n            // novel.id = novel.id\n            // novel.title = novel.title\n            // novel.userName = novel.userName\n            // novel.userId = novel.userId\n            // novel.tags = novel.tags\n            cache.put(`${novel.userName}`, novel.userId)  // Âä†ÂÖ•ÁºìÂ≠òÔºå‰æø‰∫éÊêúÁ¥¢‰ΩúËÄÖ\n            if (novel.tags === undefined || novel.tags === null) {\n                novel.tags = []\n            }\n            // ÊêúÁ¥¢ÂçïÁØá\n            if (novel.isOneshot === undefined) {\n                // novel.seriesId = novel.seriesId\n                // novel.seriesTitle = novel.seriesTitle\n                // novel.textCount = novel.textCount\n                // novel.description = novel.description\n                novel.coverUrl = novel.url\n                // novel.createDate = novel.createDate\n                // novel.updateDate = novel.updateDate\n            }\n\n            // ÊêúÁ¥¢Á≥ªÂàó\n            if (novel.isOneshot !== undefined) {\n                if (novel.isOneshot === true) {\n                    novel.seriesId = undefined\n                    novel.id = novel.novelId  // Ëé∑ÂèñÁúüÊ≠£ÁöÑ novelId\n                    novel.seriesTitle = undefined\n                } else {\n                    novel.seriesId = novel.id\n                    novel.id = novel.novelId = novel.latestEpisodeId  // Ëé∑ÂèñÁúüÊ≠£ÁöÑ novelId\n                    novel.seriesTitle = novel.title\n                    // novel.isWatched = novel.isWatched  // ÊêúÁ¥¢Á≥ªÂàóÂèØËé∑Âèñ\n                }\n                novel.textCount = novel.textLength\n                novel.description = novel.caption\n                novel.coverUrl = novel.cover.urls[\"480mw\"]\n                novel.createDate = novel.createDateTime\n                novel.updateDate = novel.updateDateTime\n            }\n\n            // ÂçïÁØáÊ≠£ÊñáËØ¶ÊÉÖÈ°µ\n            if (novel.content) {\n                novel.novelId = novel.id\n                novel.tags = novel.tags.tags.map(item => item.tag)\n                novel.textCount = novel.userNovels[`${novel.id}`].textCount\n                // novel.latestChapter = novel.title\n                // novel.description = novel.description\n                novel.coverUrl = novel.userNovels[`${novel.id}`].url\n                // novel.createDate = novel.createDate\n                novel.updateDate = novel.uploadDate\n\n                if (novel.seriesNavData) {\n                    novel.seriesId = novel.seriesNavData.seriesId\n                    novel.seriesTitle = novel.seriesNavData.title\n                }\n            }\n\n            // Á≥ªÂàóËØ¶ÊÉÖ\n            if (novel.firstNovelId) {\n                novel.seriesId = novel.id\n                novel.id = novel.novelId = novel.firstNovelId\n                novel.seriesTitle = novel.title\n                novel.coverUrl = novel.cover.urls[\"480mw\"]\n                // novel.isWatched = novel.isWatched  // ÊêúÁ¥¢Á≥ªÂàóÂèØËé∑Âèñ\n            }\n\n            // ÂçïÁØáÂä†Êõ¥Â§ö‰ø°ÊÅØ\n            if (!novel.seriesId) {\n                novel.tags.unshift(\"ÂçïÊú¨\")\n                novel.latestChapter = novel.title\n                novel.detailedUrl = urlNovelDetailed(novel.id)\n                novel.total = 1\n                if (novel.bookmarkData) {\n                    novel.isBookmark = true\n                    cache.put(`collect${novel.id}`, novel.bookmarkData.id)\n                    likeNovels.push(Number(novel.id))\n                } else {\n                    novel.isBookmark = false\n                }\n            }\n            // Á≥ªÂàóÊ∑ªÂä†Êõ¥Â§ö‰ø°ÊÅØ\n            if (novel.seriesId) {\n                let series = getAjaxJson(urlSeriesDetailed(novel.seriesId)).body\n                novel.id = series.firstNovelId\n                novel.title = series.title\n                novel.tags = novel.tags.concat(series.tags)\n                novel.tags.unshift(\"ÈïøÁØá\")\n                novel.textCount = series.publishedTotalCharacterCount\n                novel.description = series.caption\n                novel.coverUrl = series.cover.urls[\"480mw\"]\n                novel.detailedUrl = urlSeriesDetailed(novel.seriesId)\n                novel.createDate = series.createDate\n                novel.updateDate = series.updateDate\n                novel.total = series.publishedContentCount\n                novel.isWatched = series.isWatched\n                if (novel.isWatched === true) {\n                    watchedSeries.push(Number(novel.seriesId))\n                }\n\n                // ÂèëÈÄÅËØ∑Ê±ÇËé∑ÂèñÁ¨¨‰∏ÄÁ´† Ëé∑ÂèñÊ†áÁ≠æ‰∏éÁÆÄ‰ªã\n                let firstNovel = {}\n                try {\n                    firstNovel = getAjaxJson(urlNovelDetailed(series.firstNovelId)).body\n                    novel.tags = novel.tags.concat(firstNovel.tags.tags.map(item => item.tag))\n                    if (firstNovel.bookmarkData) {\n                        firstNovel.isBookmark = true\n                        cache.put(`collect${firstNovel.id}`, firstNovel.bookmarkData.id)\n                        likeNovels.push(Number(firstNovel.id))\n                    }\n                } catch (e) {  // Èò≤Ê≠¢Á≥ªÂàóÈ¶ñÁØáÊó†ÊùÉÈôêËé∑Âèñ\n                    try {\n                        firstNovel = getAjaxJson(urlSeriesNovels(novel.seriesId, 30, 0)).body.thumbnails.novel[0]\n                        novel.id = novel.firstNovelId = firstNovel.id\n                        novel.tags = novel.tags.concat(firstNovel.tags)\n                    } catch (e) { // Èò≤Ê≠¢Á≥ªÂàóÈ¶ñÁØáÊó†ÊùÉÈôêËé∑Âèñ\n                        firstNovel = {}\n                        firstNovel.description = \"\"\n                    }\n                }\n                novel.tags.unshift(\"ÈïøÁØá\")\n                if (novel.description === \"\") {\n                    novel.description = firstNovel.description\n                }\n            }\n        })\n        // Êî∂ËóèÂ∞èËØ¥/ËøΩÊõ¥Á≥ªÂàó ÂÜôÂÖ•ÁºìÂ≠ò\n        util.saveNovels(\"likeNovels\", likeNovels)\n        util.saveNovels(\"watchedSeries\", watchedSeries)\n        util.debugFunc(() => {\n            java.log(`Â§ÑÁêÜÂ∞èËØ¥ÂÆåÊàê`)\n        })\n        return novels\n    }\n\n    // Â∞èËØ¥‰ø°ÊÅØÊ†ºÂºèÂåñ\n    u.formatNovels = function(novels) {\n        novels = util.novelFilter(novels)\n        novels.forEach(novel => {\n            if (novel.title) novel.title = novel.title.trim()\n            if (!novel.userName.startsWith(\"@\")) novel.userName = `@${novel.userName}`\n            novel.coverUrl = urlCoverUrl(novel.coverUrl)\n            novel.readingTime = `${novel.readingTime / 60} ÂàÜÈíü`\n            novel.createDate = dateFormat(novel.createDate)\n            novel.updateDate = dateFormat(novel.updateDate)\n\n            novel.tags2 = []\n            for (let i in novel.tags) {\n                let tag = novel.tags[i]\n                if (tag.includes(\"/\")) {\n                    let tags = tag.split(\"/\")\n                    novel.tags2 = novel.tags2.concat(tags)\n                } else {\n                    novel.tags2.push(tag)\n                }\n            }\n            novel.tags = Array.from(new Set(novel.tags2))\n            novel.tags = novel.tags.join(\",\")\n            if (novel.seriesId) {\n                collectMsg = `üìÉ ËøΩÊõ¥Ôºö${util.checkStatus(novel.isWatched)}ËøΩÊõ¥Á≥ªÂàó`\n            } else {\n                collectMsg = `‚ù§Ô∏è Êî∂ËóèÔºö${util.checkStatus(novel.isBookmark)}Âä†ÂÖ•Êî∂Ëóè`\n            }\n\n            if (util.settings.MORE_INFORMATION) {\n                novel.description = `\\nüÖøÔ∏è ÁôªÂΩïÔºö${util.checkStatus(isLogin())}ÁôªÂΩïË¥¶Âè∑\n                ${collectMsg}\\nüìñ ‰π¶ÂêçÔºö${novel.title}\\nüë§ ‰ΩúËÄÖÔºö${novel.userName}\n                #Ô∏è Ê†áÁ≠æÔºö${novel.tags}\\n‚¨ÜÔ∏è ‰∏ä‰º†Ôºö${novel.createDate}\n                üîÑ Êõ¥Êñ∞Ôºö${novel.updateDate}\\nüìÑ ÁÆÄ‰ªãÔºö${novel.description}`\n            } else {\n                novel.description = `\\nüÖøÔ∏è ÁôªÂΩïÔºö${util.checkStatus(isLogin())}ÁôªÂΩïË¥¶Âè∑\n                ${collectMsg}\\n‚¨ÜÔ∏è ‰∏ä‰º†Ôºö${novel.createDate}\\nüîÑ Êõ¥Êñ∞Ôºö${novel.updateDate}\n                üìÑ ÁÆÄ‰ªãÔºö${novel.description}`\n            }\n        })\n        novels = util.novelFilter2(novels)\n        return novels\n    }\n\n    // Ê≠£ÊñáÔºåËØ¶ÊÉÖÔºåÊêúÁ¥¢Ôºö‰ªéÁΩëÂùÄËé∑ÂèñidÔºåËøîÂõûÂçïÁØáÂ∞èËØ¥ resÔºåÁ≥ªÂàóËøîÂõûÈ¶ñÁØáÂ∞èËØ¥ res\n    // pixiv ÈªòËÆ§ÂàÜ‰∫´‰ø°ÊÅØ‰∏≠Êúâ#Âè∑Ôºå‰∏ç‰ºöË¢´ËØÜÂà´ÊàêÈìæÊé•ÔºåÊó†Ê≥ï‰ΩøÁî®Ê∑ªÂä†ÁΩëÂùÄ\n    u.getNovelRes = function(result) {\n        let novelId = 0, res = {\"body\": {}}\n        let isJson = isJsonString(result)\n        let isHtml = isHtmlString(result)\n\n        if (!isJson && isHtml) {\n            let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n            let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net(/ajax)?/users?/\\\\d+\"\n            let isAuthor = baseUrl.match(new RegExp(pattern))\n            if (isAuthor) {\n                java.log(`‰ΩúËÄÖIDÔºö${id}`)\n                novelId = Object.keys(getAjaxJson(urlUserWorkLatest(id)).body.novels).reverse()[0]\n            }\n\n            pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/series/\\\\d+\"\n            let isSeries = baseUrl.match(new RegExp(pattern))\n            if (isSeries) {\n                java.log(`Á≥ªÂàóIDÔºö${id}`)\n                try {\n                    novelId = getAjaxJson(urlSeriesDetailed(id)).body.firstNovelId\n                } catch (e) {\n                    novelId = getAjaxJson(urlSeriesNovels(id, 30, 0)).body.thumbnails.novel[0].id\n                }\n            } else {\n                let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/(show\\\\.php\\\\?id=)?\\\\d+\"\n                let isNovel = baseUrl.match(new RegExp(pattern))\n                if (isNovel) {\n                    novelId = id\n                }\n            }\n        }\n        if (isJson) {\n            res = JSON.parse(result)\n        }\n\n        if (novelId) {\n            java.log(`ÂåπÈÖçÂ∞èËØ¥IDÔºö${novelId}`)\n            res = getAjaxJson(urlNovelDetailed(novelId))\n        }\n        if (res.error === true) {\n            java.log(`Êó†Ê≥ï‰ªé Pixiv Ëé∑ÂèñÂΩìÂâçÂ∞èËØ¥`)\n            java.log(JSON.stringify(res))\n        }\n        return res.body\n    }\n\n    // ÁõÆÂΩïÔºö‰ªéÁΩëÂùÄËé∑ÂèñidÔºåÂ∞ΩÂèØËÉΩËøîÂõûÁ≥ªÂàó resÔºåÂçïÁØáÂ∞èËØ¥ËøîÂõûÂ∞èËØ¥ res\n    u.getNovelResSeries = function(result) {\n        let seriesId = 0, res = {\"body\": {}}\n        let isJson = isJsonString(result)\n        let isHtml = isHtmlString(result)\n\n        if (!isJson && isHtml) {\n            let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n            let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/series/\\\\d+\"\n            let isSeries = baseUrl.match(new RegExp(pattern))\n            if (isSeries) {\n                seriesId = id\n            } else {\n                let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/(show\\\\.php\\\\?id=)?\\\\d+\"\n                let isNovel = baseUrl.match(new RegExp(pattern))\n                if (isNovel) {\n                    java.log(`ÂåπÈÖçÂ∞èËØ¥IDÔºö${id}`)\n                    res = getAjaxJson(urlNovelDetailed(id))\n                }\n            }\n        }\n        if (isJson) {\n            res = JSON.parse(result)\n        }\n\n        if (res.body && res.body.seriesNavData) {\n            seriesId = res.body.seriesNavData.seriesId\n        }\n        if (seriesId) {\n            java.log(`Á≥ªÂàóIDÔºö${seriesId}`)\n            res = getAjaxJson(urlSeriesDetailed(seriesId))\n        }\n        if (res.error === true) {\n            java.log(`Êó†Ê≥ï‰ªé Pixiv Ëé∑ÂèñÂΩìÂâçÂ∞èËØ¥`)\n            java.log(JSON.stringify(res))\n        }\n        return res.body\n    }\n\n    util = u\n    java.put(\"util\", objStringify(u))\n}\n\nfunction checkMessageThread(checkTimes) {\n    if (checkTimes === undefined) {\n        checkTimes = cache.get(\"checkTimes\")\n    }\n    if (checkTimes === 0 && isLogin()) {\n        let latestMsg = getAjaxJson(urlMessageThreadLatest(5))\n        if (latestMsg.error === true) {\n            java.log(JSON.stringify(latestMsg))\n        } else if (latestMsg.body.total >= 1) {\n            let msg = latestMsg.body.message_threads.filter(item => item.thread_name === \"pixiv‰∫ãÂãôÂ±Ä\")[0]\n            if (msg && new Date().getTime()- 1000*msg.modified_at <= 3*24*60*60*1000) { // 3Â§©ÂÜÖËøõË°åÊèêÁ§∫\n                sleepToast(`ÊÇ®‰∫é ${timeFormat(1000*msg.modified_at)} Ëß¶Âèë Pixiv „ÄêËøáÂ∫¶ËÆøÈóÆ„ÄëÔºåËØ∑‰øÆÊîπÂØÜÁ†ÅÂπ∂ÈáçÊñ∞ÁôªÂΩï„ÄÇ\\nÂ¶ÇÂ∑≤‰øÆÊîπËØ∑ÂøΩÁï•`, 3)\n                sleepToast(`${msg.latest_content}`, 5)\n                java.startBrowser(\"https://accounts.pixiv.net/password/change\",'‰øÆÊîπÂØÜÁ†Å')\n            }\n        }\n    }\n    cache.put(\"checkTimes\", checkTimes + 1, 4*60*60)  // ÁºìÂ≠ò4hÔºåÊØè4hÊèêÈÜí‰∏ÄÊ¨°\n    // cache.put(\"checkTimes\", checkTimes + 1, 60)  // ÊµãËØïÁî®ÔºåÁºìÂ≠ò60sÔºåÊØèÂàÜÈíüÊèêÈÜí‰∏ÄÊ¨°\n    // java.log(checkTimes + 1)\n}\n\n// Ëé∑ÂèñËØ∑Ê±ÇÁöÑuser idÊñπ‰æøÂÖ∂‰ªñajaxËØ∑Ê±ÇÊûÑÈÄ†\nfunction getPixivUid() {\n    let uid = cache.get(\"pixiv:uid\")\n    if (!uid || String(uid) === \"null\") {\n        let html = java.webView(null, \"https://www.pixiv.net/\", null)\n        try {\n            uid = html.match(/user_id:'(\\d+)'/)[1]\n        } catch (e) {\n            uid = null\n        }\n        cache.put(\"pixiv:uid\", String(uid))\n    }\n}\n\nfunction getHeaders() {\n    let headers = {\n        \"accept\": \"application/json\",\n        \"accept-encoding\": \"gzip, deflate, br, zstd\",\n        \"accept-language\": \"zh-CN\",\n        // \"content-type\": \"application/json; charset=utf-8\",\n        // \"content-type\": \"application/x-www-form-urlencoded; charset=utf-8\",\n        \"origin\": \"https//www.pixiv.net\",\n        \"referer\": \"https://www.pixiv.net/\",\n        // \"sec-ch-ua\": `\"Not/A)Brand\";v=\"8\", \"Chromium\";v=\"132\", \"Google Chrome\";v=\"132\"`,\n        // \"sec-ch-ua-mobile\": \"?0\",\n        // \"sec-ch-ua-platform\": \"Windows\",\n        // \"sec-fetch-dest\": \"empty\",\n        // \"sec-fetch-mode\": \"cors\",\n        // \"sec-fetch-site\": \"same-origin\",\n        \"user-agent\": cache.get(\"userAgent\"),\n        \"x-csrf-token\": cache.get(\"csfrToken\"),\n        \"Cookie\": cache.get(\"pixivCookie\")\n    }\n    putInCache(\"headers\", headers)\n    return headers\n}\n\n\npublicFunc()\nif (result.code() === 200) {\n    getPixivUid(); getWebViewUA(); util.getCookie(); util.getCsrfToken(); getHeaders()\n    if (!util.settings.FAST) checkMessageThread()   // Ê£ÄÊµãËøáÂ∫¶ËÆøÈóÆ\n}\n\nutil.debugFunc(() => {\n    java.log(`DEBUG = ${util.settings.DEBUG}\\n`)\n    java.log(JSON.stringify(util.settings, null, 4))\n    java.log(`${getWebViewUA()}\\n`)\n    java.log(`${cache.get(\"csfrToken\")}\\n`)\n    java.log(`${cache.get(\"pixivCookie\")}\\n`)\n    java.log(`${cache.get(\"headers\")}\\n`)\n})\n\njava.getStrResponse(null, null)\nvar checkTimes = 0\nvar cacheSaveSeconds = 7*24*60*60  // ÁºìÂ≠òÊó∂Èó¥7Â§©\n\n\nfunction cacheGetAndSet(cache, key, supplyFunc) {\n    let v = cache.get(key)\n    // ÁºìÂ≠ò‰ø°ÊÅØÈîôËØØÊó∂Ôºå‰øùÁïô10minÂêéÈáçÊñ∞ËØ∑Ê±Ç\n    if (v && JSON.parse(v).error === true) {\n        if (new Date().getTime() >= JSON.parse(v).timestamp + 10*60*1000) {\n            cache.delete(key)\n            v = cache.get(key)\n        }\n    }\n    // Êó†ÁºìÂ≠ò‰ø°ÊÅØÊó∂ÔºåËøõË°åËØ∑Ê±Ç\n    if (v === undefined || v === null) {\n        v = supplyFunc()\n        v.timestamp = new Date().getTime()\n        v = JSON.stringify(v)\n        cache.put(key, v, cacheSaveSeconds)\n    }\n    return JSON.parse(v)\n}\n\nfunction putInCache(objectName, object, saveSeconds) {\n    const {java, cache} = this\n    if (object === undefined) object = null\n    if (saveSeconds === undefined) saveSeconds = 0\n    cache.put(objectName, JSON.stringify(object), saveSeconds)\n}\nfunction getFromCache(objectName) {\n    const {java, cache} = this\n    let object = cache.get(objectName)\n    if (object === undefined) return null  // ÂÖºÂÆπÊ∫êÈòÖ\n    return JSON.parse(object)\n}\n\nfunction putInCacheMap(mapName, mapObject, saveSeconds) {\n    const {java, cache} = this\n    let orderedArray = []\n    mapObject.forEach((value, key) => {\n        const item = {}\n        item[key] = value\n        orderedArray.push(item)\n    })\n    // [{'key1': 'value1'}, {'key2': 'value2'}]\n    if (saveSeconds === undefined) saveSeconds = 0\n    cache.put(mapName, JSON.stringify(orderedArray), saveSeconds)\n}\nfunction getFromCacheMap(mapName) {\n    const {java, cache} = this\n    let cached = cache.get(mapName)\n    let newMap = new Map()\n    if (cached === null || cached === undefined) {\n        return newMap\n    }\n\n    let parsedData\n    try {\n        parsedData = JSON.parse(cached)\n    } catch (e) {\n        return newMap\n    }\n\n    if (Array.isArray(parsedData)) {\n        parsedData.forEach(item => {\n            for (let key in item) {\n                newMap.set(key, item[key])\n            }\n        })\n    } else {\n        for (let key in parsedData) {\n            newMap.set(key, parsedData[key])\n        }\n    }\n    return newMap\n}\n\nfunction isHtmlString(str) {\n    return str.startsWith(\"<!DOCTYPE html>\")\n}\nfunction isJsonString(str) {\n    try {\n        if (typeof JSON.parse(str) === \"object\") {\n            return true\n        }\n    } catch(e) {}\n    return false\n}\n\nfunction getWebViewUA() {\n    const {java, cache} = this\n    let userAgent = String(java.getWebViewUA())\n    if (userAgent.includes(\"Windows NT 10.0; Win64; x64\")) {\n        userAgent = \"Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Mobile Safari/537.36\"\n    }\n    // java.log(`userAgent=${userAgent}`)\n    cache.put(\"userAgent\", userAgent)\n    return String(userAgent)\n}\nfunction isLogin() {\n    const {java, cache} = this\n    return !!cache.get(\"csfrToken\")\n}\n\nfunction getAjaxJson(url, forceUpdate) {\n    const {java, cache} = this\n    if (forceUpdate) cache.delete(url)\n    return cacheGetAndSet(cache, url, () => {\n        return JSON.parse(java.ajax(url))\n    })\n}\nfunction getAjaxAllJson(urls, forceUpdate) {\n    const {java, cache} = this\n    if (forceUpdate) cache.delete(urls)\n    return cacheGetAndSet(cache, urls, () => {\n        let result = java.ajaxAll(urls).map(resp => JSON.parse(resp.body()))\n        cache.put(urls, JSON.stringify(result), cacheSaveSeconds)\n        for (let i in urls) cache.put(urls[i], JSON.stringify(result[i]), cacheSaveSeconds)\n        return result\n    })\n}\nfunction getWebviewJson(url, parseFunc) {\n    const {java, cache} = this\n    return cacheGetAndSet(cache, url, () => {\n        let html = java.webView(null, url, null)\n        return JSON.parse(parseFunc(html))\n    })\n}\n\nfunction urlNovelUrl(novelId) {\n    return `https://www.pixiv.net/novel/show.php?id=${novelId}`\n}\nfunction urlNovelDetailed(novelId) {\n    return `https://www.pixiv.net/ajax/novel/${novelId}`\n}\nfunction urlNovelsDetailed(userId, nidList) {\n    return `https://www.pixiv.net/ajax/user/${userId}/novels?${nidList.map(v => `ids[]=${v}`).join(\"&\")}`\n}\nfunction urlNovelBookmarkData(novelId) {\n    return `https://www.pixiv.net/ajax/novel/${novelId}/bookmarkData`\n}\nfunction urlNovelComments(novelId, offset, limit) {\n    return `https://www.pixiv.net/ajax/novels/comments/roots?novel_id=${novelId}&offset=${offset}&limit=${limit}&lang=zh`\n}\nfunction urlNovelCommentsReply(commentId, page) {\n    return `https://www.pixiv.net/ajax/novels/comments/replies?comment_id=${commentId}&page=${page}&lang=zh`\n}\nfunction urlNovelsRecommendInit(novelId, limit=9) {\n    return `https://www.pixiv.net/ajax/novel/${novelId}/recommend/init?limit=${limit}&lang=zh`\n}\nfunction urlNovelsRecommendDetailed(nidList) {\n    if (nidList.length >= 9) nidList.length = 9\n    return `https://www.pixiv.net/ajax/novel/recommend/novels?${nidList.map(v => `novelIds[]=${v}`).join(\"&\")}`\n}\n\nfunction urlSeriesUrl(seriesId) {\n    return `https://www.pixiv.net/novel/series/${seriesId}`\n}\nfunction urlSeriesDetailed(seriesId) {\n    return `https://www.pixiv.net/ajax/novel/series/${seriesId}?lang=zh`\n}\nfunction urlSeriesNovelsTitles(seriesId) {\n    return `https://www.pixiv.net/ajax/novel/series/${seriesId}/content_titles`\n}\nfunction urlSeriesNovels(seriesId, limit, offset) {\n    if (limit > 30) limit = 30\n    if (limit < 10) limit = 10\n    return `https://www.pixiv.net/ajax/novel/series_content/${seriesId}?limit=${limit}&last_order=${offset}&order_by=asc&lang=zh`\n}\n\nfunction urlUserUrl(userID) {\n    return `https://www.pixiv.net/users/${userID}/novels`\n}\nfunction urlUserDetailed(userID) {\n    return `https://www.pixiv.net/ajax/user/${userID}`\n}\nfunction urlUserWorkLatest(userID) {\n    return `https://www.pixiv.net/ajax/user/${userID}/works/latest`\n}\nfunction urlUserAllWorks(userId) {\n    return `https://www.pixiv.net/ajax/user/${userId}/profile/all?lang=zh`\n}\nfunction urlUserBookmarks(userId) {\n    return `https://www.pixiv.net/ajax/user/${userId}/novels/bookmarks?tag=&offset={{(page-1)*30}}&limit=30&rest=show&lang=zh`\n}\n\nfunction urlSearchNovel(novelName, page) {\n    return `https://www.pixiv.net/ajax/search/novels/${encodeURI(novelName)}?word=${encodeURI(novelName)}&order=date_d&mode=all&p=${page}&s_mode=s_tag&lang=zh`\n}\nfunction urlSearchSeries(seriesName, page) {\n    return`https://www.pixiv.net/ajax/search/novels/${encodeURI(seriesName)}?word=${encodeURI(seriesName)}&order=date_d&mode=all&p=${page}&s_mode=s_tag&gs=1&lang=zh`\n}\n// ‰∏çÂÆåÂÖ®ÂåπÈÖçÁî®Êà∑Âêç\nfunction urlSearchUser(userName, full) {\n    if (full === undefined || full === false) {\n        return `https://www.pixiv.net/search/users?nick=${userName}&s_mode=s_usr&nick_mf=1`\n    } else {\n        return `https://www.pixiv.net/search/users?nick=${userName}&s_mode=s_usr_full&i=1`\n    }\n}\n\nfunction urlCoverUrl(url) {\n    return `${url}, {\"headers\": {\"Referer\":\"https://www.pixiv.net/\"}}`\n}\nfunction urlIllustDetailed(illustId) {\n    return `https://www.pixiv.net/ajax/illust/${illustId}?lang=zh`\n}\nfunction urlIllustOriginal(illustId, order) {\n    const {java, cache} = this\n    if (order <= 1) order = 1\n    let url = urlIllustDetailed(illustId)\n    let illustOriginal = cacheGetAndSet(cache, url, () => {\n        return JSON.parse(java.ajax(url))\n    }).body.urls.original\n    return urlCoverUrl(illustOriginal.replace(`_p0`, `_p${order - 1}`))\n}\nfunction urlEmojiUrl(emojiId) {\n    return urlCoverUrl(`https://s.pximg.net/common/images/emoji/${emojiId}.png`)\n}\nfunction urlStampUrl(stampId) {\n    return urlCoverUrl(`https://s.pximg.net/common/images/stamp/generated-stamps/${stampId}_s.jpg`)\n}\n\nfunction urlMessageThreadLatest(max) {\n    if (max === undefined || max <= 5) max = 5\n    return `https://www.pixiv.net/rpc/index.php?mode=latest_message_threads2&num=${max}&lang=zh`\n}\nfunction urlMessageThreadContents(threadId, max) {\n    return `https://www.pixiv.net/rpc/index.php?mode=message_thread_contents&thread_id=${threadId}&num=${max}`\n}\nfunction urlMessageThreadDetail(threadId) {\n    return `https://www.pixiv.net/rpc/index.php?mode=message_thread&thread_id=${threadId}`\n}\nfunction urlNotification() {\n    return `https://www.pixiv.net/ajax/notification&lang=zh`\n}\n\nfunction dateFormat(str) {\n    let addZero = function (num) {\n        return num < 10 ? '0' + num : num;\n    }\n    let time = new Date(str);\n    let Y = time.getFullYear() + \"Âπ¥\";\n    let M = addZero(time.getMonth() + 1) + \"Êúà\";\n    let D = addZero(time.getDate()) + \"Êó•\";\n    return Y + M + D;\n}\nfunction timeFormat(str) {\n    let addZero = function (num) {\n        return num < 10 ? '0' + num : num;\n    }\n    let time = new Date(str);\n    let YY = time.getFullYear()\n    let MM = addZero(time.getMonth() + 1)\n    let DD = addZero(time.getDate())\n    let hh = addZero(time.getHours())\n    let mm = addZero(time.getMinutes())\n    let ss = addZero(time.getSeconds())\n    return `${YY}-${MM}-${DD} ${hh}:${mm}:${ss}`\n}\nfunction timeTextFormat(text) {\n    return `${text.slice(0, 10)} ${text.slice(11, 19)}`\n}\nfunction sleep(time) {\n    let endTime = new Date().getTime() + time\n    while(true){\n        if (new Date().getTime() > endTime){\n            return;\n        }\n    }\n}\nfunction sleepToast(text, second) {\n    const {java} = this\n    java.log(text)\n    // java.toast(text)\n    java.longToast(text)\n    if (second === undefined) second = 0.01\n    sleep(1000*second)\n}\n\nfunction updateSource() {\n    const {java, source} = this\n    java.longToast(\"üÜô Êõ¥Êñ∞‰π¶Ê∫ê\\n\\nJsdelivr CDN Êõ¥Êñ∞ÊúâÂª∂Ëøü\\nGithub Êõ¥Êñ∞ÈúÄ‰ª£ÁêÜ\")\n    let onlineSource, comment, sourceName, sourceNameCapitalize, index = 0\n    if (source.bookSourceUrl.includes(\"pixiv\")) sourceName = \"pixiv\"\n    else if (source.bookSourceUrl.includes(\"furrynovel\")) sourceName = \"linpx\"\n    sourceNameCapitalize = sourceName[0].toUpperCase() + sourceName.substring(1)\n\n    if (source.bookSourceName.includes(\"Â§áÁî®\")) index = 1\n    else if (source.bookSourceName.includes(\"Êº´Áîª\")) index = 2\n    if (source.bookSourceUrl.includes(\"furrynovel.com\")) {\n        sourceNameCapitalize = \"FurryNovel\"\n        index = 1\n    }\n\n    try {\n        let updateUrl = `https://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/${sourceName}.json`\n        onlineSource = JSON.parse(java.get(updateUrl,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body())[index]\n    } catch (e) {\n        try {\n            let updateUrl = `https://raw.githubusercontent.com/windyhusky/PixivSource/main/${sourceName}.json`\n            onlineSource = JSON.parse(java.get(updateUrl,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body())[index]\n        } catch (e) {\n            onlineSource = {lastUpdateTime: new Date().getTime(), bookSourceComment: source.bookSourceComment}\n        }\n    }\n    comment = onlineSource.bookSourceComment.split(\"\\n\")\n    // onlineSource = source\n    // comment = source.bookSourceComment.split(\"\\n\")\n\n    let htm = `\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Êõ¥Êñ∞ ${source.bookSourceName} ‰π¶Ê∫ê</title>\n    <style> \n    table { text-align: center; margin: 0 auto; } .ann { display: flex; justify-content: center; align-items: center; height: 5vh; } \n    button { background-color: rgb(76, 175, 80); color: white; border: none; border-radius: 4px; height: 6vh; width: 30vw; overflow: hidden; } \n    button span { cursor: pointer; display: inline-block; position: relative; transition: 0.4s; } \n    button span:after { content: '>'; position: absolute; opacity: 0; top: 0; right: 30px; transition: 0.2s; } \n    button:active span { padding-right: 20px; } \n    button:active span:after { opacity: 1; right: -40px; }\n    </style>\n</head>\n\n<body>\n    <table border=\"1\" cellspacing=\"0\">\n        <th colspan=\"2\"> ${source.bookSourceName} ‰π¶Ê∫ê <a href=\"https://github.com/windyhusky/PixivSource/blob/main/doc/${sourceNameCapitalize}.md\">üî∞ ‰ΩøÁî®ÊåáÂçó</a></th>\n        <tr>\n            <td>‚òÅÔ∏è ËøúÁ®ãÁâàÊú¨Ôºö${onlineSource.bookSourceComment.split(\"\\n\")[2].replace(\"‰π¶Ê∫êÁâàÊú¨Ôºö\", \"\")}</td>\n            <td>üìÜ Êõ¥Êñ∞Ôºö${timeFormat(onlineSource.lastUpdateTime)}</td>\n        </tr>\n        <tr>\n            <td>üì• Êú¨Âú∞ÁâàÊú¨Ôºö${source.bookSourceComment.split(\"\\n\")[2].replace(\"‰π¶Ê∫êÁâàÊú¨Ôºö\", \"\")}</td>\n            <td>üìÜ Êõ¥Êñ∞Ôºö${timeFormat(source.lastUpdateTime)}</td>\n        </tr> \n        <tr><td colspan=\"2\" style=\"text-align: left;\">${comment.slice(3, 10).join(\"<br>\")}</td></tr>\n        <tr><td colspan=\"2\" style=\"text-align: left;\">${comment.slice(comment.length-20, comment.length).join(\"<br>\")}</td></tr>\n    </table>\n    \n    <table border=\"0\" cellspacing=\"20\">\n        <th colspan=\"2\"> Êõ¥Êñ∞ ${source.bookSourceName} ‰π¶Ê∫ê </th>\n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/${sourceName}.json\">\n            <button><span>Êõ¥Êñ∞‰π¶Ê∫ê<br>(Jsdelivr CDN)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/btsrk.json\">\n            <button><span>Êõ¥Êñ∞ËÆ¢ÈòÖ<br>(Jsdelivr CDN)</span></button>\n            </a></div></td>\n        </tr>\n        \n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://raw.githubusercontent.com/windyhusky/PixivSource/main/${sourceName}.json\">\n            <button><span>‰π¶Ê∫êÈìæÊé•<br>(GitHub)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://raw.githubusercontent.com/windyhusky/PixivSource/main/btsrk.json\">\n            <button><span>ËÆ¢ÈòÖÈìæÊé•<br>(GitHub)</span></button>\n            </a></div></td>\n        </tr>\n        \n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://codeberg.org/DowneyRem/PixivSource/raw/branch/main/${sourceName}.json\">\n            <button><span>Â§áÁî®‰π¶Ê∫êÈìæÊé•<br>(Codeberg)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://codeberg.org/DowneyRem/PixivSource/raw/branch/main/btsrk.json\">\n            <button><span>Â§áÁî®ËÆ¢ÈòÖÈìæÊé•<br>(Codeberg)</span></button>\n            </a></div></td>\n        </tr>\n    </table>\n</body>\n</html>`;\n    java.startBrowser(`data:text/html;charset=utf-8;base64, ${java.base64Encode(htm)}`, 'Êõ¥Êñ∞‰π¶Ê∫ê');\n    return []\n}",
        "lastUpdateTime": 1759852800251,
        "loginCheckJs": "var util = {}\n\nfunction objStringify(obj) {\n    return JSON.stringify(obj, (n, v) => {\n        if (typeof v == \"function\")\n            return v.toString();\n        return v;\n    });\n}\nfunction isBackupSource() {\n    let isBackupSource = source.bookSourceName.includes(\"Â§áÁî®\")\n    cache.put(\"isBackupSource\", isBackupSource)\n    return isBackupSource\n}\n// Ê£ÄÊµã Ê∫êÈòÖ\n// ÂèØÁî® java.ajax() ‰∏çÂèØÁî® java.webview() java.ajaxAll()\n// ÂèØÁî® java.getCookie() cache.put() cache.get() ÈªòËÆ§ÂÄº‰∏∫ undefined\n// ÂèØÁî® java.startBrowser() ‰∏çÂèØÁî® java.startBrowserAwaitAwait\n// ÂèØÁî® source.bookSourceName source.getVariable() source.setVariable()Á≠â\n// java.getUserAgent() java.getWebViewUA() ÁõÆÂâçËøîÂõûÂÜÖÂÆπÁõ∏Âêå\nfunction isSourceRead() {\n    let isSourceReadStatus = java.getUserAgent() === java.getWebViewUA()\n    cache.put(\"isSourceRead\", isSourceReadStatus)\n    return isSourceReadStatus\n}\n\nfunction publicFunc() {\n    let u = {}, settings\n    // ËæìÂá∫‰π¶Ê∫ê‰ø°ÊÅØ\n    java.log(`üÖøÔ∏è ${source.bookSourceComment.split(\"\\n\")[0]}`)\n    java.log(`üìå ${source.bookSourceComment.split(\"\\n\")[2]}`)\n    if (isSourceRead()) {\n        java.log(`üìÜ Êõ¥Êñ∞Êó∂Èó¥Ôºö${java.timeFormat(source.lastUpdateTime)}`)\n        java.log(\"üì± ËΩØ‰ª∂Âπ≥Âè∞Ôºöüçé Ê∫êÈòÖ SourceRead\")\n    } else {\n        java.log(`üìÜ Êõ¥Êñ∞Êó∂Èó¥Ôºö${timeFormat(source.lastUpdateTime)}`)\n        java.log(\"üì± ËΩØ‰ª∂Âπ≥Âè∞Ôºöü§ñ ÂºÄÊ∫êÈòÖËØª Leagdo\")\n    }\n\n    // Ëé∑ÂèñËÆæÁΩÆÔºåÂ§áÁî®‰π¶Ê∫ê‰ΩøÁî®ÊóßÁâàËÆæÁΩÆÔºå‰π¶Ê∫ê‰ªéÁºìÂ≠òËé∑ÂèñËÆæÁΩÆ\n    if (isBackupSource()) {\n        settings = JSON.parse(String(source.variableComment).match(RegExp(/{([\\s\\S]*?)}/gm)))\n    } else {\n        // cache.delete(\"pixivSettings\")\n        settings = getFromCache(\"pixivSettings\")\n    }\n    if (settings !== null) {\n        java.log(\"‚öôÔ∏è ‰ΩøÁî®Ëá™ÂÆö‰πâËÆæÁΩÆ\")\n    } else {\n        settings = {}\n        settings.SEARCH_AUTHOR = true       // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n        settings.CONVERT_CHINESE = true     // ÊêúÁ¥¢ÔºöÊêúÁ¥¢Êó∂ËøõË°åÁπÅÁÆÄËΩ¨Êç¢\n        settings.SHOW_LIKE_NOVELS = true    // ÊêúÁ¥¢ÔºöÊêúÁ¥¢ÁªìÊûúÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥\n        settings.SHOW_WATCHED_SERIES = true // ÊêúÁ¥¢ÔºöÊêúÁ¥¢ÁªìÊûúÊòæÁ§∫ËøΩÊï¥Á≥ªÂàóÂ∞èËØ¥\n        settings.MORE_INFORMATION = false   // ËØ¶ÊÉÖÔºö‰π¶Á±çÁÆÄ‰ªãÊòæÁ§∫Êõ¥Â§ö‰ø°ÊÅØ\n        settings.SHOW_UPDATE_TIME = true    // ÁõÆÂΩïÔºöÊòæÁ§∫Êõ¥Êñ∞Êó∂Èó¥Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Â∞ëËÆ∏ËØ∑Ê±Ç\n        settings.SHOW_ORIGINAL_LINK = true  // ÁõÆÂΩïÔºöÊòæÁ§∫ÂéüÂßãÈìæÊé•Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Â§ßÈáèËØ∑Ê±Ç\n        settings.REPLACE_TITLE_MARKS = true // Ê≠£ÊñáÔºöÊ≥®Èü≥ÂÜÖÂÆπ‰∏∫Ê±âÂ≠óÊó∂ÔºåÊõøÊç¢‰∏∫‰π¶ÂêçÂè∑\n        settings.SHOW_CAPTIONS = true       // Ê≠£ÊñáÔºöÁ´†È¶ñÊòæÁ§∫ÊèèËø∞\n        settings.SHOW_COMMENTS = true       // Ê≠£ÊñáÔºöÁ´†Â∞æÊòæÁ§∫ËØÑËÆ∫\n        settings.FAST  = false              // ÂÖ®Â±ÄÔºöÂø´ÈÄüÊ®°Âºè\n        settings.DEBUG = false              // ÂÖ®Â±ÄÔºöË∞ÉËØïÊ®°Âºè\n        java.log(\"‚öôÔ∏è ‰ΩøÁî®ÈªòËÆ§ËÆæÁΩÆÔºàÊó†Ëá™ÂÆö‰πâËÆæÁΩÆ Êàñ Ëá™ÂÆö‰πâËÆæÁΩÆÊúâËØØÔºâ\")\n    }\n    if (settings.FAST === true) {\n        settings.SEARCH_AUTHOR = false        // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n        settings.CONVERT_CHINESE = false      // ÊêúÁ¥¢ÔºöÁπÅÁÆÄÈÄöÊêú\n        settings.SHOW_UPDATE_TIME = false     // ÁõÆÂΩïÔºöÊòæÁ§∫Á´†ËäÇÊõ¥Êñ∞Êó∂Èó¥\n        settings.SHOW_ORIGINAL_LINK = false   // ÁõÆÂΩïÔºöÊòæÁ§∫Á´†ËäÇÊ∫êÈìæÊé•\n        settings.SHOW_COMMENTS = false        // Ê≠£ÊñáÔºöÊòæÁ§∫ËØÑËÆ∫\n    } else {\n        settings.SEARCH_AUTHOR = true        // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n    }\n    settings.IS_LEGADO = !isSourceRead()\n    settings.IS_SOURCE_READ = isSourceRead()\n    settings.IS_BACKUP_SOURCE = isBackupSource()\n    u.settings = settings\n    putInCache(\"pixivSettings\", settings)  // ËÆæÁΩÆÂÜôÂÖ•ÁºìÂ≠ò\n\n    u.debugFunc = (func) => {\n        if (util.settings.DEBUG === true) {\n            func()\n        }\n    }\n\n    u.checkStatus = function(status) {\n        if (status === true) return \"‚úÖ Â∑≤\"\n        else if (status === false) return \"‚ùå Êú™\"\n        else if (status === undefined) return \"üàöÔ∏è Êó†Êï∞ÊçÆÔºö\"\n    }\n\n    u.login = function() {\n        let resp = java.startBrowserAwait(`https://accounts.pixiv.net/login,\n    {\"headers\": {\"User-Agent\": \"${java.getWebViewUA()}\"}}`, 'ÁôªÂΩïË¥¶Âè∑', false)\n        if (resp.code() === 200) {\n            this.getCsrfToken(); this.getCookie()\n        } else {\n            java.log(resp.code()); sleepToast(\"‚ö†Ô∏è ÁôªÂΩïÂ§±Ë¥•\")\n        }\n    }\n\n    u.logout = function() {\n        this.removeCookie()\n        java.startBrowser(\"https://www.pixiv.net/logout.php\", \"ÈÄÄÂá∫Ë¥¶Âè∑\")\n        this.removeCookie()\n        sleepToast(`‚úÖ Â∑≤ÈÄÄÂá∫ÂΩìÂâçË¥¶Âè∑\\n\\nÈÄÄÂá∫ÂêéËØ∑ÁÇπÂáªÂè≥‰∏äËßíÁöÑ ‚úîÔ∏è ÈÄÄÂá∫\\n\\nÁôªÂΩïËØ∑ÁÇπÂáª„ÄêÁôªÂΩïË¥¶Âè∑„ÄëËøõË°åÁôªÂΩï`)\n    }\n\n    u.getCookie = function() {\n        let pixivCookie = String(java.getCookie(\"https://www.pixiv.net/\", null))\n        if (isLogin()) cache.put(\"pixivCookie\", pixivCookie, 60*60)  // ÁºìÂ≠ò1h\n    }\n\n    u.removeCookie = function() {\n        cookie.removeCookie('https://www.pixiv.net')\n        cookie.removeCookie('https://accounts.pixiv.net')\n        cookie.removeCookie('https://accounts.google.com')\n        cookie.removeCookie('https://api.weibo.com')\n        cache.delete(\"pixivCookie\")\n        cache.delete(\"pixiv:uid\")\n        cache.delete(\"csfrToken\")  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥\n        cache.delete(\"headers\")\n    }\n\n    // Ëé∑Âèñ Csrf TokenÔºå‰ª•‰æøËøõË°åÊî∂ËóèÁ≠âËØ∑Ê±Ç\n    // Ëé∑ÂèñÊñπÊ≥ïÊù•Ëá™ËÑöÊú¨ Pixiv Previewer\n    // https://github.com/Ocrosoft/PixivPreviewer\n    // https://greasyfork.org/zh-CN/scripts/30766-pixiv-previewer/code\n    u.getCsrfToken = function() {\n        let csfrToken = cache.get(\"csfrToken\")\n        if (!csfrToken) {\n            let html = java.webView(null, \"https://www.pixiv.net/\", null)\n            try {\n                csfrToken = html.match(/token\\\\\":\\\\\"([a-z0-9]{32})/)[1]\n                cache.put(\"csfrToken\", csfrToken)  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n            } catch (e) {\n                csfrToken = null\n                cache.delete(\"csfrToken\")  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n                // sleepToast(\"‚ö†Ô∏è Êú™ÁôªÂΩïË¥¶Âè∑(csfrToken)\")\n            }\n            java.log(`csfrToken:\\n${csfrToken}`)\n        }\n        return csfrToken\n    }\n\n    // Â∞ÜÂ§ö‰∏™ÈïøÁØáÂ∞èËØ¥Ëß£Êûê‰∏∫‰∏ÄÊú¨‰π¶\n    u.combineNovels = function(novels) {\n        return novels.filter(novel => {\n            // ÂçïÊú¨Áõ¥Êé•Ëß£Êûê‰∏∫‰∏ÄÊú¨‰π¶\n            if (novel.seriesId === undefined || novel.seriesId === null) {\n                return true\n            }\n            // ÈõÜÂêà‰∏≠Ê≤°ÊúâËØ•Á≥ªÂàóËß£Êûê‰∏∫‰∏ÄÊú¨‰π¶\n            if (!seriesSet.has(novel.seriesId)) {\n                seriesSet.add(novel.seriesId)\n                return true\n            }\n            return false\n        })\n    }\n\n    // Â±èËîΩ‰ΩúËÄÖ\n    u.authorFilter = function(novels) {\n        let authors = getFromCache(\"blockAuthorList\")\n        if (authors !== null && authors.length >= 0) {\n            java.log(`üö´ Â±èËîΩ‰ΩúËÄÖIDÔºö${JSON.stringify(authors)}`)\n            authors.forEach(author => {\n                novels = novels.filter(novel => novel.userId !== String(author))\n            })\n        }\n        return novels\n    }\n\n\n    // ËøáÊª§Êî∂Ëóè‰∏éËøΩÊõ¥\n    u.novelFilter = function(novels) {\n        let novels1 = [], novels2 = [], msg\n        let likeNovels = getFromCache(\"likeNovels\")\n        let watchedSeries = getFromCache(\"watchedSeries\")\n        let novels0 = novels.map(novel => novel.id)\n\n        msg = util.checkStatus(util.settings.SHOW_LIKE_NOVELS).replace(\"Êú™\",\"‰∏ç\")\n        java.log(`${msg}ÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥`)\n        if (util.settings.SHOW_LIKE_NOVELS === false) {\n            novels = novels.filter(novel => !likeNovels.includes(Number(novel.id)))\n            novels1 = novels.map(novel => novel.id)\n            java.log(`‚è¨ ËøáÊª§Êî∂ËóèÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels1.length}`)\n        }\n\n        msg = util.checkStatus(util.settings.SHOW_WATCHED_SERIES).replace(\"Êú™\",\"‰∏ç\")\n        java.log(`${msg}ÊòæÁ§∫ËøΩÊõ¥Á≥ªÂàó`)\n        if (util.settings.SHOW_WATCHED_SERIES === false) {\n            novels = novels.filter(novel => !watchedSeries.includes(Number(novel.seriesId)))\n            novels2 = novels.map(novel => novel.id)\n            if (novels1.length >= 1) novels0 = novels1\n            java.log(`‚è¨ ËøáÊª§ËøΩÊõ¥ÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n        }\n\n        let novels3 = novels.map(novel => novel.id)\n        if (novels0.length >= 1 && novels3.length === 0) {\n            let msg = `‚è¨ ËøáÊª§Â∞èËØ¥\\n‚ö†Ô∏è ËøáÊª§ÂêéÊó†ÁªìÊûú\\n\\nËØ∑Ê†πÊçÆÈúÄË¶Å\\n`\n            if (util.settings.SHOW_LIKE_NOVELS === false) msg += \"ÂºÄÂêØÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥\\n\"\n            if (util.settings.SHOW_WATCHED_SERIES === false) msg += \"ÂºÄÂêØÊòæÁ§∫ËøΩÊõ¥Á≥ªÂàó\"\n            sleepToast(msg, 1)\n        }\n\n        util.debugFunc(() => {\n            // java.log(JSON.stringify(novels0))\n            java.log(JSON.stringify(novels0.length))\n            // java.log(JSON.stringify(novels1))\n            java.log(JSON.stringify(novels1.length))\n            // java.log(JSON.stringify(novels2))\n            java.log(JSON.stringify(novels2.length))\n        })\n        return novels\n    }\n\n    // ËøáÊª§ÊèèËø∞‰∏éÊ†áÁ≠æÔºàÂ±èËîΩÊ†áÁ≠æ/Â±èËîΩÊèèËø∞Ôºâ\n    u.novelFilter2 = function(novels) {\n        let novels0 = novels.map(novel => novel.id)\n        let captionBlockWords = getFromCache(\"captionBlockWords\")\n        if (captionBlockWords === null) captionBlockWords = []\n        if (captionBlockWords) {\n            // ‰ªÖ‰øùÁïôÊ≤°Êúâ‰ªª‰ΩïÂ±èËîΩËØçÁöÑÂ∞èËØ¥\n            // novels = novels.filter(novel => {\n            //     return !captionBlockWords.some(item => {\n            //         if (novel.description !== undefined) return novel.description.includes(item)\n            //     })\n            // })\n            novels = novels.filter(novel => !captionBlockWords.some(item => novel.description.includes(item)))\n            let novels2 = novels.map(novel => novel.id)\n            java.log(`üö´ Â±èËîΩÊèèËø∞Ôºö${captionBlockWords.join(\"\\n\")}`)\n            java.log(`üö´ Â±èËîΩÊèèËø∞ÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n        }\n\n        let tagsBlockWords = getFromCache(\"tagsBlockWords\")\n        if (tagsBlockWords === null) tagsBlockWords = []\n        if (tagsBlockWords) {\n            // ‰ªÖ‰øùÁïôÊ≤°Êúâ‰ªª‰ΩïÂ±èËîΩËØçÁöÑÂ∞èËØ¥\n            // novels = novels.filter(novel => {\n            //     return !tagsBlockWords.some(item => {\n            //         if (novel.tags !== undefined) return novel.tags.includes(item)\n            //     })\n            // })\n            novels = novels.filter(novel => !tagsBlockWords.some(item => novel.tags.includes(item)))\n            let novels2 = novels.map(novel => novel.id)\n            java.log(`üö´ Â±èËîΩÊ†áÁ≠æÔºö${tagsBlockWords.join(\"„ÄÅ\")}`)\n            java.log(`üö´ Â±èËîΩÊ†áÁ≠æÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n        }\n        return novels\n    }\n\n    // Êî∂ËóèÂ∞èËØ¥/ËøΩÊõ¥Á≥ªÂàó ÂÜôÂÖ•ÁºìÂ≠ò\n    u.saveNovels = function(listInCacheName, list) {\n        let listInCache = getFromCache(listInCacheName)\n        if (listInCache === null) listInCache = []\n\n        listInCache = listInCache.concat(list)\n        listInCache = Array.from(new Set(listInCache))\n        cache.put(listInCacheName, JSON.stringify(listInCache))\n\n        if (listInCacheName === \"likeNovels\") listInCacheName = \"‚ù§Ô∏è Êî∂ËóèÂ∞èËØ¥ID\"\n        else if (listInCacheName === \"watchedSeries\") listInCacheName = \"üìÉ ËøΩÊõ¥Á≥ªÂàóID\"\n        java.log(`${listInCacheName}Ôºö${JSON.stringify(listInCache)}`)\n    }\n\n    // Â§ÑÁêÜ novels ÂàóË°®\n    u.handNovels = function(novels) {\n        let likeNovels = [], watchedSeries = []\n        novels = util.authorFilter(novels)\n        novels.forEach(novel => {\n            // novel.id = novel.id\n            // novel.title = novel.title\n            // novel.userName = novel.userName\n            // novel.userId = novel.userId\n            // novel.tags = novel.tags\n            cache.put(`${novel.userName}`, novel.userId)  // Âä†ÂÖ•ÁºìÂ≠òÔºå‰æø‰∫éÊêúÁ¥¢‰ΩúËÄÖ\n            if (novel.tags === undefined || novel.tags === null) {\n                novel.tags = []\n            }\n            // ÊêúÁ¥¢ÂçïÁØá\n            if (novel.isOneshot === undefined) {\n                // novel.seriesId = novel.seriesId\n                // novel.seriesTitle = novel.seriesTitle\n                // novel.textCount = novel.textCount\n                // novel.description = novel.description\n                novel.coverUrl = novel.url\n                // novel.createDate = novel.createDate\n                // novel.updateDate = novel.updateDate\n            }\n\n            // ÊêúÁ¥¢Á≥ªÂàó\n            if (novel.isOneshot !== undefined) {\n                if (novel.isOneshot === true) {\n                    novel.seriesId = undefined\n                    novel.id = novel.novelId  // Ëé∑ÂèñÁúüÊ≠£ÁöÑ novelId\n                    novel.seriesTitle = undefined\n                } else {\n                    novel.seriesId = novel.id\n                    novel.id = novel.novelId = novel.latestEpisodeId  // Ëé∑ÂèñÁúüÊ≠£ÁöÑ novelId\n                    novel.seriesTitle = novel.title\n                    // novel.isWatched = novel.isWatched  // ÊêúÁ¥¢Á≥ªÂàóÂèØËé∑Âèñ\n                }\n                novel.textCount = novel.textLength\n                novel.description = novel.caption\n                novel.coverUrl = novel.cover.urls[\"480mw\"]\n                novel.createDate = novel.createDateTime\n                novel.updateDate = novel.updateDateTime\n            }\n\n            // ÂçïÁØáÊ≠£ÊñáËØ¶ÊÉÖÈ°µ\n            if (novel.content) {\n                novel.novelId = novel.id\n                novel.tags = novel.tags.tags.map(item => item.tag)\n                novel.textCount = novel.userNovels[`${novel.id}`].textCount\n                // novel.latestChapter = novel.title\n                // novel.description = novel.description\n                novel.coverUrl = novel.userNovels[`${novel.id}`].url\n                // novel.createDate = novel.createDate\n                novel.updateDate = novel.uploadDate\n\n                if (novel.seriesNavData) {\n                    novel.seriesId = novel.seriesNavData.seriesId\n                    novel.seriesTitle = novel.seriesNavData.title\n                }\n            }\n\n            // Á≥ªÂàóËØ¶ÊÉÖ\n            if (novel.firstNovelId) {\n                novel.seriesId = novel.id\n                novel.id = novel.novelId = novel.firstNovelId\n                novel.seriesTitle = novel.title\n                novel.coverUrl = novel.cover.urls[\"480mw\"]\n                // novel.isWatched = novel.isWatched  // ÊêúÁ¥¢Á≥ªÂàóÂèØËé∑Âèñ\n            }\n\n            // ÂçïÁØáÂä†Êõ¥Â§ö‰ø°ÊÅØ\n            if (!novel.seriesId) {\n                novel.tags.unshift(\"ÂçïÊú¨\")\n                novel.latestChapter = novel.title\n                novel.detailedUrl = urlNovelDetailed(novel.id)\n                novel.total = 1\n                if (novel.bookmarkData) {\n                    novel.isBookmark = true\n                    cache.put(`collect${novel.id}`, novel.bookmarkData.id)\n                    likeNovels.push(Number(novel.id))\n                } else {\n                    novel.isBookmark = false\n                }\n            }\n            // Á≥ªÂàóÊ∑ªÂä†Êõ¥Â§ö‰ø°ÊÅØ\n            if (novel.seriesId) {\n                let series = getAjaxJson(urlSeriesDetailed(novel.seriesId)).body\n                novel.id = series.firstNovelId\n                novel.title = series.title\n                novel.tags = novel.tags.concat(series.tags)\n                novel.tags.unshift(\"ÈïøÁØá\")\n                novel.textCount = series.publishedTotalCharacterCount\n                novel.description = series.caption\n                novel.coverUrl = series.cover.urls[\"480mw\"]\n                novel.detailedUrl = urlSeriesDetailed(novel.seriesId)\n                novel.createDate = series.createDate\n                novel.updateDate = series.updateDate\n                novel.total = series.publishedContentCount\n                novel.isWatched = series.isWatched\n                if (novel.isWatched === true) {\n                    watchedSeries.push(Number(novel.seriesId))\n                }\n\n                // ÂèëÈÄÅËØ∑Ê±ÇËé∑ÂèñÁ¨¨‰∏ÄÁ´† Ëé∑ÂèñÊ†áÁ≠æ‰∏éÁÆÄ‰ªã\n                let firstNovel = {}\n                try {\n                    firstNovel = getAjaxJson(urlNovelDetailed(series.firstNovelId)).body\n                    novel.tags = novel.tags.concat(firstNovel.tags.tags.map(item => item.tag))\n                    if (firstNovel.bookmarkData) {\n                        firstNovel.isBookmark = true\n                        cache.put(`collect${firstNovel.id}`, firstNovel.bookmarkData.id)\n                        likeNovels.push(Number(firstNovel.id))\n                    }\n                } catch (e) {  // Èò≤Ê≠¢Á≥ªÂàóÈ¶ñÁØáÊó†ÊùÉÈôêËé∑Âèñ\n                    try {\n                        firstNovel = getAjaxJson(urlSeriesNovels(novel.seriesId, 30, 0)).body.thumbnails.novel[0]\n                        novel.id = novel.firstNovelId = firstNovel.id\n                        novel.tags = novel.tags.concat(firstNovel.tags)\n                    } catch (e) { // Èò≤Ê≠¢Á≥ªÂàóÈ¶ñÁØáÊó†ÊùÉÈôêËé∑Âèñ\n                        firstNovel = {}\n                        firstNovel.description = \"\"\n                    }\n                }\n                novel.tags.unshift(\"ÈïøÁØá\")\n                if (novel.description === \"\") {\n                    novel.description = firstNovel.description\n                }\n            }\n        })\n        // Êî∂ËóèÂ∞èËØ¥/ËøΩÊõ¥Á≥ªÂàó ÂÜôÂÖ•ÁºìÂ≠ò\n        util.saveNovels(\"likeNovels\", likeNovels)\n        util.saveNovels(\"watchedSeries\", watchedSeries)\n        util.debugFunc(() => {\n            java.log(`Â§ÑÁêÜÂ∞èËØ¥ÂÆåÊàê`)\n        })\n        return novels\n    }\n\n    // Â∞èËØ¥‰ø°ÊÅØÊ†ºÂºèÂåñ\n    u.formatNovels = function(novels) {\n        novels = util.novelFilter(novels)\n        novels.forEach(novel => {\n            if (novel.title) novel.title = novel.title.trim()\n            if (!novel.userName.startsWith(\"@\")) novel.userName = `@${novel.userName}`\n            novel.coverUrl = urlCoverUrl(novel.coverUrl)\n            novel.readingTime = `${novel.readingTime / 60} ÂàÜÈíü`\n            novel.createDate = dateFormat(novel.createDate)\n            novel.updateDate = dateFormat(novel.updateDate)\n\n            novel.tags2 = []\n            for (let i in novel.tags) {\n                let tag = novel.tags[i]\n                if (tag.includes(\"/\")) {\n                    let tags = tag.split(\"/\")\n                    novel.tags2 = novel.tags2.concat(tags)\n                } else {\n                    novel.tags2.push(tag)\n                }\n            }\n            novel.tags = Array.from(new Set(novel.tags2))\n            novel.tags = novel.tags.join(\",\")\n            if (novel.seriesId) {\n                collectMsg = `üìÉ ËøΩÊõ¥Ôºö${util.checkStatus(novel.isWatched)}ËøΩÊõ¥Á≥ªÂàó`\n            } else {\n                collectMsg = `‚ù§Ô∏è Êî∂ËóèÔºö${util.checkStatus(novel.isBookmark)}Âä†ÂÖ•Êî∂Ëóè`\n            }\n\n            if (util.settings.MORE_INFORMATION) {\n                novel.description = `\\nüÖøÔ∏è ÁôªÂΩïÔºö${util.checkStatus(isLogin())}ÁôªÂΩïË¥¶Âè∑\n                ${collectMsg}\\nüìñ ‰π¶ÂêçÔºö${novel.title}\\nüë§ ‰ΩúËÄÖÔºö${novel.userName}\n                #Ô∏è Ê†áÁ≠æÔºö${novel.tags}\\n‚¨ÜÔ∏è ‰∏ä‰º†Ôºö${novel.createDate}\n                üîÑ Êõ¥Êñ∞Ôºö${novel.updateDate}\\nüìÑ ÁÆÄ‰ªãÔºö${novel.description}`\n            } else {\n                novel.description = `\\nüÖøÔ∏è ÁôªÂΩïÔºö${util.checkStatus(isLogin())}ÁôªÂΩïË¥¶Âè∑\n                ${collectMsg}\\n‚¨ÜÔ∏è ‰∏ä‰º†Ôºö${novel.createDate}\\nüîÑ Êõ¥Êñ∞Ôºö${novel.updateDate}\n                üìÑ ÁÆÄ‰ªãÔºö${novel.description}`\n            }\n        })\n        novels = util.novelFilter2(novels)\n        return novels\n    }\n\n    // Ê≠£ÊñáÔºåËØ¶ÊÉÖÔºåÊêúÁ¥¢Ôºö‰ªéÁΩëÂùÄËé∑ÂèñidÔºåËøîÂõûÂçïÁØáÂ∞èËØ¥ resÔºåÁ≥ªÂàóËøîÂõûÈ¶ñÁØáÂ∞èËØ¥ res\n    // pixiv ÈªòËÆ§ÂàÜ‰∫´‰ø°ÊÅØ‰∏≠Êúâ#Âè∑Ôºå‰∏ç‰ºöË¢´ËØÜÂà´ÊàêÈìæÊé•ÔºåÊó†Ê≥ï‰ΩøÁî®Ê∑ªÂä†ÁΩëÂùÄ\n    u.getNovelRes = function(result) {\n        let novelId = 0, res = {\"body\": {}}\n        let isJson = isJsonString(result)\n        let isHtml = isHtmlString(result)\n\n        if (!isJson && isHtml) {\n            let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n            let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net(/ajax)?/users?/\\\\d+\"\n            let isAuthor = baseUrl.match(new RegExp(pattern))\n            if (isAuthor) {\n                java.log(`‰ΩúËÄÖIDÔºö${id}`)\n                novelId = Object.keys(getAjaxJson(urlUserWorkLatest(id)).body.novels).reverse()[0]\n            }\n\n            pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/series/\\\\d+\"\n            let isSeries = baseUrl.match(new RegExp(pattern))\n            if (isSeries) {\n                java.log(`Á≥ªÂàóIDÔºö${id}`)\n                try {\n                    novelId = getAjaxJson(urlSeriesDetailed(id)).body.firstNovelId\n                } catch (e) {\n                    novelId = getAjaxJson(urlSeriesNovels(id, 30, 0)).body.thumbnails.novel[0].id\n                }\n            } else {\n                let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/(show\\\\.php\\\\?id=)?\\\\d+\"\n                let isNovel = baseUrl.match(new RegExp(pattern))\n                if (isNovel) {\n                    novelId = id\n                }\n            }\n        }\n        if (isJson) {\n            res = JSON.parse(result)\n        }\n\n        if (novelId) {\n            java.log(`ÂåπÈÖçÂ∞èËØ¥IDÔºö${novelId}`)\n            res = getAjaxJson(urlNovelDetailed(novelId))\n        }\n        if (res.error === true) {\n            java.log(`Êó†Ê≥ï‰ªé Pixiv Ëé∑ÂèñÂΩìÂâçÂ∞èËØ¥`)\n            java.log(JSON.stringify(res))\n        }\n        return res.body\n    }\n\n    // ÁõÆÂΩïÔºö‰ªéÁΩëÂùÄËé∑ÂèñidÔºåÂ∞ΩÂèØËÉΩËøîÂõûÁ≥ªÂàó resÔºåÂçïÁØáÂ∞èËØ¥ËøîÂõûÂ∞èËØ¥ res\n    u.getNovelResSeries = function(result) {\n        let seriesId = 0, res = {\"body\": {}}\n        let isJson = isJsonString(result)\n        let isHtml = isHtmlString(result)\n\n        if (!isJson && isHtml) {\n            let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n            let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/series/\\\\d+\"\n            let isSeries = baseUrl.match(new RegExp(pattern))\n            if (isSeries) {\n                seriesId = id\n            } else {\n                let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/(show\\\\.php\\\\?id=)?\\\\d+\"\n                let isNovel = baseUrl.match(new RegExp(pattern))\n                if (isNovel) {\n                    java.log(`ÂåπÈÖçÂ∞èËØ¥IDÔºö${id}`)\n                    res = getAjaxJson(urlNovelDetailed(id))\n                }\n            }\n        }\n        if (isJson) {\n            res = JSON.parse(result)\n        }\n\n        if (res.body && res.body.seriesNavData) {\n            seriesId = res.body.seriesNavData.seriesId\n        }\n        if (seriesId) {\n            java.log(`Á≥ªÂàóIDÔºö${seriesId}`)\n            res = getAjaxJson(urlSeriesDetailed(seriesId))\n        }\n        if (res.error === true) {\n            java.log(`Êó†Ê≥ï‰ªé Pixiv Ëé∑ÂèñÂΩìÂâçÂ∞èËØ¥`)\n            java.log(JSON.stringify(res))\n        }\n        return res.body\n    }\n\n    util = u\n    java.put(\"util\", objStringify(u))\n}\n\nfunction checkMessageThread(checkTimes) {\n    if (checkTimes === undefined) {\n        checkTimes = cache.get(\"checkTimes\")\n    }\n    if (checkTimes === 0 && isLogin()) {\n        let latestMsg = getAjaxJson(urlMessageThreadLatest(5))\n        if (latestMsg.error === true) {\n            java.log(JSON.stringify(latestMsg))\n        } else if (latestMsg.body.total >= 1) {\n            let msg = latestMsg.body.message_threads.filter(item => item.thread_name === \"pixiv‰∫ãÂãôÂ±Ä\")[0]\n            if (msg && new Date().getTime()- 1000*msg.modified_at <= 3*24*60*60*1000) { // 3Â§©ÂÜÖËøõË°åÊèêÁ§∫\n                sleepToast(`ÊÇ®‰∫é ${timeFormat(1000*msg.modified_at)} Ëß¶Âèë Pixiv „ÄêËøáÂ∫¶ËÆøÈóÆ„ÄëÔºåËØ∑‰øÆÊîπÂØÜÁ†ÅÂπ∂ÈáçÊñ∞ÁôªÂΩï„ÄÇ\\nÂ¶ÇÂ∑≤‰øÆÊîπËØ∑ÂøΩÁï•`, 3)\n                sleepToast(`${msg.latest_content}`, 5)\n                java.startBrowser(\"https://accounts.pixiv.net/password/change\",'‰øÆÊîπÂØÜÁ†Å')\n            }\n        }\n    }\n    cache.put(\"checkTimes\", checkTimes + 1, 4*60*60)  // ÁºìÂ≠ò4hÔºåÊØè4hÊèêÈÜí‰∏ÄÊ¨°\n    // cache.put(\"checkTimes\", checkTimes + 1, 60)  // ÊµãËØïÁî®ÔºåÁºìÂ≠ò60sÔºåÊØèÂàÜÈíüÊèêÈÜí‰∏ÄÊ¨°\n    // java.log(checkTimes + 1)\n}\n\n// Ëé∑ÂèñËØ∑Ê±ÇÁöÑuser idÊñπ‰æøÂÖ∂‰ªñajaxËØ∑Ê±ÇÊûÑÈÄ†\nfunction getPixivUid() {\n    let uid = cache.get(\"pixiv:uid\")\n    if (!uid || String(uid) === \"null\") {\n        let html = java.webView(null, \"https://www.pixiv.net/\", null)\n        try {\n            uid = html.match(/user_id:'(\\d+)'/)[1]\n        } catch (e) {\n            uid = null\n        }\n        cache.put(\"pixiv:uid\", String(uid))\n    }\n}\n\nfunction getHeaders() {\n    let headers = {\n        \"accept\": \"application/json\",\n        \"accept-encoding\": \"gzip, deflate, br, zstd\",\n        \"accept-language\": \"zh-CN\",\n        // \"content-type\": \"application/json; charset=utf-8\",\n        // \"content-type\": \"application/x-www-form-urlencoded; charset=utf-8\",\n        \"origin\": \"https//www.pixiv.net\",\n        \"referer\": \"https://www.pixiv.net/\",\n        // \"sec-ch-ua\": `\"Not/A)Brand\";v=\"8\", \"Chromium\";v=\"132\", \"Google Chrome\";v=\"132\"`,\n        // \"sec-ch-ua-mobile\": \"?0\",\n        // \"sec-ch-ua-platform\": \"Windows\",\n        // \"sec-fetch-dest\": \"empty\",\n        // \"sec-fetch-mode\": \"cors\",\n        // \"sec-fetch-site\": \"same-origin\",\n        \"user-agent\": cache.get(\"userAgent\"),\n        \"x-csrf-token\": cache.get(\"csfrToken\"),\n        \"Cookie\": cache.get(\"pixivCookie\")\n    }\n    putInCache(\"headers\", headers)\n    return headers\n}\n\n\npublicFunc()\nif (result.code() === 200) {\n    getPixivUid(); getWebViewUA(); util.getCookie(); util.getCsrfToken(); getHeaders()\n    if (!util.settings.FAST) checkMessageThread()   // Ê£ÄÊµãËøáÂ∫¶ËÆøÈóÆ\n}\n\nutil.debugFunc(() => {\n    java.log(`DEBUG = ${util.settings.DEBUG}\\n`)\n    java.log(JSON.stringify(util.settings, null, 4))\n    java.log(`${getWebViewUA()}\\n`)\n    java.log(`${cache.get(\"csfrToken\")}\\n`)\n    java.log(`${cache.get(\"pixivCookie\")}\\n`)\n    java.log(`${cache.get(\"headers\")}\\n`)\n})\n\njava.getStrResponse(null, null)",
        "loginUi": "[\n    {\n        \"name\": \"\\uD83C\\uDD7FÔ∏è ÁôªÂΩïË¥¶Âè∑\",\n        \"type\": \"button\",\n        \"action\": \"login()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"‚öôÔ∏è Ë¥¶Âè∑ËÆæÁΩÆ\",\n        \"type\": \"button\",\n        \"action\": \"startPixivSettings()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDD19 ÈÄÄÂá∫Ë¥¶Âè∑\",\n        \"type\": \"button\",\n        \"action\": \"logout()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"üÜô Êõ¥Êñ∞‰π¶Ê∫ê\",\n        \"type\": \"button\",\n        \"action\": \"updateSource()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDD30 ‰ΩøÁî®ÊåáÂçó\",\n        \"type\": \"button\",\n        \"action\": \"startGithubReadme()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDC1E ÂèçÈ¶àÈóÆÈ¢ò\",\n        \"type\": \"button\",\n        \"action\": \"startGithubIssue()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"‚ù§Ô∏è ÂÖ¨ÂºÄÊî∂Ëóè\",\n        \"type\": \"button\",\n        \"action\": \"novelBookmarkFactory(1)\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDCC3 ËøΩÊõ¥Á≥ªÂàó\",\n        \"type\": \"button\",\n        \"action\": \"seriesWatchFactory()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"‚ù§Ô∏è Êî∂ËóèÁ≥ªÂàó\",\n        \"type\": \"button\",\n        \"action\": \"novelsBookmarkAdd()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDDA4 ÂèñÊ∂àÊî∂Ëóè\",\n        \"type\": \"button\",\n        \"action\": \"novelsBookmarkDelete()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"‚≠êÔ∏è ÂÖ≥Ê≥®‰ΩúËÄÖ\",\n        \"type\": \"button\",\n        \"action\": \"userFollowFactory()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDEAB Â±èËîΩ‰ΩúËÄÖ\",\n        \"type\": \"button\",\n        \"action\": \"userBlock()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n\n    {\n        \"name\": \"ËæìÂÖ•ÂÜÖÂÆπ\",\n        \"type\": \"text\"\n    },\n    {\n        \"name\": \"‚úÖ ÂèëÈÄÅËØÑËÆ∫\",\n        \"type\": \"button\",\n        \"action\": \"novelCommentAdd()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDDD1 Âà†Èô§ËØÑËÆ∫\",\n        \"type\": \"button\",\n        \"action\": \"novelCommentDelete()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83E\\uDDF9 Ê∏ÖÈô§ÁºìÂ≠ò\",\n        \"type\": \"button\",\n        \"action\": \"cleanCache()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n\n    {\n        \"name\": \"\\uD83D\\uDEAB Ê∑ªÂä†Â±èËîΩ\",\n        \"type\": \"button\",\n        \"action\": \"blockAddFactory()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"‚≠ïÔ∏è Âà†Èô§Â±èËîΩ\",\n        \"type\": \"button\",\n        \"action\": \"blockDeleteFactory()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDC40 Êü•ÁúãÂ±èËîΩ\",\n        \"type\": \"button\",\n        \"action\": \"blockShowFactory()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n\n    {\n        \"name\": \"\\uD83D\\uDCCC ÂñúÊ¨¢Ê†áÁ≠æ\",\n        \"type\": \"button\",\n        \"action\": \"likeTagsAdd()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDDD1 Âà†Èô§Ê†áÁ≠æ\",\n        \"type\": \"button\",\n        \"action\": \"likeTagsDelete()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDC40 Êü•ÁúãÊ†áÁ≠æ\",\n        \"type\": \"button\",\n        \"action\": \"likeTagsShow()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n\n    {\n        \"name\": \"‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\",\n        \"type\": \"button\",\n        \"action\": \"likeAuthorsAdd()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDDA4 ÂèñÊ∂àÊî∂Ëóè\",\n        \"type\": \"button\",\n        \"action\": \"likeAuthorsDelete()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDC40 Êü•ÁúãÊî∂Ëóè\",\n        \"type\": \"button\",\n        \"action\": \"likeAuthorsShow()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n\n    {\n        \"name\": \"‰π¶Ê∫êËÆæÁΩÆ\",\n        \"type\": \"text\"\n    },\n    {\n        \"name\": \"‚öôÔ∏è ÂΩìÂâçËÆæÁΩÆ\",\n        \"type\": \"button\",\n        \"action\": \"showSettings()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDD27 ÈªòËÆ§ËÆæÁΩÆ\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDC64 ÊêúÁ¥¢‰ΩúËÄÖ\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('SEARCH_AUTHOR')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83C\\uDC04 ÁπÅÁÆÄÈÄöÊêú\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('CONVERT_CHINESE')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDCD6 Êõ¥Â§öÁÆÄ‰ªã\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('MORE_INFORMATION')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDCC5 Êõ¥Êñ∞Êó∂Èó¥\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('SHOW_UPDATE_TIME')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDD17 ÂéüÂßãÈìæÊé•\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('SHOW_ORIGINAL_LINK')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDCDA ÊÅ¢Â§ç„Ää„Äã\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('REPLACE_TITLE_MARKS')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDDBCÔ∏è ÊòæÁ§∫ÊèèËø∞\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('SHOW_CAPTIONS')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDCAC ÊòæÁ§∫ËØÑËÆ∫\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('SHOW_COMMENTS')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"‚ù§Ô∏è ÊòæÁ§∫Êî∂Ëóè\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('SHOW_LIKE_NOVELS')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDCC3 ÊòæÁ§∫ËøΩÊõ¥\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('SHOW_WATCHED_SERIES')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"‚è© Âø´ÈÄüÊ®°Âºè\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('FAST')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDC1E Ë∞ÉËØïÊ®°Âºè\",\n        \"type\": \"button\",\n        \"action\": \"editSettings('DEBUG')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDD0D ÊêúÁ¥¢ËØ¥Êòé\",\n        \"type\": \"button\",\n        \"action\": \"readMeSearch()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"\\uD83D\\uDCC4 ÊêúÁ¥¢È°µÁ†Å\",\n        \"type\": \"button\",\n        \"action\": \"showMaxPages()\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"‚è´ Â¢ûÂä†È°µÁ†Å\",\n        \"type\": \"button\",\n        \"action\": \"editMaxPages('add')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        \"name\": \"‚è¨ ÂáèÂ∞ëÈ°µÁ†Å\",\n        \"type\": \"button\",\n        \"action\": \"editMaxPages('minus')\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    }\n]",
        "loginUrl": "function login() {\n    sleepToast(\"üîÑ Ê≠£Âú®Ê£ÄÊµãÁôªÈôÜÁä∂ÊÄÅÔºåËØ∑Á®çÂÄô\")\n    if (isLogin()) {\n        sleepToast(\"Ô∏èüÖøÔ∏è ÁôªÂΩïË¥¶Âè∑\\n‚úÖ Â∑≤ÁªèÁôªÂΩïËøáË¥¶Âè∑‰∫Ü\\n\\nÂèØ‰ª•ÁÇπÂáª„Äêüîô ÈÄÄÂá∫Ë¥¶Âè∑„ÄëÊù•ÂàáÊç¢Ë¥¶Âè∑\")\n        return false\n    }\n\n    let resp = java.startBrowserAwait(`https://accounts.pixiv.net/login,\n    {\"headers\": {\"User-Agent\": ${getWebViewUA()}}}`, 'ÁôªÂΩïË¥¶Âè∑', false)\n    if (resp.code() === 200) {\n        getCsrfToken(); getCookie()\n        return true\n    } else {\n        java.log(resp.code()); sleepToast(\"üÖøÔ∏è ÁôªÂΩïË¥¶Âè∑\\n\\n‚ö†Ô∏è ÁôªÂΩïÂ§±Ë¥•\")\n        return false\n    }\n}\n\nfunction logout() {\n    removeCookie()\n    java.startBrowser(\"https://www.pixiv.net/logout.php\", \"ÈÄÄÂá∫Ë¥¶Âè∑\")\n    removeCookie(); removeLikeDataCache(); removeSettingsCache()\n    sleepToast(`‚úÖ Â∑≤ÈÄÄÂá∫ÂΩìÂâçË¥¶Âè∑\\n\\nÈÄÄÂá∫ÂêéËØ∑ÁÇπÂáªÂè≥‰∏äËßíÁöÑ ‚úîÔ∏è ÈÄÄÂá∫\\n\\nÁôªÂΩïËØ∑ÁÇπÂáª„ÄêÁôªÂΩïË¥¶Âè∑„ÄëËøõË°åÁôªÂΩï`)\n}\n\nfunction removeCookie() {\n    cookie.removeCookie('https://www.pixiv.net')\n    cookie.removeCookie('https://accounts.pixiv.net')\n    cookie.removeCookie('https://accounts.google.com')\n    cookie.removeCookie('https://api.weibo.com')\n    cache.delete(\"pixivCookie\")\n    cache.delete(\"pixiv:uid\")\n    cache.delete(\"csfrToken\")  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥\n    cache.delete(\"headers\")\n}\n\nfunction removeCacheList(listName) {\n    let list = getFromCache(listName)\n    list.forEach(item => cache.delete(`collect${item}`))\n    if (listName !== \"blockAuthorList\") cache.delete(listName)\n}\n\nfunction removeLikeDataCache() {\n    // Âà†Èô§ likeNovels ‰∏é watchedSeries\n    removeCacheList(\"likeNovels\")\n    removeCacheList(\"watchedSeries\")\n}\n\nfunction removeSettingsCache() {\n    // Âà†Èô§ Ëá™Âä®ÁøªÈ°µÁöÑÊúÄÂ§ßÈ°µÁ†Å\n    cache.delete(\"maxPagesKey\")\n    cache.delete(\"novelsMaxPages\")\n    cache.delete(\"seriesMaxPages\")\n\n    // Âà†Èô§ Â±èËîΩ‰ΩúËÄÖÂêçÂçï\n    // removeCacheList(\"blockAuthorList\")\n    // Âà†Èô§  Â±èËîΩÂÖ≥ÈîÆËØç\n    // cache.delete(\"tagsBlockWords\")\n    // cache.delete(\"captionBlockWords\")\n}\n\nfunction getCookie() {\n    let pixivCookie = String(java.getCookie(\"https://www.pixiv.net/\", null))\n    if (isLogin()) cache.put(\"pixivCookie\", pixivCookie, 60*60)\n}\n\n// Ëé∑Âèñ Csrf TokenÔºå‰ª•‰æøËøõË°åÊî∂ËóèÁ≠âËØ∑Ê±Ç\n// Ëé∑ÂèñÊñπÊ≥ïÊù•Ëá™ËÑöÊú¨ Pixiv Previewer\n// https://github.com/Ocrosoft/PixivPreviewer\n// https://greasyfork.org/zh-CN/scripts/30766-pixiv-previewer/code\nfunction getCsrfToken() {\n    let csfrToken = cache.get(\"csfrToken\")\n    if (!csfrToken) {\n        let html = java.webView(null, \"https://www.pixiv.net/\", null)\n        try {\n            csfrToken = html.match(/token\\\\\":\\\\\"([a-z0-9]{32})/)[1]\n            cache.put(\"csfrToken\", csfrToken)  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n        } catch (e) {\n            csfrToken = null\n            cache.delete(\"csfrToken\")  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n            // sleepToast(\"‚ö†Ô∏è Êú™ÁôªÂΩïË¥¶Âè∑(csfrToken)\")\n        }\n        java.log(`csfrToken:\\n${csfrToken}`)\n    }\n    return csfrToken\n}\n\nfunction getNovel() {\n    let novel = source.getLoginInfoMap()\n    if (!novel) novel = getFromCache(\"novel\")\n    return novel\n}\n\nfunction getPostBody(url, body, headers) {\n    if (headers === undefined) headers = getFromCache(\"headers\")\n    if (isJsonString(body)) {\n        headers[\"content-type\"] = \"application/json; charset=utf-8\"\n    } else if (typeof body === \"string\") {\n        headers[\"content-type\"] = \"application/x-www-form-urlencoded; charset=utf-8\"\n    }\n    try {\n        java.log(`getPostBody(${url}, ${body}, ${headers})`)\n        return JSON.parse(java.post(url, body, headers).body())\n    } catch (e) {\n        e = String(e)\n        // sleepToast(e)\n        // sleepToast(JSON.stringify(headers))\n        if (e.includes(\"400\")) sleepToast(`üì§ getPostBody\\n\\n‚ö†Ô∏è Áº∫Â∞ë headers`, 1)\n        else if (e.includes(\"403\")) sleepToast(`üì§ getPostBody\\n\\n‚ö†Ô∏è Áº∫Â∞ë cookie Êàñ cookie ËøáÊúü`, 1)\n        else if (e.includes(\"404\")) sleepToast(`üì§ getPostBody\\n\\n‚ö†Ô∏è 404 Áº∫Â∞ë csfrToken `, 1)\n        else if (e.includes(\"422\")) sleepToast(`üì§ getPostBody\\n\\n‚ö†Ô∏è ËØ∑Ê±Ç‰ø°ÊÅØÊúâËØØ`, 1)\n        return {error: true, errMsg:e}\n    }\n}\n\nfunction novelBookmarkAdd(restrict=0) {\n    let novel = getNovel()\n    let resp = getPostBody(\n        \"https://www.pixiv.net/ajax/novels/bookmarks/add\",\n        JSON.stringify({\"novel_id\": novel.id, \"restrict\": restrict, \"comment\":\"\", \"tags\":[]})\n    )\n    if (resp.error === true) {\n        sleepToast(`‚ù§Ô∏è Êî∂ËóèÂ∞èËØ¥\\n\\n‚ö†Ô∏è Êî∂Ëóè„Äê${novel.title}„ÄëÂ§±Ë¥•`)\n        shareFactory(\"novel\")\n    } else if (resp.body === null) {\n        sleepToast(`‚ù§Ô∏è Êî∂ËóèÂ∞èËØ¥\\n\\n‚úÖ Â∑≤ÁªèÊî∂Ëóè„Äê${novel.title}„Äë‰∫Ü`)\n    } else {\n        cache.put(`collect${novel.id}`, resp.body)\n        sleepToast(`‚ù§Ô∏è Êî∂ËóèÂ∞èËØ¥\\n\\n‚úÖ Â∑≤Êî∂Ëóè„Äê${novel.title}„Äë`)\n\n        let likeNovels = getFromCache(\"likeNovels\")\n        likeNovels.push(Number(novel.id))\n        putInCache(\"likeNovels\", likeNovels)\n\n        let novelObj = getAjaxJson(urlNovelDetailed(novel.id))\n        novelObj.body.isBookmark = true\n        putInCache(urlNovelDetailed(novel.id), novelObj, cacheSaveSeconds)\n    }\n}\n\nfunction getNovelBookmarkId(novelId) {\n    let bookmarkId = getFromCache(`collect${novelId}`)\n    if (bookmarkId === null) {\n        bookmarkId = getAjaxJson(urlNovelBookmarkData(novelId), true).body.bookmarkData.id\n    }\n    return bookmarkId\n}\n\nfunction novelBookmarkDelete() {\n    let novel = getNovel()\n    let resp = getPostBody(\n        \"https://www.pixiv.net/ajax/novels/bookmarks/delete\",\n        `del=1&book_id=${getNovelBookmarkId(novel.id)}`\n    )\n    if (resp.error === true) {\n        sleepToast(`‚ù§Ô∏è Êî∂ËóèÂ∞èËØ¥\\n\\n‚ö†Ô∏è ÂèñÊ∂àÊî∂Ëóè„Äê${novel.title}„ÄëÂ§±Ë¥•`)\n        shareFactory(\"novel\")\n    } else {\n        cache.delete(`collect${novel.id}`)\n        sleepToast(`‚ù§Ô∏è Êî∂ËóèÂ∞èËØ¥\\n\\n‚úÖ Â∑≤ÂèñÊ∂àÊî∂Ëóè„Äê${novel.title}„Äë`)\n\n        let likeNovels = getFromCache(\"likeNovels\")\n        likeNovels = likeNovels.filter(item => item !== Number(novel.id))\n        putInCache(\"likeNovels\", likeNovels)\n\n        let novelObj = getAjaxJson(urlNovelDetailed(novel.id))\n        novelObj.body.isBookmark = false\n        putInCache(urlNovelDetailed(novel.id), novelObj, cacheSaveSeconds)\n    }\n}\n\nfunction novelsBookmarkDelete() {\n    let novel = getNovel()\n    if (!novel.seriesId) {\n        sleepToast(`üñ§ ÂèñÊ∂àÊî∂ËóèÁ≥ªÂàó\\n\\n‚ö†Ô∏è „Äê${novel.title}„ÄëÈùûÁ≥ªÂàóÂ∞èËØ¥ÔºåÁé∞Â∑≤ÂèñÊ∂àÊî∂ËóèÊú¨ÁØáÂ∞èËØ¥`)\n        return novelBookmarkDelete(0)\n    } else {\n        sleepToast(`üñ§ ÂèñÊ∂àÊî∂ËóèÁ≥ªÂàó\\n\\nüîÑ Ê≠£Âú®ÂèñÊ∂àÊî∂ËóèÁ≥ªÂàó„Äê${novel.seriesTitle}„ÄëÔºåËØ∑Á®çÂêé‚Ä¶‚Ä¶`, 2)\n    }\n\n    let bookmarkIds = []\n    let novelIds = getFromCache(`novelIds${novel.seriesId}`)\n    novelIds.forEach(novelId => {bookmarkIds.push(getNovelBookmarkId(novelId))})\n    let resp = getPostBody(\n        \"https://www.pixiv.net/ajax/novels/bookmarks/remove\",\n        JSON.stringify({\"bookmarkIds\": bookmarkIds})\n    )\n    if (resp.error === true) {\n        sleepToast(`üñ§ ÂèñÊ∂àÊî∂ËóèÁ≥ªÂàó\\n\\n‚ö†Ô∏è ÂèñÊ∂àÊî∂Ëóè„Äê${novel.seriesTitle}„ÄëÁöÑÁØáÁõÆÂ§±Ë¥•`, 2)\n        shareFactory(\"series\")\n    } else {\n        sleepToast(`üñ§ ÂèñÊ∂àÊî∂ËóèÁ≥ªÂàó\\n\\n‚úÖ Â∑≤ÂèñÊ∂àÊî∂Ëóè„Äê${novel.seriesTitle}„ÄëÁöÑÂÖ®ÈÉ®ÁØáÁõÆ`)\n        novelIds.forEach(novelId => {cache.delete(`collect${novelId}`)})\n\n        let likeNovels = getFromCache(\"likeNovels\")\n        likeNovels = likeNovels.filter(item => !novelIds.includes(Number(item)))\n        putInCache(\"likeNovels\", likeNovels)\n\n        novelIds.forEach(novelId => {\n            let novelObj = getAjaxJson(urlNovelDetailed(novelId))\n            novelObj.body.isBookmark = false\n            putInCache(urlNovelDetailed(novelId), novelObj, cacheSaveSeconds)\n        })\n    }\n}\n\nfunction novelsBookmarkAdd() {\n    let novel = getNovel()\n    if (!novel.seriesId) {\n        sleepToast(`‚ù§Ô∏è Êî∂ËóèÁ≥ªÂàó\\n\\n‚ö†Ô∏è „Äê${novel.title}„ÄëÈùûÁ≥ªÂàóÂ∞èËØ¥ÔºåÁé∞Â∑≤Êî∂ËóèÊú¨ÁØáÂ∞èËØ¥`)\n        return novelBookmarkAdd(0)\n    } else {\n        sleepToast(`‚ù§Ô∏è Êî∂ËóèÁ≥ªÂàó\\n\\nüîÑ Ê≠£Âú®Êî∂ËóèÁ≥ªÂàó„Äê${novel.seriesTitle}„ÄëÔºåËØ∑Á®çÂêé‚Ä¶‚Ä¶`, 2)\n    }\n\n    let novelIds = getFromCache(`novelIds${novel.seriesId}`)\n    let likeNovels = getFromCache(\"likeNovels\")\n    if (likeNovels === null) likeNovels = []\n    novelIds.forEach(novelId => {\n        if (likeNovels && !likeNovels.includes(Number(novelId))) {\n            sleep(0.5 * 1000 * Math.random())\n            let resp = getPostBody(\n                \"https://www.pixiv.net/ajax/novels/bookmarks/add\",\n                JSON.stringify({\"novel_id\": novelId, \"restrict\": 0, \"comment\": \"\", \"tags\": []})\n            )\n\n            if (resp.error === true) {\n                sleepToast(`‚ù§Ô∏è Êî∂ËóèÁ≥ªÂàó\\n\\n‚ö†Ô∏è Êî∂Ëóè„Äê${novelId}„ÄëÂ§±Ë¥•`)\n                shareFactory(\"series\")\n            } else if (resp.body === null) {\n                // sleepToast(`‚ù§Ô∏è Êî∂ËóèÂ∞èËØ¥\\n\\n‚úÖ Â∑≤ÁªèÊî∂Ëóè„Äê${novel.title}„Äë‰∫Ü`)\n            } else {\n                cache.put(`collect${novelId}`, resp.body)\n                likeNovels.push(Number(novelId))\n\n                let novelObj = getAjaxJson(urlNovelDetailed(novelId))\n                novelObj.body.isBookmark = true\n                putInCache(urlNovelDetailed(novelId), novelObj, cacheSaveSeconds)\n            }\n        }\n    })\n    putInCache(\"likeNovels\", likeNovels)\n    sleepToast(`‚ù§Ô∏è Êî∂ËóèÁ≥ªÂàó\\n\\n‚úÖ Â∑≤ÁªèÊî∂Ëóè„Äê${novel.seriesTitle}„ÄëÂÖ®ÈÉ®Á´†ËäÇ`)\n}\n\nfunction novelBookmarkFactory(code) {\n    let novel = getNovel()\n    let collectId = getFromCache(`collect${novel.id}`)\n    if (collectId >= 1) code = 0\n\n    if (code === 0) novelBookmarkDelete()\n    else if (code === 1) novelBookmarkAdd(0)\n    else if (code === 2) novelBookmarkAdd(1)\n}\n\nfunction novelMarker(page=1) {\n    let novel = getNovel()\n    let lastMarker = getFromCache(`marker${novel.id}`)\n    if (lastMarker === true) page = 0\n\n    let resp = getPostBody(\n        \"https://www.pixiv.net/novel/rpc_marker.php\",\n        `mode=save&i_id=${novel.id}&u_id=${getFromCache(\"pixiv:uid\")}&page=${page}`\n    )\n    java.log(`mode=save&i_id=${novel.id}&u_id=${getFromCache(\"pixiv:uid\")}&page=${page}`)\n    if (resp.error === true) {\n        sleepToast(\"üè∑Ô∏è Ê∑ªÂä†‰π¶Á≠æ\\n\\n‚ö†Ô∏è Êìç‰ΩúÂ§±Ë¥•\", 1)\n        shareFactory(\"novel\")\n    } else if (lastMarker === true) {\n        cache.put(`marker${novel.id}`, false)\n        sleepToast(`üè∑Ô∏è Ê∑ªÂä†‰π¶Á≠æ\\n\\n‚úÖ Â∑≤Âà†Èô§‰π¶Á≠æ`)\n    } else {\n        cache.put(`marker${novel.id}`, true)\n        sleepToast(`üè∑Ô∏è Ê∑ªÂä†‰π¶Á≠æ\\n\\n‚úÖ Â∑≤Âä†ÂÖ•‰π¶Á≠æ`)\n    }\n}\n\nfunction seriesWatch() {\n    let novel = getNovel()\n    let resp = getPostBody(\n        `https://www.pixiv.net/ajax/novel/series/${novel.seriesId}/watch`,\n        \"{}\"\n    )\n    if (resp.error === true) {\n        sleepToast(`üìÉ ËøΩÊõ¥Á≥ªÂàó\\n\\n‚ö†Ô∏è ËøΩÊõ¥„Äê${novel.seriesTitle}„ÄëÂ§±Ë¥•`, 1)\n        shareFactory(\"series\")\n    } else {\n        cache.put(`watch${novel.seriesId}`, true)\n        sleepToast(`üìÉ ËøΩÊõ¥Á≥ªÂàó\\n\\n‚úÖ Â∑≤ËøΩÊõ¥„Äê${novel.seriesTitle}„Äë`)\n\n        let watchedSeries = getFromCache(\"watchedSeries\")\n        watchedSeries.push(Number(novel.seriesId))\n        putInCache(\"watchedSeries\", watchedSeries)\n\n        let novelObj = getAjaxJson(urlSeriesDetailed(novel.seriesId))\n        novelObj.body.isWatched = true\n        putInCache(urlSeriesDetailed(novel.seriesId), novelObj, cacheSaveSeconds)\n    }\n}\n\nfunction seriesUnWatch() {\n    let novel = getNovel()\n    let resp = getPostBody(\n        `https://www.pixiv.net/ajax/novel/series/${novel.seriesId}/unwatch`,\n        \"{}\"\n    )\n    if (resp.error === true) {\n        sleepToast(`üìÉ ËøΩÊõ¥Á≥ªÂàó\\n\\n‚ö†Ô∏è ÂèñÊ∂àËøΩÊõ¥„Äê${novel.seriesTitle}„ÄëÂ§±Ë¥•`, 1)\n        shareFactory(\"series\")\n    } else {\n        cache.delete(`watch${novel.seriesId}`)\n        sleepToast(`üìÉ ËøΩÊõ¥Á≥ªÂàó\\n\\n‚úÖ Â∑≤ÂèñÊ∂àËøΩÊõ¥„Äê${novel.seriesTitle}„Äë`)\n\n        let watchedSeries = getFromCache(\"watchedSeries\")\n        watchedSeries = watchedSeries.filter(item => item !== Number(novel.seriesId))\n        putInCache(\"watchedSeries\", watchedSeries)\n\n        let novelObj = getAjaxJson(urlSeriesDetailed(novel.seriesId))\n        novelObj.body.isWatched = false\n        putInCache(urlSeriesDetailed(novel.seriesId), novelObj, cacheSaveSeconds)\n    }\n}\n\nfunction seriesWatchFactory(code=1) {\n    let novel = getNovel()\n    if (!novel.seriesId) {\n        return sleepToast(`üìÉ ËøΩÊõ¥Á≥ªÂàó\\n\\n‚ö†Ô∏è „Äê${novel.title}„ÄëÈùûÁ≥ªÂàóÂ∞èËØ¥ÔºåÊó†Ê≥ïÂä†ÂÖ•ËøΩÊõ¥ÂàóË°®`)\n    }\n\n    let lastStatus = getFromCache(`watch${novel.seriesId}`)\n    if (lastStatus === true) code = 0\n    if (code === 0) seriesUnWatch()\n    else if (code === 1) seriesWatch()\n}\n\nfunction userFollow(restrict=0) {\n    let novel = getNovel()\n    let resp = getPostBody(\n        \"https://www.pixiv.net/bookmark_add.php\",\n        `mode=add&type=user&user_id=${novel.userId}&tag=\"\"&restrict=${restrict}&format=json`\n    )\n    if (resp.error === true) {\n        sleepToast(`‚≠êÔ∏è ÂÖ≥Ê≥®‰ΩúËÄÖ\\n\\n‚ö†Ô∏è ÂÖ≥Ê≥®„Äê${novel.userName}„ÄëÂ§±Ë¥•`, 1)\n        shareFactory(\"author\")\n    } else {\n        sleepToast(`‚≠êÔ∏è ÂÖ≥Ê≥®‰ΩúËÄÖ\\n\\n‚úÖ Â∑≤ÂÖ≥Ê≥®„Äê${novel.userName}„Äë`)\n        cache.put(`follow${novel.userId}`, true)\n    }\n}\n\nfunction userUnFollow() {\n    let novel = getNovel()\n    let resp = getPostBody(\n        \"https://www.pixiv.net/rpc_group_setting.php\",\n        `mode=del&type=bookuser&id=${novel.userId}`\n    )\n    if (resp.error === true) {\n        sleepToast(`‚≠êÔ∏è ÂÖ≥Ê≥®‰ΩúËÄÖ\\n\\n‚ö†Ô∏è ÂèñÊ∂àÂÖ≥Ê≥®„Äê${novel.userName}„ÄëÂ§±Ë¥•`, 1)\n        shareFactory(\"author\")\n    } else {\n        sleepToast(`‚≠êÔ∏è ÂÖ≥Ê≥®‰ΩúËÄÖ\\n\\n‚úÖ Â∑≤ÂèñÊ∂àÂÖ≥Ê≥®„Äê${novel.userName}„Äë`)\n        cache.delete(`follow${novel.userId}`)\n    }\n}\n\nfunction userFollowFactory(code=1) {\n    let novel = getNovel()\n    let lastStatus = getFromCache(`follow${novel.userId}`)\n    if (lastStatus === true) code = 0\n\n    if (code === 0) userUnFollow()\n    else if (code === 1) userFollow()\n}\n\nfunction userBlackList() {\n    let action = \"block\"  // ÊãâÈªë‰ΩúËÄÖÔºåÈùûÂ±èËîΩ‰ΩúËÄÖ‰ΩúÂìÅ\n    let novel = getNovel()\n    let lastStatus = getFromCache(`block${novel.userId}`)\n    if (lastStatus === true) action = \"unblock\"\n\n    let resp = getPostBody(\n        `https://www.pixiv.net/ajax/block/save`,\n        JSON.stringify({\"user_id\": novel.userId, \"action\": action})\n    )\n    // java.log(JSON.stringify({\"user_id\": novel.userId, \"action\": action}))\n    if (resp.error === true) sleepToast(\"‚ö†Ô∏è Êìç‰ΩúÂ§±Ë¥•\", 1)\n    else if (lastStatus === true) {\n        cache.put(`block${novel.userId}`, false)\n        sleepToast(`‚úÖ Â∑≤ÂèñÊ∂àÊãâÈªë„Äê${novel.userName}„Äë\\n\\nÂ∑≤ÂÖÅËÆ∏ÂÖ∂ÁÇπËµû„ÄÅËØÑËÆ∫„ÄÅÊî∂Ëóè„ÄÅÂÖ≥Ê≥®„ÄÅÁßÅ‰ø°Á≠â`)\n    } else {\n        cache.put(`block${novel.userId}`, true)\n        sleepToast(`‚úÖ Â∑≤ÊãâÈªë„Äê${novel.userName}„Äë(Pixiv)\\n\\nÂ∑≤Á¶ÅÊ≠¢ÂÖ∂ÁÇπËµû„ÄÅËØÑËÆ∫„ÄÅÊî∂Ëóè„ÄÅÂÖ≥Ê≥®„ÄÅÁßÅ‰ø°Á≠â`)\n    }\n}\n\nfunction userBlock() {\n    let authors = getFromCache(\"blockAuthorList\")\n    if (!authors) authors = []\n    let authorsMap = getFromCacheMap(\"blockAuthorMap\")\n    if (!authorsMap || authorsMap.size === 0) {\n        authorsMap = new Map()\n        authors.forEach(author => {\n            authorsMap.set(author, getAjaxJson(urlUserDetailed(author)).body.name)\n        })\n    }\n\n    let novel = getNovel()\n    if (authorsMap.has(String(novel.userId))) {\n        authorsMap.delete(String(novel.userId))\n        sleepToast(`üö´ Â±èËîΩ‰ΩúËÄÖ\\n\\n‚úÖ Â∑≤ÂèñÊ∂àÂ±èËîΩ„Äê${novel.userName}„Äë\\nÁé∞Â∑≤ÊÅ¢Â§çÊòæÁ§∫ÂÖ∂Â∞èËØ¥`)\n    } else if (!!novel.userId) {\n        authorsMap.set(String(novel.userId), novel.userName)\n        sleepToast(`üö´ Â±èËîΩ‰ΩúËÄÖ\\n\\n‚úÖ Êú¨Âú∞Â∑≤Â±èËîΩ„Äê${novel.userName}„Äë\\n‰ªäÂêé‰∏çÂÜçÊòæÁ§∫ÂÖ∂Â∞èËØ¥`)\n    }\n\n    authors = Array.from(authorsMap.keys())\n    putInCache(\"blockAuthorList\", authors)\n    putInCacheMap(\"blockAuthorMap\", authorsMap)\n    // source.setVariable(authors.toString())\n    // sleepToast(JSON.stringify(authors))\n}\n\nfunction novelCommentAdd() {\n    let resp, novel = getNovel()\n    let userId = getFromCache(\"pixiv:uid\")\n    let comment = String(result.get(\"ËæìÂÖ•ÂÜÖÂÆπ\")).trim()\n    if (comment === \"\") {\n        return sleepToast(`‚úÖ ÂèëÈÄÅËØÑËÆ∫\\n‚ö†Ô∏è ËØ∑Âú®„ÄêËæìÂÖ•ÂÜÖÂÆπ„ÄëËæìÂÖ•ËØÑËÆ∫\\n\\nËæìÂÖ•„ÄêËØÑËÆ∫ÂÜÖÂÆπÔºõËØÑËÆ∫ID„ÄëÂèØÂõûÂ§çËØ•Êù°ËØÑËÆ∫ÔºåÂ¶Ç„ÄêÈùûÂ∏∏ÂñúÊ¨¢Ôºõ123456„Äë\\n\\nüìå ÂΩìÂâçÁ´†ËäÇÔºö${novel.title}\\nÂ¶ÇÈùûÂΩìÂâçÁ´†ËäÇÔºåËØ∑Âà∑Êñ∞Ê≠£Êñá`)\n    }\n\n    let matched = comment.match(RegExp(/(Ôºõ|;\\s*)\\d{8,}/))\n    if (matched) {\n        let commentId = comment.match(new RegExp(/Ôºõ(\\d{8,})/))[1]\n        comment = comment.replace(new RegExp(`(Ôºõ|;\\s*)${commentId}`), \"\")\n        resp = getPostBody(\n            \"https://www.pixiv.net/novel/rpc/post_comment.php\",\n            `type=comment&novel_id=${novel.id}&author_user_id=${userId}&comment=${encodeURI(comment)}&parent_id=${commentId}`)\n    } else {\n        resp = getPostBody(\n            \"https://www.pixiv.net/novel/rpc/post_comment.php\",\n            `type=comment&novel_id=${novel.id}&author_user_id=${userId}&comment=${encodeURI(comment)}`\n        )\n    }\n\n    if (resp.error === true) {\n        sleepToast(\"‚úÖ ÂèëÈÄÅËØÑËÆ∫\\n\\n‚ö†Ô∏è ËØÑËÆ∫Â§±Ë¥•\", 1)\n        shareFactory(\"novel\")\n    } else {\n        sleepToast(`‚úÖ ÂèëÈÄÅËØÑËÆ∫\\n\\n‚úÖ Â∑≤Âú®„Äê${novel.title}„ÄëÂèëÂ∏ÉËØÑËÆ∫Ôºö\\n${comment}`)\n    }\n}\n\nfunction getNovelCommentID(novelId, commentText) {\n    let list = [], uid = String(getFromCache(\"pixiv:uid\"))\n    let resp = getAjaxJson(urlNovelComments(novelId, 0, 50), true)\n    resp.body.comments.forEach(comment => {\n        if (comment.userId === uid && comment.comment === commentText) list.push(comment.id)\n\n        if (comment.hasReplies === true) {\n            let resp = getAjaxJson(urlNovelCommentsReply(comment.id, 1), true)\n            resp.body.comments.forEach(comment => {\n                if (comment.userId === uid && comment.comment === commentText) list.push(comment.id)\n            })\n        }\n    })\n    // java.log(JSON.stringify(list))\n    return list\n}\n\nfunction novelCommentDelete() {\n    let commentIDs, novel = getNovel()\n    let comment = String(result.get(\"ËæìÂÖ•ÂÜÖÂÆπ\")).trim()\n    if (comment === \"\") {\n        return sleepToast(`üóë Âà†Èô§ËØÑËÆ∫\\n‚ö†Ô∏è ËØ∑Âú®„ÄêËæìÂÖ•ÂÜÖÂÆπ„ÄëËæìÂÖ•ÈúÄË¶ÅÂà†Èô§ÁöÑ„ÄêËØÑËÆ∫ID„Äë\\nÊàñËæìÂÖ•ÈúÄË¶ÅÂà†Èô§ÁöÑ„ÄêËØÑËÆ∫ÂÜÖÂÆπ„Äë\\n\\nüìå ÂΩìÂâçÁ´†ËäÇÔºö${novel.title}\\nÂ¶ÇÈùûÂΩìÂâçÁ´†ËäÇÔºåËØ∑Âà∑Êñ∞Ê≠£Êñá`)\n    }\n\n    let matched = comment.match(RegExp(/\\d{8,}/))\n    if (matched) {\n        commentIDs = [matched[0]]\n    } else {\n        commentIDs = getNovelCommentID(novel.id, comment)\n        java.log(JSON.stringify(commentIDs))\n        if (commentIDs.length === 0) {\n            return sleepToast(`üóë Âà†Èô§ËØÑËÆ∫\\n\\n‚ö†Ô∏è Êú™ËÉΩÊâæÂà∞ËøôÊù°ËØÑËÆ∫\\nËØ∑Ê£ÄÊü•ÊòØÂê¶ÊúâÈîôÂà´Â≠óÊàñÊ†áÁÇπÁ¨¶Âè∑ÊòØÂê¶‰∏ÄËá¥`)\n        }\n    }\n\n    commentIDs.forEach(commentID =>{\n        let resp = getPostBody(\n            \"https://www.pixiv.net/novel/rpc_delete_comment.php\",\n            `i_id=${novel.id}&del_id=${commentID}`\n        )\n        // java.log(JSON.stringify(resp))\n        if (resp.error === true) {\n            sleepToast(\"üóë Âà†Èô§ËØÑËÆ∫\\n\\n‚ö†Ô∏è ËØÑËÆ∫Âà†Èô§Â§±Ë¥•\", 1)\n            shareFactory(\"novel\")\n        } else {\n            sleepToast(`üóë Âà†Èô§ËØÑËÆ∫\\n\\n‚úÖ Â∑≤Âú®„Äê${novel.title}„ÄëÂà†Èô§ËØÑËÆ∫Ôºö\\n${comment}`)\n        }\n    })\n}\n\nfunction novelPollAnswer() {\n    let novel = getNovel()\n    // novel.pollChoicesCount = getAjaxJson(urlNovelDetailed(novel.id)).body.pollData.selectedValue\n    if (!novel.pollChoicesCount) {\n        return sleepToast(`üìÉ Â∞èËØ¥ÊäïÁ•®\\n\\n‚ö†Ô∏è ËØ•Â∞èËØ¥„Äê${novel.title}„ÄëÊó†ÊäïÁ•®‰ø°ÊÅØÔºåÂª∫ËÆÆ„ÄêÊ∏ÖÈô§ÁºìÂ≠ò„Äë„ÄêÂà∑Êñ∞„ÄëÂêéÈáçËØï`)\n    }\n\n    let choiceId = String(result.get(\"ËæìÂÖ•ÂÜÖÂÆπ\")).trim()\n    if (!choiceId) {\n        return sleepToast(`üìÉ Â∞èËØ¥ÊäïÁ•®\\n\\n‚ö†Ô∏è ÊäïÁ•®Â§±Ë¥•ÔºöËØ∑Âú®„ÄêËæìÂÖ•ÂÜÖÂÆπ„ÄëËæìÂÖ•ÊäïÁ•®ÈÄâÈ°π(Êï∞Â≠ó)`)\n    } else if (Number(choiceId) > novel.pollData.selectedValue) {\n        return sleepToast(`üìÉ Â∞èËØ¥ÊäïÁ•®\\n\\n‚ö†Ô∏è ÊäïÁ•®Â§±Ë¥•ÔºöÈÄâÈ°π${choiceId}Ë∂ÖÂá∫ËåÉÂõ¥`)\n    } else if (Number(choiceId) <= 0 || Number(choiceId) > novel.pollChoicesCount) {\n        return sleepToast(`üìÉ Â∞èËØ¥ÊäïÁ•®\\n\\n‚ö†Ô∏è ÊäïÁ•®Â§±Ë¥•ÔºöÈÄâÈ°π${choiceId}Ë∂ÖÂá∫ËåÉÂõ¥`)\n    }\n\n    let resp = getPostBody(\n        `https://www.pixiv.net/ajax/novel/${novel.id}/poll/answer`,\n        JSON.stringify({\"choice_id\": choiceId})\n    )\n    // 200 ÊàêÂäüÔºå403 ÈáçÂ§çÊäïÁ•®Ôºå400 ÈÄâÈ°πË∂ÖËøáËåÉÂõ¥\n    if (resp.error === true) {\n        if (resp.errMsg.includes(\"403\")) {\n            sleepToast(`üìÉ Â∞èËØ¥ÊäïÁ•®\\n\\n‚úÖ Â∑≤ÁªèÊäïËøáÁ•®‰∫Ü`)\n        } else {\n            sleepToast(`üìÉ Â∞èËØ¥ÊäïÁ•®\\n\\n‚ö†Ô∏è ÊäïÁ•®Â§±Ë¥•`)\n            shareFactory(\"novel\")\n        }\n    } else {\n        sleepToast(`üìÉ Â∞èËØ¥ÊäïÁ•®\\n\\n‚úÖ ÊäïÁ•®ÊàêÂäü`)\n    }\n}\n\nlet wordsType = {\n    \"caption\": \"üìÉ ÁÆÄ‰ªãÂ±èËîΩÂàóË°®\",\n    \"tags\": \"#Ô∏è Ê†áÁ≠æÂ±èËîΩÂàóË°®\",\n    \"authors\": \"üë§ ‰ΩúËÄÖÂ±èËîΩÂàóË°®\"\n}\n\nfunction printAuthorMap(map) {\n    let text = \"\"\n    map.forEach((value, key) => {\n        text += `@${value} ${key}\\n`\n    })\n    return text.trim()\n}\n\nfunction blockShowFactory() {\n    let keys = Object.keys(wordsType)\n    let key = getFromCache(\"wordsType\")\n\n    // ÂàáÊç¢Â±èËîΩÂàóË°®\n    let index = keys.indexOf(key) + 1\n    if (index === keys.length) index = 0\n    key = keys[index]\n    putInCache(\"wordsType\", key)\n\n    if (key === \"authors\") {\n        let words = printAuthorMap(getFromCacheMap(\"blockAuthorMap\"))\n        if (!words) words = \"\"\n        sleepToast(`üëÄ Êü•ÁúãÂ±èËîΩ\\n${wordsType[key]}\\n\\n${words}`, 2)\n    } else {\n        let words = getFromCache(`${key}BlockWords`)\n        if (!words) words = []\n        sleepToast(`üëÄ Êü•ÁúãÂ±èËîΩ\\n${wordsType[key]}\\n\\n${words.join(\"\\n\")}`, 2)\n    }\n}\n\nfunction blockWordAdd() {\n    let method = getFromCache(\"wordsType\")\n    let blockWords = getFromCache(`${method}BlockWords`)\n    if (blockWords === null) blockWords = []\n\n    let word = String(result.get(\"ËæìÂÖ•ÂÜÖÂÆπ\")).trim()\n    if (word === \"\") {\n        sleepToast(`üö´ Ê∑ªÂä†Â±èËîΩ\\n${wordsType[method]}\\n\\n‚ö†Ô∏è ËæìÂÖ•ÂÜÖÂÆπ‰∏çËÉΩ‰∏∫Á©∫`)\n    } else if (blockWords.includes(word)) {\n        sleepToast(`üö´ Ê∑ªÂä†Â±èËîΩ\\n${wordsType[method]}\\n\\n‚úÖ „Äê${word}„ÄëÂ∑≤ÁªèÂä†ÂÖ•Â±èËîΩÂàóË°®‰∫Ü`)\n    } else {\n        blockWords.push(word)\n        putInCache(`${method}BlockWords`, blockWords)\n        sleepToast(`üö´ Ê∑ªÂä†Â±èËîΩ\\n${wordsType[method]}\\n\\n‚úÖ Â∑≤Â∞Ü„Äê${word}„ÄëÂä†ÂÖ•Â±èËîΩÂàóË°®‰∏≠`)\n    }\n}\n\nfunction blockWordDelete() {\n    let method = getFromCache(\"wordsType\")\n    let blockWords = getFromCache(`${method}BlockWords`)\n    if (blockWords === null) blockWords = []\n\n    let word = String(result.get(\"ËæìÂÖ•ÂÜÖÂÆπ\")).trim()\n    if (word === \"\") {\n        sleepToast(`‚≠ïÔ∏è Âà†Èô§Â±èËîΩ\\n${wordsType[method]}\\n\\n‚ö†Ô∏è ËæìÂÖ•ÂÜÖÂÆπ‰∏çËÉΩ‰∏∫Á©∫`)\n    } else if (!blockWords.includes(word)) {\n        sleepToast(`‚≠ïÔ∏è Âà†Èô§Â±èËîΩ\\n${wordsType[method]}\\n\\n‚ö†Ô∏è „Äê${word}„Äë‰∏çÂú®Â±èËîΩÂàóË°®\\nËØ∑Ê£ÄÊü•ÊòØÂê¶ÊúâÈîôÂà´Â≠óÊàñÊ†áÁÇπÁ¨¶Âè∑ÊòØÂê¶‰∏ÄËá¥`)\n    } else {\n        blockWords = blockWords.filter(item => item !== word)\n        putInCache(`${method}BlockWords`, blockWords)\n        sleepToast(`‚≠ïÔ∏è Âà†Èô§Â±èËîΩ\\n${wordsType[method]}\\n\\n‚úÖ Â∑≤Âà†Èô§Â±èËîΩËØç„Äê${word}„Äë`)\n    }\n}\n\nfunction blockAuthorAdd() {\n    let method = getFromCache(\"wordsType\")\n    let blockAuthors = getFromCacheMap(`blockAuthorMap`)\n\n    let word = String(result.get(\"ËæìÂÖ•ÂÜÖÂÆπ\")).trim()\n    if (word === \"\") {\n        sleepToast(`üö´ Ê∑ªÂä†Â±èËîΩ\\n${wordsType[method]}\\n\\n‚ö†Ô∏è ËæìÂÖ•ÂÜÖÂÆπ‰∏çËÉΩ‰∏∫Á©∫\\n‚ö†Ô∏è ËæìÂÖ•„ÄêÁî®Êà∑ID„ÄëÂèØÂ±èËîΩËØ•‰ΩúËÄÖ`)\n    } else if (blockAuthors.has(word)) {\n        let text = `${blockAuthors.get(word)} ${word}`\n        sleepToast(`üö´ Ê∑ªÂä†Â±èËîΩ\\n${wordsType[method]}\\n\\n‚úÖ „Äê${text}„ÄëÂ∑≤ÁªèÂä†ÂÖ•Â±èËîΩÂàóË°®‰∫Ü`)\n    }\n    // ËæìÂÖ•Á∫ØÊï∞Â≠óÔºåÊ∑ªÂä†ÂØπÂ∫îIDÁöÑ‰ΩúËÄÖ\n    else if (!isNaN(word)) {\n        let user = getAjaxJson(urlUserDetailed(word)).body\n        blockAuthors.set(user.userId, user.name)\n        let text = `@${user.name} ${user.userId}`\n        sleepToast(`üö´ Ê∑ªÂä†Â±èËîΩ\\n${wordsType[method]}\\n\\n‚úÖ Â∑≤Â∞Ü„Äê${text}„ÄëÂä†ÂÖ•Â±èËîΩÂàóË°®‰∏≠`)\n    }\n    else if (word) {\n        sleepToast(`üö´ Ê∑ªÂä†Â±èËîΩ\\n${wordsType[method]}\\n\\n‚ö†Ô∏è ËæìÂÖ•„ÄêÁî®Êà∑ID„ÄëÂèØÂ±èËîΩËØ•‰ΩúËÄÖ`)\n    }\n    putInCacheMap(`blockAuthorMap`, blockAuthors)\n}\n\nfunction blockAuthorDelete() {\n    let method = getFromCache(\"wordsType\")\n    let blockAuthors = getFromCacheMap(`blockAuthorMap`)\n\n    let word = String(result.get(\"ËæìÂÖ•ÂÜÖÂÆπ\")).trim()\n    if (word === \"\") {\n        sleepToast(`‚≠ïÔ∏è Âà†Èô§Â±èËîΩ\\n${wordsType[method]}\\n\\n‚ö†Ô∏è ËæìÂÖ•ÂÜÖÂÆπ‰∏çËÉΩ‰∏∫Á©∫\\n‚ö†Ô∏è ËæìÂÖ•„ÄêÁî®Êà∑ID„ÄëÂèØÂ±èËîΩËØ•‰ΩúËÄÖ`)\n    }\n    // ËæìÂÖ•Á∫ØÊï∞Â≠óÔºåÂà†Èô§ÂØπÂ∫îIDÁöÑ‰ΩúËÄÖ\n    else if (!isNaN(word) && blockAuthors.has(word)) {\n        let text = `@${blockAuthors.get(word)} ${word}`\n        blockAuthors.delete(word)\n        sleepToast(`‚≠ïÔ∏è Âà†Èô§Â±èËîΩ\\n${wordsType[method]}\\n\\n‚úÖ Â∑≤Âà†Èô§„Äê${text}„Äë`)\n    }\n    //‰ΩúËÄÖÂêçÁß∞\n    else if (Array.from(blockAuthors.values()).includes(word)) {\n        let index = Array.from(blockAuthors.values()).indexOf(word)\n        let key = Array.from(blockAuthors.keys())[index]\n        let text = `@${blockAuthors.get(key)} ${key}`\n        blockAuthors.delete(key)\n        sleepToast(`‚≠ïÔ∏è Âà†Èô§Â±èËîΩ\\n${wordsType[method]}\\n\\n‚úÖ Â∑≤Âà†Èô§„Äê${text}„Äë`)\n    }\n    else if (word) {\n        sleepToast(`‚≠ïÔ∏è Âà†Èô§Â±èËîΩ\\n${wordsType[method]}\\n\\n‚ö†Ô∏è ËæìÂÖ•„ÄêÁî®Êà∑ID„ÄëÂèØÂ±èËîΩËØ•‰ΩúËÄÖ`)\n    }\n    putInCacheMap(`blockAuthorMap`, blockAuthors)\n}\n\nfunction blockAddFactory() {\n    if (getFromCache(\"wordsType\") === \"authors\") return blockAuthorAdd()\n    else return blockWordAdd()\n}\n\nfunction blockDeleteFactory() {\n    if (getFromCache(\"wordsType\") === \"authors\") return blockAuthorDelete()\n    else return blockWordDelete()\n}\n\n\nfunction likeTagsShow() {\n    let likeTags = getFromCache(`likeTags`)\n    if (likeTags === null) likeTags = []\n    sleepToast(`üëÄ Êü•ÁúãÊ†áÁ≠æ\\nüìå ÂñúÊ¨¢Ê†áÁ≠æ\\n\\n${likeTags.join(\"„ÄÅ\")}`, 5)\n}\n\nfunction likeTagsAdd() {\n    let likeTags = getFromCache(`likeTags`)\n    if (likeTags === null) likeTags = []\n\n    let word = String(result.get(\"ËæìÂÖ•ÂÜÖÂÆπ\")).trim()\n    if (word === \"\") {\n        sleepToast(`üìå Ê∑ªÂä†Ê†áÁ≠æ\\nüìå ÂñúÊ¨¢Ê†áÁ≠æ\\n\\n‚ö†Ô∏è ËæìÂÖ•ÂÜÖÂÆπ‰∏çËÉΩ‰∏∫Á©∫\\nËØ∑Áõ¥Êé•ËæìÂÖ•Ê†áÁ≠æÂÜÖÂÆπ`)\n    } else if (word.startsWith(\"@\") || word.startsWith(\"Ôº†\")) {\n        sleepToast(`üìå Ê∑ªÂä†Ê†áÁ≠æ\\nüìå ÂñúÊ¨¢Ê†áÁ≠æ\\n\\n‚ö†Ô∏è ‰ªÖÊîØÊåÅÊ∑ªÂä†„ÄêÊ†áÁ≠æ„Äë\\n‰∏çÊîØÊåÅÊ∑ªÂä† @‰ΩúËÄÖÂêçÁß∞`)\n    } else if (word.startsWith(\"#\") || word.startsWith(\"ÔºÉ\")) {\n        sleepToast(`üìå Ê∑ªÂä†Ê†áÁ≠æ\\nüìå ÂñúÊ¨¢Ê†áÁ≠æ\\n\\n‚ö†Ô∏è ‰ªÖÊîØÊåÅÊ∑ªÂä†„ÄêÊ†áÁ≠æ„Äë\\n‰∏çÊîØÊåÅÊ∑ªÂä† #Ê†áÁ≠æÂêçÁß∞`)\n    } else if (likeTags.includes(word)) {\n        sleepToast(`üìå Ê∑ªÂä†Ê†áÁ≠æ\\nüìå ÂñúÊ¨¢Ê†áÁ≠æ\\n\\n‚úÖ „Äê${word}„ÄëÂ∑≤ÁªèÂä†ÂÖ•ÂñúÊ¨¢Ê†áÁ≠æ‰∫Ü\\nËØ∑‰∫éÂèëÁé∞È°µÂà∑Êñ∞ÂêéÊü•Áúã`)\n    } else {\n        likeTags.push(word)\n        putInCache(`likeTags`, likeTags)\n        sleepToast(`üìå Ê∑ªÂä†Ê†áÁ≠æ\\nüìå ÂñúÊ¨¢Ê†áÁ≠æ\\n\\n‚úÖ Â∑≤Â∞Ü„Äê${word}„ÄëÂä†ÂÖ•ÂñúÊ¨¢Ê†áÁ≠æ‰∫Ü\\nËØ∑‰∫éÂèëÁé∞È°µÂà∑Êñ∞ÂêéÊü•Áúã`)\n    }\n}\n\nfunction likeTagsDelete() {\n    let likeTags = getFromCache(`likeTags`)\n    if (likeTags === null) likeTags = []\n\n    let word = String(result.get(\"ËæìÂÖ•ÂÜÖÂÆπ\")).trim()\n    if (word === \"\") {\n        sleepToast(`üóë Âà†Èô§Ê†áÁ≠æ\\n\\n‚ö†Ô∏è ËæìÂÖ•ÂÜÖÂÆπ‰∏çËÉΩ‰∏∫Á©∫`)\n    } else if (!likeTags.includes(word)) {\n        sleepToast(`üóë Âà†Èô§Ê†áÁ≠æ\\n\\n‚ö†Ô∏è „Äê${word}„Äë‰∏çÂú®ÂñúÊ¨¢Ê†áÁ≠æ\\nËØ∑Ê£ÄÊü•ÊòØÂê¶ÊúâÈîôÂà´Â≠ó`)\n    } else {\n        likeTags = likeTags.filter(item => item !== word)\n        putInCache(`likeTags`, likeTags)\n        sleepToast(`üóë Âà†Èô§Ê†áÁ≠æ\\n\\n‚úÖ Â∑≤Âà†Èô§ËØ•Ê†áÁ≠æ„Äê${word}„Äë`)\n    }\n}\n\n\nfunction likeAuthorsShow() {\n    let text = printAuthorMap(getFromCacheMap(`likeAuthors`))\n    sleepToast(`üëÄ Êü•ÁúãÊî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n${text.trim()}`, 2)\n}\n\nfunction likeAuthorsAdd() {\n    let likeAuthors = getFromCacheMap(`likeAuthors`)\n    let word = String(result.get(\"ËæìÂÖ•ÂÜÖÂÆπ\")).trim()\n    if (word.startsWith(\"@\") || word.startsWith(\"Ôº†\")) {\n        return sleepToast(`‚ù§Ô∏è Ê∑ªÂä†Êî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n‚ö†Ô∏è ‰ªÖÊîØÊåÅÈÄöËøá„Äê‰ΩúËÄÖID„ÄëÂÖ≥Ê≥®\\n‰∏çÊîØÊåÅÊ∑ªÂä† @‰ΩúËÄÖÂêçÁß∞`)\n    } else if (word.startsWith(\"#\") || word.startsWith(\"ÔºÉ\")) {\n        return sleepToast(`‚ù§Ô∏è Ê∑ªÂä†Êî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n‚ö†Ô∏è ‰ªÖÊîØÊåÅÈÄöËøá„Äê‰ΩúËÄÖID„ÄëÂÖ≥Ê≥®\\n‰∏çÊîØÊåÅÊ∑ªÂä† #Ê†áÁ≠æÂêçÁß∞`)\n    } else if (likeAuthors.has(word)) {\n        let text = `${likeAuthors.get(word)} ${word}`\n        sleepToast(`‚ù§Ô∏è Ê∑ªÂä†Êî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n‚úÖ „Äê${text}„ÄëÂ∑≤ÁªèÂä†ÂÖ•Êî∂ËóèÂàóË°®‰∫ÜÔºåËØ∑‰∫éÂèëÁé∞È°µÂà∑Êñ∞ÂêéÊü•Áúã`)\n    }\n\n    // Êó†ËæìÂÖ•ÂÜÖÂÆπÔºåÊ∑ªÂä†ÂΩìÂâçÂ∞èËØ¥ÁöÑ‰ΩúËÄÖ\n    if (word === \"\") {\n        let novel = getNovel()\n        likeAuthors.set(String(novel.userId), novel.userName)\n        let text = `@${novel.userName} ${novel.userId}`\n        sleepToast(`‚ù§Ô∏è Ê∑ªÂä†Êî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n‚úÖ Â∑≤Â∞Ü„Äê${text}„ÄëÂä†ÂÖ•Êî∂ËóèÂàóË°®‰∫ÜÔºåËØ∑‰∫éÂèëÁé∞È°µÂà∑Êñ∞ÂêéÊü•Áúã\\n\\n‚ö†Ô∏è ËæìÂÖ•„ÄêÁî®Êà∑ID„ÄëÂèØÂÖ≥Ê≥®ÂÖ∂‰ªñÁî®Êà∑ÁöÑÊî∂Ëóè\\nÈªòËÆ§ÂÖ≥Ê≥®ÂΩìÂâç‰ΩúËÄÖ(Áî®Êà∑)`)\n    }\n    // ËæìÂÖ•Á∫ØÊï∞Â≠óÔºåÊ∑ªÂä†ÂØπÂ∫îIDÁöÑ‰ΩúËÄÖ\n    else if (!isNaN(word)) {\n        let user = getAjaxJson(urlUserDetailed(word)).body\n        likeAuthors.set(user.userId, user.name)\n        let text = `@${user.name} ${user.userId}`\n        sleepToast(`‚ù§Ô∏è Ê∑ªÂä†Êî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n‚úÖ Â∑≤Â∞Ü„Äê${text}„ÄëÂä†ÂÖ•Êî∂ËóèÂàóË°®‰∫ÜÔºåËØ∑‰∫éÂèëÁé∞È°µÂà∑Êñ∞ÂêéÊü•Áúã`)\n    }\n\n    else if (word) {\n        sleepToast(`‚ù§Ô∏è Ê∑ªÂä†Êî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n‚ö†Ô∏è ËæìÂÖ•„ÄêÁî®Êà∑ID„ÄëÂèØÂÖ≥Ê≥®ÂÖ∂‰ªñÁî®Êà∑ÁöÑÊî∂Ëóè`)\n    }\n    putInCacheMap(`likeAuthors`, likeAuthors)\n}\n\nfunction likeAuthorsDelete() {\n    let likeAuthors = getFromCacheMap(`likeAuthors`)\n    let word = String(result.get(\"ËæìÂÖ•ÂÜÖÂÆπ\")).trim()\n    if (word.startsWith(\"@\") || word.startsWith(\"Ôº†\")) {\n        return sleepToast(`üñ§ ÂèñÊ∂àÊî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n‚ö†Ô∏è ‰ªÖÊîØÊåÅÈÄöËøá„Äê‰ΩúËÄÖID/‰ΩúËÄÖÂêçÁß∞„ÄëÂèñÂÖ≥\\n‰∏çÊîØÊåÅËæìÂÖ• @‰ΩúËÄÖÂêçÁß∞`)\n    } else if (word.startsWith(\"#\") || word.startsWith(\"ÔºÉ\")) {\n        return sleepToast(`üñ§ ÂèñÊ∂àÊî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n‚ö†Ô∏è ‰ªÖÊîØÊåÅÈÄöËøá„Äê‰ΩúËÄÖID/‰ΩúËÄÖÂêçÁß∞„ÄëÂèñÂÖ≥\\n‰∏çÊîØÊåÅËæìÂÖ• #Ê†áÁ≠æÂêçÁß∞`)\n    }\n\n    if (word === \"\") {\n        let novel = getNovel()\n        likeAuthors.delete(novel.userId)\n        let text = `@${novel.userName} ${novel.userId}`\n        sleepToast(`üñ§ ÂèñÊ∂àÊî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n‚úÖ Â∑≤ÂèñÂÖ≥„Äê${text}„Äë\\n\\nËæìÂÖ•„ÄêÁî®Êà∑ID„ÄëÂèØÂèñÂÖ≥ÂÖ∂‰ªñÁî®Êà∑\\nÈªòËÆ§ÂèñÂÖ≥ÂΩìÂâç‰ΩúËÄÖ(Áî®Êà∑)`)\n\n    // ËæìÂÖ•Á∫ØÊï∞Â≠óÔºåÂà†Èô§ÂØπÂ∫îIDÁöÑ‰ΩúËÄÖ\n    } else if (!isNaN(word) && likeAuthors.has(word)) {\n        let text = `@${likeAuthors.get(word)} ${word}`\n        likeAuthors.delete(word)\n        sleepToast(`üñ§ ÂèñÊ∂àÊî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n‚úÖ Â∑≤ÂèñÂÖ≥„Äê${text}„Äë`)\n\n    //‰ΩúËÄÖÂêçÁß∞\n    } else if (Array.from(likeAuthors.values()).includes(word)) {\n        let index = Array.from(likeAuthors.values()).indexOf(word)\n        let key = Array.from(likeAuthors.keys())[index]\n        let text = `@${likeAuthors.get(key)} ${key}`\n        likeAuthors.delete(key)\n        sleepToast(`üñ§ ÂèñÊ∂àÊî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n‚úÖ Â∑≤ÂèñÂÖ≥„Äê${text}„Äë`)\n    }\n    else if (word) {\n        sleepToast(`üñ§ ÂèñÊ∂àÊî∂Ëóè\\n‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè\\n\\n‚ö†Ô∏è ËæìÂÖ•„ÄêÁî®Êà∑ID„ÄëÂèØÂèñÂÖ≥ÂÖ∂‰ªñÁî®Êà∑ÁöÑÊî∂Ëóè`)\n    }\n    putInCacheMap(`likeAuthors`, likeAuthors)\n}\n\n\nfunction startBrowser(url, title) {\n    let msg = \"\", headers = `{\"headers\": {\"User-Agent\":\"${getWebViewUA()}\"}}`\n    if (url.includes(\"https://www.pixiv.net\")) {\n        if (url.includes(\"settings\")) msg += \"‚öôÔ∏è Ë¥¶Âè∑ËÆæÁΩÆ\"\n        else msg += \"‚§¥Ô∏è ÂàÜ‰∫´Â∞èËØ¥\"\n        msg += \"\\n\\nÂç≥Â∞ÜÊâìÂºÄ Pixiv\\nËØ∑Á°ÆËÆ§Â∑≤ÂºÄÂêØ‰ª£ÁêÜ/Ê¢ØÂ≠ê/VPNÁ≠â\"\n    } else if (url.includes(\"https://github.com\")) {\n        if (url.includes(\"issues\")) msg += \"üêû ÂèçÈ¶àÈóÆÈ¢ò\"\n        else if (url.includes(\"doc\")) msg += \"üî∞ ‰ΩøÁî®ÊåáÂçó\"\n        else msg += \"‚≠êÔ∏è Êî∂ËóèÈ°πÁõÆ\"\n        msg += \"\\n\\nÂç≥Â∞ÜÊâìÂºÄ Github\\nËØ∑Á°ÆËÆ§Â∑≤ÂºÄÂêØ‰ª£ÁêÜ/Ê¢ØÂ≠ê/VPNÁ≠â\"\n    }\n    sleepToast(msg, 0.01)\n    java.startBrowser(`${url}, ${headers}`, title)\n}\n\nfunction shareFactory(type) {\n    let novel = getNovel()\n    if (novel === undefined || novel === null) return sleepToast(\"‚ö†Ô∏è ËØ∑Âú®Â∞èËØ¥ÈòÖËØªÈ°µÈù¢Ôºå‰ΩøÁî®Êú¨ÂäüËÉΩ\")\n    if (type.includes(\"author\")) {\n        startBrowser(urlUserUrl(novel.userId), novel.userName)\n    }\n    else if (type.includes(\"novel\") || (!novel.seriesId)) {\n        startBrowser(urlNovelUrl(novel.id), novel.title)\n    }\n    else if (type.includes(\"series\") && novel.seriesId) {\n        startBrowser(urlSeriesUrl(novel.seriesId), novel.seriesTitle)\n    }\n}\n\nfunction startPixivSettings() {\n    startBrowser(\"https://www.pixiv.net/settings/viewing\", \"Ë¥¶Âè∑ËÆæÁΩÆ\")\n}\nfunction startGithubIssue() {\n    startBrowser(\"https://github.com/windyhusky/PixivSource/issues\", \"ÂèçÈ¶àÈóÆÈ¢ò\")\n}\nfunction startGithubReadme() {\n    startBrowser(\"https://github.com/windyhusky/PixivSource/blob/main/doc/Pixiv.md\", \"‰ΩøÁî®ÊåáÂçó\")\n}\n\nfunction checkStatus(status) {\n    if (eval(String(status)) === true) return \"‚ù§Ô∏è\"\n    else return \"üñ§\"\n}\n\nfunction charpterReading() {\n    let novel = getNovel()\n    // let novel = source.getLoginInfoMap()\n    let msg = `üìå ÂΩìÂâçÁ´†ËäÇ\\n\\n${checkStatus(novel.isWatched)} Á≥ªÂàóÔºö${novel.seriesTitle}\\n${checkStatus(novel.isBookmark)} Á´†ËäÇÔºö${novel.title}\\nüë§ ‰ΩúËÄÖÔºö${novel.userName}\\n\\nÂ¶ÇÈùûÂΩìÂâçÁ´†ËäÇÔºåËØ∑Âà∑Êñ∞Ê≠£Êñá`\n    msg = msg.replace(\"üñ§ Á≥ªÂàóÔºö\\n\", \"\")\n    sleepToast(msg, 2)\n}\n\nfunction readMeLogin() {\n    return sleepToast(`üÖøÔ∏è ÁôªÂΩïÁïåÈù¢ÂäüËÉΩ\\n\n    ‰ΩøÁî®Êî∂Ëóè„ÄÅËøΩÊõ¥„ÄÅÂÖ≥Ê≥®‰ΩúËÄÖ„ÄÅËØÑËÆ∫Á≠âÂäüËÉΩÊó∂ÔºåÈúÄË¶ÅÁôªÂΩï\n    ‰ΩøÁî®ÂâçËØ∑ÂÖàÂà∑Êñ∞Ê≠£ÊñáÔºåËé∑ÂèñÂΩìÂâçÁ´†ËäÇ‰ø°ÊÅØ\\n\n    ÁÇπÂáª„Äêüìå ÂΩìÂâçÁ´†ËäÇ„ÄëÊü•Áúã‰π¶Ê∫êÂÜÖÈÉ®Á´†ËäÇ‰ø°ÊÅØ`.replace(\"    \",\"\"), 5)\n}\n\nfunction readMeSearch() {\n    return sleepToast(`üîç ÊêúÁ¥¢ËØ¥Êòé\\n\n    Ê†áÁ≠æ‰πãÈó¥ÈúÄË¶Å‰ª•„ÄêÁ©∫Ê†º„ÄëÈó¥Èöî\n    ‚ûñ ÊéíÈô§Ê†áÁ≠æÔºö#Ê†áÁ≠æ1 -Ê†áÁ≠æ2\n    üë§ ‰ΩúËÄÖ‰∏ìÊêúÔºö@ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n    #Ô∏è Ê†áÁ≠æ‰∏ìÊêúÔºö#Ê†áÁ≠æ1 Ê†áÁ≠æ2 \n    ‚è¨ Â≠óÊï∞Á≠õÈÄâ1Ôºö#Ê†áÁ≠æ1 Ê†áÁ≠æ2 Â≠óÊï∞3k5\n    ‚è¨ Â≠óÊï∞Á≠õÈÄâ2Ôºö@‰ΩúËÄÖÁöÑÂêçÁß∞ Â≠óÊï∞3w5`.replace(\"    \",\"\"), 5)\n}\n\nlet settingsName = {\n    \"SEARCH_AUTHOR\": \"üîç ÊêúÁ¥¢‰ΩúËÄÖ\",\n    \"CONVERT_CHINESE\": \"üÄÑÔ∏è ÁπÅÁÆÄÈÄöÊêú\",\n    \"SHOW_UPDATE_TIME\": \"üìÖ Êõ¥Êñ∞Êó∂Èó¥\",\n    \"SHOW_ORIGINAL_LINK\": \"üîó ÂéüÂßãÈìæÊé•\",\n    \"SHOW_COMMENTS\": \"üí¨ ÊòæÁ§∫ËØÑËÆ∫\",\n    \"MORE_INFORMATION\": \"üìñ Êõ¥Â§öÁÆÄ‰ªã\",\n    \"REPLACE_TITLE_MARKS\": \"üìö ÊÅ¢Â§ç„Ää„Äã\",\n    \"SHOW_CAPTIONS\": \"üñºÔ∏è ÊòæÁ§∫ÊèèËø∞\",\n    \"SHOW_LIKE_NOVELS\" :\"‚ù§Ô∏è ÊòæÁ§∫Êî∂Ëóè\",\n    \"SHOW_WATCHED_SERIES\" :\"üìÉ ÊòæÁ§∫ËøΩÊõ¥\",\n    \"FAST\": \"‚è© Âø´ÈÄüÊ®°Âºè\",\n    \"DEBUG\": \"üêû Ë∞ÉËØïÊ®°Âºè\",\n    // \"\":\"Pixiv ËÆæÁΩÆ\",\n    // \"HIDE_AI_WORKS\":\"ÈöêËóèAI‰ΩúÂìÅ\",\n    // \"SENSITIVE_VIEW\":\"ÊïèÊÑü‰ΩúÂìÅ\",\n    // \"USER_X_RESTRICT\":\"Êàê‰∫∫ËÆæÁΩÆ\",\n    // \"READING_STATUS\":\"ÈòÖËØªËøõÂ∫¶\",\n}\n\nfunction getPixivSettings() {\n    let settings = getFromCache(\"pixivSettings\")\n    let resp = getAjaxJson(\"https://www.pixiv.net/ajax/settings/self\")\n    if (resp.error !== true) {\n        let siteSettings = resp.body.user_status\n        settings.HIDE_AI_WORKS = siteSettings.hide_ai_works\n        settings.SENSITIVE_VIEW = siteSettings.sensitive_view_setting\n        settings.USER_X_RESTRICT = siteSettings.user_x_restrict\n        settings.READING_STATUS = siteSettings.reading_status_enabled\n    } else {\n        settings.HIDE_AI_WORKS = false\n        settings.SENSITIVE_VIEW = 0\n        settings.USER_X_RESTRICT = 0\n        settings.READING_STATUS = false\n    }\n    putInCache(\"pixivSettings\", settings)\n    return settings\n}\n\nfunction editPixivSettingsHideAI() {\n    let settings = getPixivSettings()\n    // let settings = getFromCache(\"pixivSettings\")\n    let hideAiWorks = Number(!settings.HIDE_AI_WORKS)\n    let resp = getPostBody(\n        \"https://www.pixiv.net/ajax/settings/self?lang=zh\",\n        {\"hideAiWorks\": hideAiWorks}\n    )\n\n    if (resp.error === true) sleepToast(`‚ö†Ô∏è ÈöêËóèAI‰ΩúÂìÅ Â§±Ë¥•`, 1)\n    else if (hideAiWorks === 1) sleepToast(`‚ö†Ô∏è ÈöêËóèAI‰ΩúÂìÅ\\n\\n‚úÖ Â∑≤ ÈöêËóèAI‰ΩúÂìÅ`)\n    else sleepToast(`‚ö†Ô∏è ÈöêËóèAI‰ΩúÂìÅ\\n\\n‚úÖ Â∑≤ÂèñÊ∂à ÈöêËóèAI‰ΩúÂìÅ`)\n    settings.HIDE_AI_WORKS = Boolean(hideAiWorks)\n    putInCache(\"pixivSettings\", settings)\n}\n\nfunction editPixivSettingsXRestrict() {\n    let settings = getPixivSettings()\n    // let settings = getFromCache(\"pixivSettings\")\n    let userXRestrict = settings.USER_X_RESTRICT + 1\n    if (userXRestrict === 3) userXRestrict = 0\n    let resp = getPostBody(\n        \"https://www.pixiv.net/ajax/settings/user_x_restrict\",\n        {\"userXRestrict\": userXRestrict}\n    )\n\n    if (resp.error === true) sleepToast(`‚ö†Ô∏è Êàê‰∫∫‰ΩúÂìÅ Â§±Ë¥•`, 1)\n    else if (hideAiWorks === 0) sleepToast(`‚ö†Ô∏è Êàê‰∫∫‰ΩúÂìÅ\\n\\n‚úÖ Â∑≤ÂÖ≥Èó≠ Êàê‰∫∫‰ΩúÂìÅ`)\n    else if (hideAiWorks === 1) sleepToast(`‚ö†Ô∏è Êàê‰∫∫‰ΩúÂìÅ\\n\\n‚úÖ Â∑≤ÂºÄÂêØ R-18‰ΩúÂìÅ`)\n    else sleepToast(`‚ö†Ô∏è Êàê‰∫∫‰ΩúÂìÅ\\n\\n‚úÖ Â∑≤ÂºÄÂêØ R-18G‰ΩúÂìÅ`)\n    settings.HIDE_AI_WORKS = userXRestrict\n    putInCache(\"pixivSettings\", settings)\n}\n\nfunction editPixivSettingsSensitiveView() {\n    let settings = getPixivSettings()\n    // let settings = getFromCache(\"pixivSettings\")\n    let sensitiveView = Number(!settings.SENSITIVE_VIEW)\n    let resp = getPostBody(\n        \"https://www.pixiv.net/ajax/settings/sensitive_view_setting\",\n        {\"sensitiveViewSetting\": sensitiveView}\n    )\n\n    if (resp.error === true) sleepToast(`‚ö†Ô∏è ÊïèÊÑü‰ΩúÂìÅ Â§±Ë¥•`, 1)\n    else if (sensitiveView === 0) {sleepToast(`‚ö†Ô∏è ÊïèÊÑü‰ΩúÂìÅ\\n\\n‚úÖ Â∑≤ÈöêËóè ÊïèÊÑü‰ΩúÂìÅ`)}\n    else sleepToast(`‚ö†Ô∏è ÊïèÊÑü‰ΩúÂìÅ\\n\\n‚úÖ Â∑≤ÊòæÁ§∫ ÊïèÊÑü‰ΩúÂìÅ`)\n    settings.SENSITIVE_VIEW = sensitiveView\n    putInCache(\"pixivSettings\", settings)\n}\n\nfunction statusMsg(status) {\n    if (status === true) return \"‚úÖ Â∑≤ÂºÄÂêØ\"\n    else if (status === false) return \"üö´ Â∑≤ÂÖ≥Èó≠\"\n    else return \"üàöÔ∏è Êú™ËÆæÁΩÆ\"\n}\n\n// Ê£ÄÊµãÂø´ÈÄüÊ®°Âºè‰øÆÊîπÁöÑ4‰∏™ËÆæÁΩÆ\nfunction getSettingStatus(mode=\"\") {\n    let keys = [], msgList = []\n    let settings = getFromCache(\"pixivSettings\")\n    if (mode !== \"FAST\") keys = Object.keys(settingsName)\n    else keys = Object.keys(settingsName).slice(0, 5)\n    for (let i in keys) {\n        msgList.push(`${statusMsg(settings[keys[i]])}„ÄÄ${settingsName[keys[i]]}`)\n    }\n    return msgList.join(\"\\n\").trim()\n}\n\nfunction showSettings() {\n    sleepToast(`‚öôÔ∏è ÂΩìÂâçËÆæÁΩÆ\\n\\n${getSettingStatus()}`)\n}\n\nfunction editSettings(object) {\n    let msg, status\n    let settings = getFromCache(\"pixivSettings\")\n    if (object === \"\") {\n        settings.SEARCH_AUTHOR = true       // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n        settings.CONVERT_CHINESE = true     // ÊêúÁ¥¢ÔºöÊêúÁ¥¢Êó∂ËøõË°åÁπÅÁÆÄËΩ¨Êç¢\n        settings.SHOW_LIKE_NOVELS = true    // ÊêúÁ¥¢ÔºöÊêúÁ¥¢ÁªìÊûúÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥\n        settings.SHOW_WATCHED_SERIES = true // ÊêúÁ¥¢ÔºöÊêúÁ¥¢ÁªìÊûúÊòæÁ§∫ËøΩÊï¥Á≥ªÂàóÂ∞èËØ¥\n        settings.MORE_INFORMATION = false   // ËØ¶ÊÉÖÔºö‰π¶Á±çÁÆÄ‰ªãÊòæÁ§∫Êõ¥Â§ö‰ø°ÊÅØ\n        settings.SHOW_UPDATE_TIME = true    // ÁõÆÂΩïÔºöÊòæÁ§∫Êõ¥Êñ∞Êó∂Èó¥Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Â∞ëËÆ∏ËØ∑Ê±Ç\n        settings.SHOW_ORIGINAL_LINK = true  // ÁõÆÂΩïÔºöÊòæÁ§∫ÂéüÂßãÈìæÊé•Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Â§ßÈáèËØ∑Ê±Ç\n        settings.REPLACE_TITLE_MARKS = true // Ê≠£ÊñáÔºöÊ≥®Èü≥ÂÜÖÂÆπ‰∏∫Ê±âÂ≠óÊó∂ÔºåÊõøÊç¢‰∏∫‰π¶ÂêçÂè∑\n        settings.SHOW_CAPTIONS = true       // Ê≠£ÊñáÔºöÁ´†È¶ñÊòæÁ§∫ÊèèËø∞\n        settings.SHOW_COMMENTS = true       // Ê≠£ÊñáÔºöÁ´†Â∞æÊòæÁ§∫ËØÑËÆ∫\n        settings.FAST  = false              // ÂÖ®Â±ÄÔºöÂø´ÈÄüÊ®°Âºè\n        settings.DEBUG = false              // ÂÖ®Â±ÄÔºöË∞ÉËØïÊ®°Âºè\n        putInCache(\"pixivSettings\", settings)\n        msg = `\\n‚úÖ Â∑≤ÊÅ¢Â§ç„ÄÄüîß ÈªòËÆ§ËÆæÁΩÆ\\n\\n${getSettingStatus()}`\n\n    } else if (object === \"FAST\") {\n        if (settings[object] === true) {\n            putInCache(\"pixivLastSettings\", settings)\n            settings.CONVERT_CHINESE = false      // ÊêúÁ¥¢ÔºöÁπÅÁÆÄÈÄöÊêú\n            settings.SEARCH_AUTHOR = false        // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖ\n            settings.SHOW_UPDATE_TIME = false     // ÁõÆÂΩïÔºöÊòæÁ§∫Á´†ËäÇÊõ¥Êñ∞Êó∂Èó¥\n            settings.SHOW_ORIGINAL_LINK = false   // ÁõÆÂΩïÔºöÊòæÁ§∫Á´†ËäÇÊ∫êÈìæÊé•\n            settings.SHOW_COMMENTS = false        // Ê≠£ÊñáÔºöÊòæÁ§∫ËØÑËÆ∫\n        } else {\n            settings = getFromCache(\"pixivLastSettings\")\n            settings.SEARCH_AUTHOR = true\n            settings.FAST = false\n        }\n        putInCache(\"pixivSettings\", settings)\n        let status = settings[object]\n        let message = getSettingStatus(\"FAST\")\n        msg = `\\n${statusMsg(status)}„ÄÄ${settingsName[object]}\\n\\n${message}`\n\n    } else {\n        if (settings[object] !== undefined) {\n            status = settings[object] = (!settings[object])\n        } else {\n            status = settings[object] = true  // Êó†ËÆæÁΩÆÂàôÈªòËÆ§ÂºÄÂêØ\n        }\n        msg = `${statusMsg(status)}„ÄÄ${settingsName[object]}`\n    }\n    sleepToast(msg)\n    putInCache(\"pixivSettings\", settings)\n}\n\nfunction cleanCache() {\n    let novel = getNovel()\n    cache.delete(`${urlNovelUrl(novel.id)}`)\n    cache.delete(`${urlNovelDetailed(novel.id)}`)\n    // cache.delete(`${urlSearchNovel(novel.title, 1)}`)\n    // if (novel.seriesId) {\n    //     cache.delete(`${urlSeriesUrl(novel.seriesId)}`)\n    //     cache.delete(`${urlSeriesDetailed(novel.seriesId)}`)\n    //     cache.delete(`${urlSearchSeries(novel.seriesTitle, 1)}`)\n    // }\n    sleepToast(`üßπ Ê∏ÖÈô§ÁºìÂ≠ò\\n\\nüìå ÂΩìÂâçÁ´†ËäÇÔºö${novel.title}\\n\\nÂ∑≤Ê∏ÖÈô§Êú¨Á´†Ê≠£ÊñáÁºìÂ≠òÔºåÂà∑Êñ∞Ê≠£Êñá‰ª•Êõ¥Êñ∞`, 5)\n}\n\nlet maxPagesName = {\n    \"seriesMaxPages\": \"Á≥ªÂàóÊúÄÂ§ßÈ°µÁ†Å\",\n    \"novelsMaxPages\": \"ÂçïÁØáÊúÄÂ§ßÈ°µÁ†Å\"\n}\n\nfunction showMaxPages() {\n    let keys = Object.keys(maxPagesName)\n    let key = getFromCache(\"maxPagesKey\")\n\n    // ÂàáÊç¢ÂàóË°®\n    let index = keys.indexOf(key) + 1\n    if (index === keys.length) index = 0\n    key = keys[index]\n    putInCache(\"maxPagesKey\", key)\n\n    return sleepToast(`üìÑ ÊêúÁ¥¢È°µÁ†Å\\nËÆæÁΩÆ #Ô∏è‚É£ ÊêúÁ¥¢Ê†áÁ≠æÁöÑÊúÄÂ§ßÈ°µÁ†ÅÊï∞\\n\n    ÂΩìÂâç${maxPagesName[keys[0]]}Ôºö${getFromCache(keys[0])}\\nÂΩìÂâç${maxPagesName[keys[1]]}Ôºö${getFromCache(keys[1])}\\n\n    ÁÇπÂáª ‚è´ Â¢ûÂä†È°µÁ†Å/ ‚è¨ ÂáèÂ∞ëÈ°µÁ†Å\\nË∞ÉÊï¥„Äê${maxPagesName[key]}„Äë\\n\n    üìå È°µÁ†ÅË∂äÂ§öÔºåÂ∞èËØ¥Ë∂äÂ§öÔºåÈÄüÂ∫¶Ë∂äÊÖ¢`.replace(\"    \", \"\"))\n}\n\nfunction editMaxPages(method) {\n    let msg = \"\", key = getFromCache(\"maxPagesKey\")\n    if (!key) key = Object.keys(maxPagesName)[0]\n    let maxPages = getFromCache(key)\n    if (!maxPages) maxPages = 1\n    if (method.includes(\"add\")) maxPages += 1\n    if (method.includes(\"min\")) maxPages -= 1\n\n    if (maxPages <= 1) {\n        maxPages = 1\n        msg += \"‚ö†Ô∏è ÊêúÁ¥¢È°µÁ†Å‰∏çËÉΩÂÜçÂáèÂ∞è‰∫Ü\\n\"\n    }\n    if (maxPages >= 3) {\n        msg += \"‚ö†Ô∏è ÊêúÁ¥¢È°µÁ†ÅË∂äÂ§öÔºåÊêúÁ¥¢ÈÄüÂ∫¶Ë∂äÊÖ¢\\n\"\n    }\n    if (maxPages >= 10) {\n        maxPages = 10\n        msg += \"‚ö†Ô∏è ÊêúÁ¥¢È°µÁ†Å‰∏çËÉΩÂÜçÂ¢ûÂ§ß‰∫Ü\\n\"\n    }\n    putInCache(`${key}`, maxPages)\n    sleepToast(`üìÑ ÊêúÁ¥¢È°µÁ†Å\\n\\nÂΩìÂâçÊêúÁ¥¢„Äê${maxPagesName[key]}„ÄëÔºö${maxPages}\\n\\n${(msg)}`.trim())\n    return maxPages\n}\n",
        "respondTime": 180000,
        "ruleBookInfo": {
            "author": "userName",
            "canReName": "true",
            "coverUrl": "coverUrl",
            "init": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction novelHandler(novel){\n    novel = util.formatNovels(util.handNovels([novel]))[0]\n    if (novel.seriesId === undefined || novel.seriesId === null) {\n        book.bookUrl = novel.detailedUrl = urlNovelUrl(novel.id)\n        book.tocUrl = novel.catalogUrl = urlNovelDetailed(novel.id)\n    } else {\n        book.bookUrl = novel.detailedUrl = urlSeriesUrl(novel.seriesId)\n        book.tocUrl = novel.catalogUrl = urlSeriesDetailed(novel.seriesId)\n    }\n    // ÊîæÂÖ•‰ø°ÊÅØ‰ª•‰æøÁôªÈôÜÁïåÈù¢‰ΩøÁî®\n    source.putLoginInfo(JSON.stringify(novel))\n    cache.put(\"novel\", JSON.stringify(novel))\n    return novel\n}\n\n(() => {\n    return novelHandler(util.getNovelRes(result))\n})()",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "tocUrl": "catalogUrl",
            "wordCount": "textCount"
        },
        "ruleContent": {
            "content": "@js:\nvar util = objParse(String(java.get(\"util\")))\nlet emoji = {\n    \"normal\": 101, \"surprise\": 102, \"series\": 103, \"heaven\": 104, \"happy\": 105,\n    \"excited\": 106, \"sing\": 107, \"cry\": 108, \"normal2\": 201, \"shame2\": 202,\n    \"love2\": 203, \"interesting2\": 204, \"blush2\": 205, \"fire2\": 206, \"angry2\": 207,\n    \"shine2\": 208, \"panic2\": 209, \"normal3\": 301, \"satisfaction3\": 302, \"surprise3\": 303,\n    \"smile3\": 304, \"shock3\": 305, \"gaze3\": 306, \"wink3\": 307, \"happy3\": 308,\n    \"excited3\": 309, \"love3\": 310, \"normal4\": 401, \"surprise4\": 402, \"series4\": 403,\n    \"love4\": 404, \"shine4\": 405, \"sweet4\": 406, \"shame4\": 407, \"sleep4\": 408,\n    \"heart\": 501, \"teardrop\": 502, \"star\": 503\n}\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction getNovelInfo(res) {\n    // ÊîæÂÖ•Â∞èËØ¥‰ø°ÊÅØ‰ª•‰æøÁôªÈôÜÁïåÈù¢‰ΩøÁî®\n    let novel = source.getLoginInfoMap()\n    if (novel === undefined) novel = JSON.parse(cache.get(\"novel\"))\n    if (res && res.error === true) return\n    novel.id = Number(res.id)\n    novel.title = res.title\n    novel.userId = res.userId\n    novel.userName = res.userName\n\n    if (res.bookmarkData) {\n        novel.isBookmark = true\n        cache.put(`collect${novel.id}`, res.bookmarkData.id)\n        util.saveNovels(\"likeNovels\", [Number(novel.id)])\n    } else {\n        novel.isBookmark = false\n    }\n\n    if (res.seriesNavData) {\n        novel.seriesId = Number(res.seriesNavData.seriesId)\n        novel.seriesTitle = res.seriesNavData.title\n        novel.isWatched = res.seriesNavData.isWatched\n        util.saveNovels(\"watchedSeries\", [Number(novel.seriesId)])\n    } else {\n        novel.seriesId = null\n        novel.seriesTitle = \"\"\n        novel.isWatched = false\n    }\n\n    // Á≥ªÂàó + ÈòÖËØªÔºå‰ΩøÁî®ÂΩìÂâçÁ´†ËäÇÂêçÁß∞\n    if (novel.seriesId && util.settings.IS_LEGADO) {\n        let novelIds = JSON.parse(cache.get(`novelIds${novel.seriesId}`))\n        novel.id = novelIds[book.durChapterIndex]\n        novel.title = book.durChapterTitle\n\n        let bookmarkId = JSON.parse(cache.get(`collect${novel.id}`))\n        novel.isBookmark = !!bookmarkId\n    }\n\n    // Ê∑ªÂä†ÊäïÁ•®‰ø°ÊÅØ\n    if (res.pollData) novel.pollChoicesCount = res.pollData.choices.length\n    else novel.pollChoicesCount = 0\n    source.putLoginInfo(JSON.stringify(novel))\n    cache.put(\"novel\", JSON.stringify(novel))\n}\n\nfunction getContent(res) {\n    getNovelInfo(res)  // ÊîæÂÖ•‰ø°ÊÅØ‰ª•‰æøÁôªÈôÜÁïåÈù¢‰ΩøÁî®\n    let content = String(res.content)\n    // let content = \"undefined\"\n    if (content.includes(\"undefined\")) {\n        return checkContent()\n    }\n\n    // Âú®Ê≠£ÊñáÂÜÖÈÉ®Ê∑ªÂä†Â∞èËØ¥ÊèèËø∞\n    if (util.settings.SHOW_CAPTIONS && res.description !== \"\") {\n        content = res.description + \"\\n\" + \"‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\\n\".repeat(2) + content\n    }\n\n    // Ëé∑Âèñ [uploadedimage:] ÁöÑÂõæÁâáÈìæÊé•\n    let hasEmbeddedImages = res.textEmbeddedImages !== undefined && res.textEmbeddedImages !== null\n    if (hasEmbeddedImages) {\n        Object.keys(res.textEmbeddedImages).forEach((key) => {\n            content = content.replace(`[uploadedimage:${key}]`, `<img src=\"${urlCoverUrl(res.textEmbeddedImages[key].urls.original)}\">`)\n        })\n    }\n\n    // Ëé∑Âèñ [pixivimage:] ÁöÑÂõæÁâáÈìæÊé• [pixivimage:1234] [pixivimage:1234-1]\n    let matched = content.match(RegExp(/\\[pixivimage:(\\d+)-?(\\d+)]/gm))\n    if (matched) {\n        matched.forEach(pixivimage => {\n            let matched2, illustId, order = 0\n            if (pixivimage.includes(\"-\")) {\n                matched2 = pixivimage.match(RegExp(\"(\\\\d+)-(\\\\d+)\"))\n                illustId = matched2[1]; order = matched2[2]\n            } else {\n                matched2 = pixivimage.match(RegExp(\"\\\\d+\"))\n                illustId = matched2[0];\n            }\n            content = content.replace(`${pixivimage}`, `<img src=\"${urlIllustOriginal(illustId, order)}\">`)\n        })\n    }\n\n    // ÊõøÊç¢ Pixiv ÂàÜÈ°µÊ†áËÆ∞Á¨¶Âè∑ [newpage]\n    matched = content.match(RegExp(/[ „ÄÄ]*\\[newpage][ „ÄÄ]*/gm))\n    if (matched) {\n        for (let i in matched) {\n            content = content.replace(`${matched[i]}`, `${\"<p>‚Äã<p/>\".repeat(3)}`)\n        }\n    }\n\n    // ÊõøÊç¢ Pixiv Á´†ËäÇÊ†áËÆ∞Á¨¶Âè∑ [chapter:]\n    matched = content.match(RegExp(/\\[chapter:(.*?)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[chapter:(.*?)]/m)\n            let chapter = matched2[1].trim()\n            content = content.replace(`${matched[i]}`, `${chapter}<p>‚Äã<p/>`)\n        }\n    }\n\n    // ÊõøÊç¢ Pixiv Ë∑≥ËΩ¨È°µÈù¢Ê†áËÆ∞Á¨¶Âè∑ [[jump:]]\n    matched = content.match(RegExp(/\\[jump:(\\d+)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let page = matched[i].match(/\\d+/)\n            content = content.replace(`${matched[i]}`, `\\n\\nË∑≥ËΩ¨Ëá≥Á¨¨${page}ËäÇ`)\n        }\n    }\n\n    // ÊõøÊç¢ Pixiv ÈìæÊé•Ê†áËÆ∞Á¨¶Âè∑ [[jumpuri: > ]]\n    matched = content.match(RegExp(/\\[\\[jumpuri:(.*?)>(.*?)]]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[\\[jumpuri:(.*?)>(.*?)]]/m)\n            let matchedText = matched2[0]\n            let urlName = matched2[1].trim()\n            let urlLink = matched2[2].trim()\n            // ÈòÖËØª‰∏çÊîØÊåÅË∂ÖÈìæÊé•\n            //content = content.replace(`${matchedText}`, `<a href=${urlLink}>${urlName}</a>`)\n            if (urlLink === urlName) {\n                content = content.replace(`${matchedText}`, `${urlName}`)\n            } else {\n                content = content.replace(`${matchedText}`, `${urlName}: ${urlLink}`)\n            }\n        }\n    }\n\n    // ÊõøÊç¢ Pixiv Ê≥®Èü≥Ê†áËÆ∞Á¨¶Âè∑ [[rb: > ]]\n    matched = content.match(RegExp(/\\[\\[rb:(.*?)>(.*?)]]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[\\[rb:(.*?)>(.*?)]]/m)\n            let matchedText = matched2[0]\n            let kanji = matched2[1].trim()\n            let kana = matched2[2].trim()\n\n            if (!util.settings.REPLACE_TITLE_MARKS) {\n                // ÈªòËÆ§ÊõøÊç¢ÊàêÔºàÊã¨Âè∑Ôºâ\n                content = content.replace(`${matchedText}`, `${kanji}Ôºà${kana}Ôºâ`)\n            } else {\n                let reg = RegExp(\"[\\\\u4E00-\\\\u9FFF]+\", \"g\");\n                if (reg.test(kana)) {\n                    // kana‰∏∫‰∏≠ÊñáÔºåÂàôÊõøÊç¢Âõû„Ää‰π¶ÂêçÂè∑„Äã\n                    content = content.replace(`${matchedText}`, `${kanji}„Ää${kana}„Äã`)\n                } else {\n                    // ÈòÖËØª‰∏çÊîØÊåÅ <ruby> <rt> Ê≥®Èü≥\n                    // content = content.replace(`${matchedText}`, `<ruby>${kanji}<rt>${kana}</rt></ruby>`)\n                    content = content.replace(`${matchedText}`, `${kanji}Ôºà${kana}Ôºâ`)\n                }\n            }\n        }\n    }\n\n    // Ê∑ªÂä†ÊäïÁ•®\n    if (res.pollData) {\n        let poll = `üìÉ ÊäïÁ•®(‚úÖ${res.pollData.total}Â∑≤Êäï)Ôºö\\n${res.pollData.question}\\n`\n        res.pollData.choices.forEach(choice => {\n            poll += `ÈÄâÈ°π${choice.id}Ôºö${choice.text}(‚úÖ${choice.count})\\n`\n        })\n        content += \"\\n\" + \"‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\\n\".repeat(2) + poll\n    }\n\n    // Ê∑ªÂä†ËØÑËÆ∫\n    if (util.settings.SHOW_COMMENTS) {\n        return content + getComment(res)\n    } else {\n        return content\n    }\n}\n\nfunction getComment(res) {\n    // let resp = getAjaxJson(urlNovelComments(res.id, 0, res.commentCount), true)\n    const limit = 50  // Ê®°Êãü Pixiv ËØ∑Ê±Ç\n    let resp = {\"error\": false, \"message\": \"\", \"body\": {comments:[]} }\n    let maxPage = (res.commentCount / limit) + 1\n    for (let i = 0; i < maxPage; i++) {\n        let result = getAjaxJson(urlNovelComments(res.id, i*limit, 50), true)\n        if (result.error !== true && result.body.comments !== null) {\n            resp.body.comments = resp.body.comments.concat(result.body.comments)\n        }\n    }\n\n    // Âà∑Êñ∞Êó∂ÔºåÂà∑Êñ∞ËØÑËÆ∫Ôºå‰∏çÊõ¥Êñ∞Ê≠£Êñá\n    let commentCount = resp.body.comments.length\n    java.log(`„Äê${res.title}„Äë(${res.id})ÔºåÂÖ±Êúâ${commentCount}Êù°ËØÑËÆ∫Ôºå${res.commentCount - commentCount}Êù°ÂõûÂ§ç`)\n    if (commentCount === 0) {\n        return \"\"\n    }\n\n    let comments = `üí¨ ËØÑËÆ∫(ÂÖ±ËÆ°${commentCount}Êù°)Ôºö\\n`\n    resp.body.comments.forEach(comment => {\n        if (comment.comment === \"\") {\n            comment.comment = `<img src=\"${urlStampUrl(comment.stampId)}\">`\n        }\n        if (Object.keys(emoji).includes(comment.comment.slice(1, -1))) {\n            comment.emojiId = emoji[comment.comment.slice(1, -1)]\n            comment.comment = `<img src=\"${urlEmojiUrl(comment.emojiId)}\">`\n        }\n        if (comment.userId === String(cache.get(\"pixiv:uid\"))) {\n            comments += `@${comment.userName}Ôºö${comment.comment}(${comment.commentDate})(${comment.id})\\n`\n        } else {\n            comments += `@${comment.userName}Ôºö${comment.comment}(${comment.commentDate})\\n`\n        }\n\n        // Ëé∑ÂèñËØÑËÆ∫ÂõûÂ§ç\n        if (comment.hasReplies === true) {\n            let resp = getAjaxJson(urlNovelCommentsReply(comment.id, 1), true)\n            if (resp.error === true) return comments\n\n            resp.body.comments.reverse().forEach(reply => {\n                if (reply.comment === \"\") {\n                    reply.comment = `<img src=\"${urlStampUrl(reply.stampId)}\">`\n                }\n                if (Object.keys(emoji).includes(reply.comment.slice(1, -1))) {\n                    reply.emojiId = emoji[reply.comment.slice(1, -1)]\n                    reply.comment = `<img src=\"${urlEmojiUrl(reply.emojiId)}\">`\n                }\n                if (comment.userId === String(cache.get(\"pixiv:uid\"))) {\n                    comments += `@${reply.userName}(‚§¥Ô∏è@${reply.replyToUserName})Ôºö${reply.comment}(${reply.commentDate})(${reply.id})\\n`\n                } else {\n                    comments += `@${reply.userName}(‚§¥Ô∏è@${reply.replyToUserName})Ôºö${reply.comment}(${reply.commentDate})\\n`\n                }\n            })\n            comments += \"‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\\n\"\n        }\n    })\n    if (comments) {\n        comments = \"\\n\" + \"‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\\n\".repeat(2) + comments\n    }\n    return comments\n}\n\nfunction checkContent() {\n    let latestMsg = getAjaxJson(urlMessageThreadLatest(5))\n    if (latestMsg.error === true) {\n        java.log(JSON.stringify(latestMsg))\n\n    } else if (latestMsg.body.total >= 1) {\n        let msg = latestMsg.body.message_threads.filter(item => item.thread_name === \"pixiv‰∫ãÂãôÂ±Ä\")[0]\n        if (msg === undefined) {\n            sleepToast(`ÊÇ®‰∫é ${java.timeFormat(new Date().getTime())} Ëß¶Âèë Pixiv „ÄêËØ∑Ê±ÇÈôêÂà∂„ÄëÔºåÂª∫ËÆÆÁ®çÂÄô/ÈáçÊñ∞ÁôªÂΩïÂÜçÁªßÁª≠`, 3)\n            // java.startBrowser(\"https://www.pixiv.net\", 'ÈÄÄÂá∫ÁôªÂΩï')\n            // java.startBrowser(\"https://www.pixiv.net/logout.php\",'ÈÄÄÂá∫ÁôªÂΩï')  // ‰∏çÊ∏ÖÈô§ WebView ÁºìÂ≠òÊó†Ê≥ïÈáçÊñ∞ÁôªÂΩï\n\n        } else if (new Date().getTime()- 1000*msg.modified_at <= 3*24*60*60*1000) { // 3*24hÂÜÖÊèêÈÜí\n            sleepToast(`ÊÇ®‰∫é ${java.timeFormat(1000*msg.modified_at)} Ëß¶Âèë Pixiv „ÄêËøáÂ∫¶ËÆøÈóÆ„ÄëÔºåËØ∑‰øÆÊîπÂØÜÁ†ÅÂπ∂ÈáçÊñ∞ÁôªÂΩï`, 3)\n            sleepToast(`${msg.latest_content}`, 5)\n            java.startBrowser(\"https://accounts.pixiv.net/password/change\",'‰øÆÊîπÂØÜÁ†Å')\n        }\n    }\n}\n\n(() => {\n    return getContent(util.getNovelRes(result))\n})()",
            "imageStyle": "DEFAULT"
        },
        "ruleExplore": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\nvar seriesSet = new Set();  // Â≠òÂÇ®seriesID ÊúâBUGÊó†Ê≥ïÂ§ÑÁêÜÁøªÈ°µ\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction handlerFactory() {\n    if (baseUrl.includes(\"https://cdn.jsdelivr.net\")) {\n        return () => {updateSource(); return []}\n    }\n    if (!isLogin()) {\n        return handlerNoLogin()\n    }\n    if (baseUrl.includes(\"/bookmark\")) {\n        return handlerBookMarks()\n    }\n    if (baseUrl.includes(\"/top\")) {\n        return handlerRecommend()\n    }\n    if (baseUrl.includes(\"/follow_latest\")) {\n        return handlerFollowLatest()\n    }\n    if (baseUrl.includes(\"/watch_list\")) {\n        return handlerWatchList()\n    }\n    if (baseUrl.includes(\"/discovery\")) {\n        return handlerDiscovery()\n    }\n    if (baseUrl.includes(\"/new\")) {\n        return handlerDiscovery()\n    }\n    if (baseUrl.includes(\"/commission/\")) {\n        return handlerFollowLatest()\n    }\n    if (baseUrl.includes(\"/user_event/portal\")) {\n        return handlerFollowLatest()\n    }\n    if (baseUrl.includes(\"/genre\")) {\n        return handlerWatchList()\n    }\n    // Ê≠£ÂàôÂåπÈÖçÁΩëÂùÄÂÜÖÂÆπ\n    if (baseUrl.includes(\"/ranking\")) {\n        return handlerRanking()\n    }\n    if (baseUrl.includes(\"/marker_all\")) {\n        return handlerRanking()\n    }\n    if (baseUrl.includes(\"/editors_picks\")) {\n        return handlerRanking()\n    }\n    if (baseUrl.includes(\"/ajax/search/novels\")) {\n        return handlerSearch()\n    }\n    if (baseUrl.startsWith(\"https://www.pixiv.net\")) {\n        return handlerRanking()\n    }\n    else {\n        return []\n    }\n}\n\nfunction handlerNoLogin() {\n    return () => {\n        sleepToast(\"‚ö†Ô∏è ÂΩìÂâçÊú™ÁôªÂΩïË¥¶Âè∑\\n\\nËØ∑ÁôªÂΩï Pixiv Ë¥¶Âè∑\", 1.5)\n        util.removeCookie(); util.login()\n        sleepToast(\"ÁôªÂΩïÊàêÂäüÂêéÔºåËØ∑ÈáçÊñ∞ËøõÂÖ•ÂèëÁé∞\", 2)\n        return []\n    }\n}\n\n// Êé®ËçêÂ∞èËØ¥\nfunction handlerRecommend() {\n    return () => {\n        let res = JSON.parse(result)\n        const recommend = res.body.page.recommend\n        const novels = res.body.thumbnails.novel\n        let nidSet = new Set(recommend.ids)\n        // java.log(nidSet.size)\n        let list = novels.filter(novel => nidSet.has(String(novel.id)))\n        // java.log(`ËøáÊª§ÁªìÊûú:${JSON.stringify(list)}`)\n        return util.formatNovels(util.handNovels(util.combineNovels(list)))\n    }\n}\n\n// Êî∂ËóèÂ∞èËØ¥Ôºå‰ªñ‰∫∫Êî∂Ëóè\nfunction handlerBookMarks() {\n    return () => {\n        let res = JSON.parse(result).body.works\n        if (res === undefined || res.length === 0) {\n            //ÊµÅÁ®ãÊó†Ê≥ïÊú¨ÁéØËäÇ‰∏≠Ê≠¢ Âè™ËÉΩ‰∫§Áªô‰∏ã‰∏ÄÊµÅÁ®ãÂ§ÑÁêÜ\n            return []\n        }\n        return util.formatNovels(util.handNovels(res))\n    }\n}\n\n//ÂÖ≥Ê≥®‰ΩúËÄÖÔºåÂ∞èËØ¥ÂßîÊâòÔºåÂ∞èËØ¥‰ºÅÂàí\nfunction handlerFollowLatest() {\n    return () => {\n        let res = JSON.parse(result)\n        return util.formatNovels(util.handNovels(util.combineNovels(res.body.thumbnails.novel)))\n    }\n}\n\n//Êé®ËçêÂ∞èËØ¥ÔºåÊúÄËøëÂ∞èËØ¥\nfunction handlerDiscovery() {\n    return () => {\n        let res = JSON.parse(result)\n        return util.formatNovels(util.handNovels(util.combineNovels(res.body.novels)))\n    }\n}\n\n// ÊêúÁ¥¢Ê†áÁ≠æ\nfunction handlerSearch() {\n    return () => {\n        let res = JSON.parse(result)\n        return util.formatNovels(util.handNovels(util.combineNovels(res.body.novel.data)))\n    }\n}\n\n// ËøΩÊõ¥ÂàóË°®ÔºåÁÉ≠Èó®ÂàÜÁ±ª\nfunction handlerWatchList() {\n    return () => {\n        let res = JSON.parse(result)\n        return util.formatNovels(util.handNovels(res.body.thumbnails.novelSeries))\n    }\n}\n\n// ÊéíË°åÊ¶úÔºå‰π¶Á≠æÔºåÈ¶ñÈ°µÔºåÁºñËæëÈÉ®Êé®ËçêÔºåÈ°∫Â∫èÁõ∏Âêå\nfunction handlerRanking() {\n    if (util.settings.IS_LEGADO) return handlerRankingAjaxAll()\n    // else if (util.settings.IS_SOURCE_READ) return handlerRankingWebview()\n    else if (util.settings.IS_SOURCE_READ) return handlerRankingAjax()\n    else return []\n}\n\n// ÊéíË°åÊ¶úÔºå‰π¶Á≠æÔºåÈ¶ñÈ°µÔºåÁºñËæëÈÉ®Êé®ËçêÔºåÈ°∫Â∫èÁõ∏Âêå\nfunction handlerRankingAjaxAll() {\n    return () => {\n        let  novelIds = [], novelUrls = []\n        // let result = result + java.ajax(`${baseUrl}&p=2`)  // Ê≠£ÂàôËé∑ÂèñÁΩëÂùÄ‰∏≠ÁöÑ novelId\n        let matched = result.match(RegExp(/\\/novel\\/show\\.php\\?id=\\d{5,}/gm))\n        for (let i in matched) {\n            let novelId = matched[i].match(RegExp(/\\d{5,}/))[0]\n            if (novelIds.indexOf(novelId) === -1) {\n                novelIds.push(novelId)\n                novelUrls.push(urlNovelDetailed(novelId))\n            }\n        }\n        // java.log(JSON.stringify(novelIds))\n        let novels = getAjaxAllJson(novelUrls).map(resp => resp.body)\n        return util.formatNovels(util.handNovels(util.combineNovels(novels)))\n    }\n}\n\n// ÊéíË°åÊ¶úÔºå‰π¶Á≠æÔºåÈ¶ñÈ°µ\nfunction handlerRankingWebview() {\n    return () => {\n        let novelIds = []  // Ê≠£ÂàôËé∑ÂèñÁΩëÂùÄ‰∏≠ÁöÑ novelId\n        // let result = result + java.ajax(`${baseUrl}&p=2`)  // Ê≠£ÂàôËé∑ÂèñÁΩëÂùÄ‰∏≠ÁöÑ novelId\n        let matched = result.match(RegExp(/\\/novel\\/show\\.php\\?id=\\d{5,}/gm))\n        for (let i in matched) {\n            let novelId = matched[i].match(RegExp(/\\d{5,}/))[0]\n            if (novelIds.indexOf(novelId) === -1) {\n                novelIds.push(novelId)\n            }\n        }\n        // java.log(JSON.stringify(novelIds))\n        let userNovels = getWebviewJson(\n            urlNovelsDetailed(`${cache.get(\"pixiv:uid\")}`, novelIds), html => {\n                return (html.match(new RegExp(\">\\\\{.*?}<\"))[0].replace(\">\", \"\").replace(\"<\", \"\"))\n            }).body\n        return util.formatNovels(util.handNovels(util.combineNovels(Object.values(userNovels))))\n    }\n}\n\n// ÊéíË°åÊ¶úÔºå‰π¶Á≠æÔºåÈ°∫Â∫èÁõ∏Âêå\nfunction handlerRankingAjax() {\n    return () => {\n        let novels = [], novelIds = []\n        // let result = result + java.ajax(`${baseUrl}&p=2`)  // Ê≠£ÂàôËé∑ÂèñÁΩëÂùÄ‰∏≠ÁöÑ novelId\n        let matched = result.match(RegExp(/\\/novel\\/show\\.php\\?id=\\d{5,}/gm))\n        for (let i in matched) {\n            let novelId = matched[i].match(RegExp(/\\d{5,}/))[0]\n            if (novelIds.indexOf(novelId) === -1) {\n                novelIds.push(novelId)\n                // java.log(urlNovelDetailed(novelId))\n                let res = getAjaxJson(urlNovelDetailed(novelId))\n                if (res.error !== true) {\n                    novels.push(res.body)\n                } else {\n                    java.log(JSON.stringify(res))\n                }\n            }\n        }\n        return util.formatNovels(util.handNovels(util.combineNovels(novels)))\n    }\n}\n\n(() => {\n    return handlerFactory()()\n})()",
            "bookUrl": "detailedUrl",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "wordCount": "textCount"
        },
        "ruleSearch": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nvar first = true;\n// Â≠òÂÇ®seriesID\nvar seriesSet = {\n    keywords: \"Pixiv:Search\",\n    has: (value) => {\n        let page = Number(java.get(\"page\"))\n        if (page === 1 && first) {\n            first = false\n            cache.deleteMemory(this.keywords)\n            return false\n        }\n\n        let v = cache.getFromMemory(this.keywords)\n        if (v === undefined || v === null) {\n            return false\n        }\n        let set = new Set(JSON.parse(v))\n        return set.has(value)\n    },\n\n    add: (value) => {\n        let v = cache.getFromMemory(this.keywords)\n        if (v === undefined || v === null) {\n            cache.putMemory(this.keywords, JSON.stringify([value]))\n\n        } else {\n            let arr = JSON.parse(v)\n            if (typeof arr === \"string\") {\n                arr = Array(arr)\n            }\n            arr.push(value)\n            cache.putMemory(this.keywords, JSON.stringify(arr))\n        }\n    },\n};\n\nfunction getUserNovels() {\n    if (!isLogin()) {\n        sleepToast(\"üë§ ÊêúÁ¥¢‰ΩúËÄÖ\\n\\n‚ö†Ô∏è ÂΩìÂâçÊú™ÁôªÂΩïË¥¶Âè∑\\nËØ∑ÁôªÂΩï Pixiv Ë¥¶Âè∑\", 1.5)\n        util.removeCookie(); util.login()\n        sleepToast(\"üë§ ÊêúÁ¥¢‰ΩúËÄÖ\\n\\nÁôªÂΩïÊàêÂäüÂêéÔºåËØ∑ÈáçÊñ∞ÊêúÁ¥¢\", 2)\n        return []\n    }\n\n    let uidList = [], novels = []\n    let username = String(java.get(\"keyword\"))\n    let page = Number(java.get(\"page\"))\n\n    // cache.delete(username)\n    let userid = cache.get(username)\n    if (userid !== undefined && userid !== null) {\n        uidList = [userid]\n        java.log(`üë§ ÁºìÂ≠ò‰ΩúËÄÖIDÔºö${userid}`)\n    } else {\n        html = java.ajax(urlSearchUser(username))\n        // java.log(html)\n        // ‰ªÖÂåπÈÖçÊúâÊäïÁ®ø‰ΩúÂìÅÁöÑÁî®Êà∑\n        let match = html.match(new RegExp(`\"userIds\":\\\\[(?:(?:\\\\d+,?)+)]`))\n        // java.log(JSON.stringify(match))\n        if (match === null || match.length === 0) {\n            return []\n        }\n\n        match = JSON.stringify(match).replace(\"\\\\\",\"\").split(\",\")\n        // java.log(JSON.stringify(match))\n        let regNumber = new RegExp(\"\\\\d+\")\n        uidList = match.map(v => {\n            return v.match(regNumber)[0]\n        })\n        java.log(`üë§ Ëé∑Âèñ‰ΩúËÄÖIDÔºö${JSON.stringify(uidList)}`)\n    }\n\n    let tempUids = []\n    for (let i in uidList) {\n        let uid = uidList[i]\n        let resp = getAjaxJson(urlUserAllWorks(uid), true)\n        // java.log(urlUserAllWorks(id))\n        // java.log(JSON.stringify(resp))\n        if (resp.error === true) {\n            return []\n        }\n\n        // ‰ªÖËé∑ÂèñÂâç3‰∏™ÊúâÂ∞èËØ¥ÁöÑ‰ΩúËÄÖ\n        let novelIds = Object.keys(resp.body.novels)\n        // java.log(`${uid}-${novelIds.length}`)\n        if (novelIds.length >= 1) tempUids.push(uid)\n        if (tempUids.length === 3) {\n            java.log(`üë§ ÊòæÁ§∫‰ΩúËÄÖIDÔºö${JSON.stringify(tempUids)}`)\n            break\n        }\n\n        // Ëé∑ÂèñÁ≥ªÂàóÂ∞èËØ¥Ôºå‰∏é util.handnovels Á≥ªÂàóËØ¶ÊÉÖÂÖºÂÆπ\n        let seriesIds = []\n        if (resp.body.novelSeries.length >= 1) {\n            resp.body.novelSeries.forEach(novel =>{\n                seriesIds.push(novel.id)\n                novel.textCount = novel.publishedTotalCharacterCount\n                novel.description = novel.caption\n            })\n            novels = novels.concat(resp.body.novelSeries)\n        }\n\n        // Ëé∑ÂèñÊâÄÊúâÁ≥ªÂàóÂÜÖÈÉ®ÁöÑÂ∞èËØ¥ ID\n        let seriesNovelIds = []\n        seriesIds.forEach(seriesId => {\n            let returnList = getAjaxJson(urlSeriesNovelsTitles(seriesId)).body\n            returnList.map(novel => {return seriesNovelIds.push(novel.id)})\n        })\n        // java.log(`ÊúâÁ≥ªÂàóÁöÑÂ∞èËØ¥IDÔºö${JSON.stringify(seriesNovelIds)}`)\n        // java.log(JSON.stringify(seriesNovelIds.length))\n\n        // Ëé∑ÂèñÂçïÁØáÂ∞èËØ¥\n        if (novelIds.length >= 1 && util.settings.IS_LEGADO) {\n            novelIds = novelIds.filter(novelid => (!seriesNovelIds.includes(novelid)))\n            novelIds = novelIds.reverse().slice((page - 1) * 20, page * 20)\n            // java.log(`ÁúüÂçïÁØáÁöÑÂ∞èËØ¥IDÔºö${JSON.stringify(novelIds)}`)\n            // java.log(JSON.stringify(novelIds.length))\n            let novelUrls = novelIds.map(novelId => {return urlNovelDetailed(novelId)})\n            // java.log(JSON.stringify(novelUrls))\n            // cache.delete(novelUrls)\n            novels = novels.concat(getAjaxAllJson(novelUrls).map(resp => resp.body))\n        }\n\n        // // Ëé∑ÂèñÂçïÁØáÂ∞èËØ¥\n        if (novelIds.length >= 1 && util.settings.IS_SOURCE_READ) {\n            novelIds = novelIds.filter(novelid => (!seriesNovelIds.includes(novelid)))\n            // java.log(`ÁúüÂçïÁØáÁöÑÂ∞èËØ¥IDÔºö${JSON.stringify(novelIds)}`)\n            // java.log(JSON.stringify(novelIds.length))\n            novelIds = novelIds.reverse().slice((page - 1) * 20, page * 20)\n            novelIds.forEach(novelId => {\n                // java.log(urlNovelDetailed(novelId))\n                let res = getAjaxJson(urlNovelDetailed(novelId))\n                if (res.error !== true) {\n                    novels.push(res.body)\n                } else {\n                    java.log(JSON.stringify(res))\n                }\n            })\n        }\n    }\n    \n    util.debugFunc(() => {\n        java.log(`Ëé∑ÂèñÁî®Êà∑ÊêúÁ¥¢Â∞èËØ¥ÁªìÊùü`)\n    })\n    return novels\n}\n\nfunction search(name, type, page) {\n    let resp = {}\n    if (type.includes(\"novel\")) {\n        resp = getAjaxJson(urlSearchNovel(name, page))\n        java.log(urlSearchNovel(name, page))\n    }\n    if (type.includes(\"series\")) {\n        resp = getAjaxJson(urlSearchSeries(name, page))\n        java.log(urlSearchSeries(name, page))\n    }\n    if (resp.error === true || resp.total === 0) {\n        return {\"data\": [], \"total\":0, \"lastPage\": 0}\n    }\n    return resp.body.novel\n}\n\nfunction getSeries() {\n    let novels = []\n    let name = String(java.get(\"keyword\"))\n    let maxPages = getFromCache(\"maxPages\")  // ‰ªÖÈªòËÆ§ÊêúÁ¥¢‰ΩøÁî®\n    if (!maxPages) {\n        maxPages = getFromCache(\"seriesMaxPages\")  // ÊêúÁ¥¢Ê†áÁ≠æ‰ΩøÁî®\n        if (!maxPages) maxPages = 1\n        putInCache(\"seriesMaxPages\", maxPages)\n    }\n    java.log(`üìÑ ÊêúÁ¥¢Á≥ªÂàóÊúÄÂ§ßÈ°µÁ†ÅÔºö${maxPages}`)\n\n    if (JSON.parse(result).error === true) {\n        return []\n    }\n    let lastPage = JSON.parse(result).body.novel.lastPage\n    novels = novels.concat(JSON.parse(result).body.novel.data)\n    java.log(urlSearchSeries(name, 1))\n    cache.put(urlSearchSeries(name, 1), result, cacheSaveSeconds)  // Âä†ÂÖ•ÁºìÂ≠ò\n    for (let page = Number(java.get(\"page\")) + 1; page <= lastPage && page <= maxPages; page++) {\n        novels = novels.concat(search(name,\"series\", page).data)\n    }\n    return novels\n}\n\nfunction getNovels() {\n    let novels = []\n    let name = String(java.get(\"keyword\"))\n    let maxPages = getFromCache(\"maxPages\")  // ‰ªÖÈªòËÆ§ÊêúÁ¥¢‰ΩøÁî®\n    if (!maxPages) {\n        maxPages = getFromCache(\"novelsMaxPages\")  // ÊêúÁ¥¢Ê†áÁ≠æ‰ΩøÁî®\n        if (!maxPages) maxPages = 1\n        putInCache(\"novelsMaxPages\", maxPages)\n    }\n    java.log(`üìÑ ÊêúÁ¥¢ÂçïÁØáÊúÄÂ§ßÈ°µÁ†ÅÔºö${maxPages}`)\n\n    let resp = search(name, \"novel\", 1)\n    novels = novels.concat(resp.data)\n    for (let page = Number(java.get(\"page\")) + 1; page <= resp.lastPage && page <= maxPages; page++) {\n        novels = novels.concat(search(name,\"novel\", page).data)\n    }\n    return util.combineNovels(novels)\n}\n\nfunction getConvertNovels() {\n    let novels = []\n    let novelName = String(java.get(\"keyword\"))\n    let name1 = String(java.s2t(novelName))\n    let name2 = String(java.t2s(novelName))\n    if (name1 !== novelName) novels = novels.concat(search(name1, \"novel\", 1).data)\n    if (name2 !== novelName) novels = novels.concat(search(name2, \"novel\", 1).data)\n    novels = util.combineNovels(novels)\n    if (name1 !== novelName) novels = novels.concat(search(name1, \"series\", 1).data)\n    if (name2 !== novelName) novels = novels.concat(search(name2, \"series\", 1).data)\n    return novels\n}\n\nfunction novelFilter(novels) {\n    let textCount = 0, tags = []\n    let limitedTextCount = String(java.get(\"limitedTextCount\")).replace(\"Â≠óÊï∞\", \"\").replace(\"Â≠óÊï∏\", \"\")\n    // limitedTextCount = `3w 3k 3w5 3k5`.[0]\n    if (limitedTextCount.includes(\"w\") || limitedTextCount.includes(\"W\")) {\n        let num = limitedTextCount.toLowerCase().split(\"w\")\n        textCount = 10000 * num[0] + 1000 * num[1]\n    } else if (limitedTextCount.includes(\"k\") || limitedTextCount.includes(\"K\")) {\n        let num = limitedTextCount.toLowerCase().split(\"k\")\n        textCount = 1000 * num[0] + 100 * num[1]\n    }\n\n    let novels0 = novels.map(novel => novel.id)\n    if (textCount >= 1) {\n        novels = novels.filter(novel => novel.textCount >= textCount)\n        let novels1 = novels.map(novel => novel.id)\n        java.log(`üî¢ Â≠óÊï∞ÈôêÂà∂Ôºö${limitedTextCount}`)\n        java.log(`‚è¨ Â≠óÊï∞ÈôêÂà∂ÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels1.length}`)\n    }\n\n    let inputTags = String(java.get(\"inputTags\")).split(\" \")\n    for (let i in inputTags) {\n        let tag = inputTags[i].trim()\n        if (tag !== \"\") tags.push(`${tag}`)\n    }\n\n    if (tags.length >= 1) {\n        // ‰ªÖ‰øùÁïôÂê´ÊúâÊâÄÊúâÊ†áÁ≠æÁöÑÂ∞èËØ¥\n        // novels = novels.filter(novel => {\n        //     // java.log(`${JSON.stringify(novel.tags)}\\n${tags.every(item => novel.tags.includes(item))}`)\n        //     return tags.every(item => novel.tags.includes(item))\n        // })\n        novels = novels.filter(novel => tags.every(item => novel.tags.includes(item)))\n        let novels2 = novels.map(novel => novel.id)\n        java.log(`#Ô∏è‚É£ ËøáÊª§Ê†áÁ≠æÔºö${tags.join(\"„ÄÅ\")}`)\n        java.log(`#Ô∏è‚É£ ËøáÊª§Ê†áÁ≠æÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n    }\n\n    let inputAuthor = String(java.get(\"inputAuthor\")).trim()\n    if (inputAuthor) {\n        // novels = novels.filter(novel => {\n        //     java.log(`${novel.userName}-${novel.userName.includes(inputAuthor)}`)\n        //     return novel.userName.includes(inputAuthor)\n        // })\n        novels = novels.filter(novel => novel.userName.includes(inputAuthor))\n        let novels2 = novels.map(novel => novel.id)\n        java.log(`üë§ ËøáÊª§‰ΩúËÄÖÔºö${tags.join(\"„ÄÅ\")}`)\n        java.log(`üë§ ËøáÊª§‰ΩúËÄÖÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n    }\n    return novels\n}\n\n(() => {\n    let novels = []\n    let keyword = String(java.get(\"keyword\"))\n    if (keyword.startsWith(\"@\") || keyword.startsWith(\"Ôº†\")) {\n        java.put(\"keyword\", keyword.slice(1))\n        novels = novels.concat(getUserNovels())\n    } else if (keyword.startsWith(\"#\") || keyword.startsWith(\"ÔºÉ\")) {\n        java.put(\"keyword\", keyword.slice(1))\n        // Âà†Èô§ÈªòËÆ§ÊêúÁ¥¢ÊúÄÂ§ßÈ°µÁ†ÅÔºå‰ΩøÁî®ÂÜÖÈÉ®ËÆæÂÆöÁöÑÊúÄÂ§ßÈ°µÁ†Å\n        cache.delete(\"maxPages\")\n        novels = novels.concat(getSeries())\n        novels = novels.concat(getNovels())\n    } else {\n        // ËÆæÁΩÆÈªòËÆ§ÊêúÁ¥¢ÊúÄÂ§ßÈ°µÁ†Å\n        putInCache(\"maxPages\", 1)\n        novels = novels.concat(getSeries())\n        novels = novels.concat(getNovels())\n        if (util.settings.SEARCH_AUTHOR) novels = novels.concat(getUserNovels())\n        if (util.settings.CONVERT_CHINESE) novels = novels.concat(getConvertNovels())\n    }\n    // java.log(JSON.stringify(novels))\n    // ËøîÂõûÁ©∫ÂàóË°®‰∏≠Ê≠¢ÊµÅÁ®ã\n    if (novels.length === 0) {\n        return []\n    }\n    return novelFilter(util.formatNovels(util.handNovels(novels)))\n})()",
            "bookUrl": "detailedUrl",
            "checkKeyWord": "ÊµãËØïÈ°µÈù¢",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "wordCount": "textCount"
        },
        "ruleToc": {
            "chapterList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction urlNovel(novelId){\n    if (util.settings.SHOW_ORIGINAL_LINK) {\n        return urlNovelUrl(novelId)\n    } else {\n        return urlNovelDetailed(novelId)\n    }\n}\n\nfunction oneShotHandler(res) {\n    res.textCount = res.userNovels[`${res.id}`].textCount\n    res.createDate = timeTextFormat(res.createDate)\n    return [{\n        title: res.title.replace(RegExp(/^\\s+|\\s+$/g), \"\"),\n        chapterUrl: urlNovel(res.id),\n        chapterInfo: `${res.createDate}„ÄÄ„ÄÄ${res.textCount}Â≠ó`\n    }]\n}\n\nfunction seriesHandler(res) {\n    const limit = 30\n    let returnList = [], novelIds = []\n    let seriesID = res.id, allChaptersCount = res.total\n    util.debugFunc(() => {\n        java.log(`Êú¨Á≥ªÂàó ${seriesID} ‰∏ÄÂÖ±Êúâ${allChaptersCount}Á´†`);\n    })\n\n    //ÂèëÈÄÅËØ∑Ê±ÇËé∑ÂæóÁõ∏Â∫îÊï∞ÈáèÁöÑÁõÆÂΩïÂàóË°®\n    function sendAjaxForGetChapters(lastIndex) {\n        resp = getAjaxJson(urlSeriesNovels(seriesID, limit, lastIndex), true)\n        res = resp.body.thumbnails.novel\n        // res = resp.body.page.seriesContents\n        res.forEach(v => {\n            v.title = v.title.replace(RegExp(/^\\s+|\\s+$/g), \"\").replace(RegExp(/Ôºà|Ôºâ|-/g), \"\")\n            v.chapterUrl = urlNovel(v.id)\n            novelIds.push(v.id)\n            if (v.updateDate !== undefined) {\n                v.updateDate = timeTextFormat(v.createDate)\n                v.chapterInfo = `${v.updateDate}„ÄÄ„ÄÄ${v.textCount}Â≠ó`\n            } else {\n                v.updateDate = java.timeFormat(v.uploadTimestamp)\n                v.chapterInfo = `${v.updateDate}„ÄÄ„ÄÄ${v.textLength}Â≠ó`\n            }\n            util.debugFunc(() => {\n                java.log(`${v.title}`)\n            })\n        })\n        return res;\n    }\n\n    if (!util.settings.SHOW_UPDATE_TIME) {\n        returnList = getAjaxJson(urlSeriesNovelsTitles(seriesID), true).body\n        returnList.forEach(v => {\n            v.title = v.title.replace(RegExp(/^\\s+|\\s+$/g), \"\").replace(RegExp(/Ôºà|Ôºâ|-/g), \"\")\n            v.chapterUrl = urlNovel(v.id)\n            novelIds.push(v.id)\n        })\n    } else {\n        //ÈÄªËæëÊéßÂà∂ËÄÖ ‰πüÂ∞±ÊòØ‰ΩøÁî®‰∏äÈù¢ÂÆö‰πâÁöÑ‰∏§‰∏™ÂáΩÊï∞Êù•ÂÅöÂØπÂ∫îÂäüËÉΩ\n        //Ë¶ÅÁà¨ÂèñÁöÑÊÄªÊ¨°Êï∞\n        let max = (allChaptersCount / limit) + 1\n        for (let i = 0; i < max; i++) {\n            //java.log(\"iÁöÑÂÄº:\"+i)\n            let list = sendAjaxForGetChapters(i * limit);\n            //ÂèñÂá∫ÊØè‰∏™ÂÄº\n            returnList = returnList.concat(list)\n        }\n    }\n    // ÊîæÂÖ•Â∞èËØ¥‰ø°ÊÅØ‰ª•‰æøÁôªÈôÜÁïåÈù¢‰ΩøÁî®\n    let novel = source.getLoginInfoMap()\n    if (novel === undefined) novel = JSON.parse(cache.get(\"novel\"))\n    novel.novelIds = novelIds\n    cache.put(`novelIds${seriesID}`, JSON.stringify(novelIds), cacheSaveSeconds)\n    // java.log(JSON.stringify(returnList))\n    source.putLoginInfo(JSON.stringify(novel))\n    cache.put(\"novel\", JSON.stringify(novel))\n    return returnList\n}\n\n(function (res) {\n    res = util.getNovelResSeries(result)\n    if (res.firstNovelId === undefined || res.seriesNavData === null) {\n        return oneShotHandler(res)\n    } else {\n        return seriesHandler(res)\n    }\n})()",
            "chapterName": "title",
            "chapterUrl": "chapterUrl",
            "isPay": "false ",
            "isVip": "true",
            "updateTime": "chapterInfo"
        },
        "searchUrl": "@js:\njava.put(\"key\", key)\njava.put(\"page\", page)\nlet keyword = key.split(\" \")\nlet limitedTextCount\nif (key.includes(\"Â≠óÊï∞\") || key.includes(\"Â≠óÊï∏\") ) {\n    limitedTextCount = keyword.pop()\n    keyword = keyword.join(\" \")\n} else {\n    limitedTextCount = \"\"\n    keyword = key\n}\njava.put(\"keyword\", keyword)\njava.put(\"limitedTextCount\", limitedTextCount)\n\nif (keyword.startsWith(\"@\") || keyword.startsWith(\"Ôº†\")) {\n    if (keyword.includes(\"#\") || keyword.includes(\"ÔºÉ\")) {\n        let author = keyword.split(\" \")[0]\n        let tags = keyword.replace(author, \"\").trim().slice(1)\n        java.put(\"keyword\", author)\n        java.put(\"inputTags\", tags)\n        java.log(`üë§ ÊêúÁ¥¢‰ΩúËÄÖÔºö${author} #Ô∏è‚É£ ËøáÊª§Ê†áÁ≠æÔºö${tags.replace(\" \", \"„ÄÅ\")}`)\n    } else {\n        java.put(\"keyword\", keyword)\n        java.log(`üë§ ÊêúÁ¥¢‰ΩúËÄÖÔºö${keyword.slice(1)}`)\n    }\n\n} else if (keyword.startsWith(\"#\") || keyword.startsWith(\"ÔºÉ\")) {\n    keyword = keyword.slice(1)\n    if (keyword.includes(\"@\") || keyword.includes(\"Ôº†\")) {\n        let author = keyword.match(new RegExp(/[@Ôº†](.*)/))\n        keyword = keyword.replace(author[0], \"\").trim()\n        java.put(\"inputAuthor\", author[1])\n        java.log(`#Ô∏è‚É£ ÊêúÁ¥¢Ê†áÁ≠æÔºö${keyword} üë§ ËøáÊª§‰ΩúËÄÖÔºö${author[1]}`)\n    } else {\n        java.log(`#Ô∏è‚É£ ÊêúÁ¥¢Ê†áÁ≠æÔºö${keyword}`)\n    }\n    java.put(\"keyword\", `#${keyword}`)\n\n} else {\n    java.log(`üîç ÊêúÁ¥¢ÂÜÖÂÆπÔºö${keyword}`)\n}\nurlSearchSeries(keyword, page)\n\n// ÂêåÊó∂ÊêúÁ¥¢Â§ö‰∏™ÈìæÊé•ÁöÑÊêúÁ¥¢ÁªìÊûú\n// let li = [\n//     urlSearchSeries(keyword, page),\n//     urlSearchNovel(keyword, page)\n// ]\n// // resp = getAjaxAllJson(li)\n// // resp = resp.map(res => JSON.stringify(res)).join(\",\")\n// resp = java.ajaxAll(li).map(resp => resp.body()).join(\",\")\n// resp = `[${resp}]`",
        "variableComment": "üö´ Â±èËîΩ‰ΩúËÄÖ(Êú¨Âú∞)Ôºö\n‚ñ∂Ô∏èËÆæÁΩÆÊñπÊ≥ïÔºöÊâìÂºÄÂ∞èËØ¥ - ËèúÂçï - ÁôªÂΩï - üö´ Â±èËîΩ‰ΩúËÄÖ\n\nüö´ Â±èËîΩÊ†áÁ≠æ/ÊèèËø∞(Êú¨Âú∞)Ôºö\n1Ô∏è‚É£ÁºñËæë‰π¶Ê∫êÔºöËèúÂçï - ÁôªÂΩï - ÁÇπÂáª„Äê üëÄ Êü•ÁúãÂ±èËîΩ„Äë\n2Ô∏è‚É£ÂàáÊç¢ÂàóË°®ÔºöÁÇπÂáªÊåâÈíÆÔºåÂàáÊç¢Ëá≥„ÄêÁõ∏Â∫îÂ±èËîΩÂàóË°®„Äë\n3Ô∏è‚É£ËæìÂÖ•ÂÜÖÂÆπÔºöÂú®„ÄêËæìÂÖ•ÂÜÖÂÆπ„ÄëÂ§ÑËæìÂÖ•Â±èËîΩÂÜÖÂÆπ\n4Ô∏è‚É£Â±èËîΩ‰ΩúËÄÖÔºöÁÇπÂáª„Äêüö´ Âä†ÂÖ•Â±èËîΩ„ÄëÔºåÂ±èËîΩËØ•ÂÜÖÂÆπ\n\nüìå ÂñúÊ¨¢Ê†áÁ≠æ(Êú¨Âú∞)Ôºö\n1Ô∏è‚É£ÁºñËæë‰π¶Ê∫êÔºöËèúÂçï - ÁôªÂΩï ÔºåÊâæÂà∞ËæìÂÖ•ÂÜÖÂÆπ\n2Ô∏è‚É£ËæìÂÖ•ÂÜÖÂÆπÔºöËæìÂÖ•Ê†áÁ≠æÔºåÁÇπÂáª„Äêüìå ÂñúÊ¨¢Ê†áÁ≠æ„Äë\n\n‚ù§Ô∏è Êü•Áúã‰ªñ‰∫∫Êî∂ËóèÔºö\n1Ô∏è‚É£ÁºñËæë‰π¶Ê∫êÔºöËèúÂçï - ÁôªÂΩï ÔºåÊâæÂà∞ËæìÂÖ•ÂÜÖÂÆπ\n2Ô∏è‚É£ËæìÂÖ•ÂÜÖÂÆπÔºöËæìÂÖ•‰ΩúËÄÖIDÔºåÁÇπÂáª„Äê‚ù§Ô∏è ‰ªñ‰∫∫Êî∂Ëóè„Äë\n\n\n‚öôÔ∏è ‰π¶Ê∫êËÆæÁΩÆÔºö\nËÆæÁΩÆ1Ô∏è‚É£ÔºöÊâìÂºÄÂ∞èËØ¥ - ËèúÂçï - ÁôªÂΩï - ÁÇπÂáª‰∏ãÊñπÊåâÈíÆ\n‚ñ∂Ô∏è ÊêúÁ¥¢‰ªªÊÑèÂ∞èËØ¥ÔºåÂêåÊ≠•ËÆæÁΩÆÊï∞ÊçÆ\n\nËÆæÁΩÆ2Ô∏è‚É£ÔºöÁºñËæë‰π¶Ê∫ê - Âü∫Êú¨ - ÂèòÈáèËØ¥Êòé - ‰øÆÊîπÂπ∂‰øùÂ≠ò\n‚öôÔ∏è Ëá™ÂÆö‰πâËÆæÁΩÆÔºöÂ∞Ü true Êîπ‰∏∫ falseÔºåÊàñÁõ∏Âèç\n‚ö†Ô∏è ËÆæÁΩÆÊ∫êÂèòÈáè„ÄêÊó†Ê≥ï„ÄëÊõ¥Êîπ‰π¶Ê∫êËá™ÂÆö‰πâËÆæÁΩÆ\n‚ö†Ô∏è Ê≥®ÊÑè‰∏çË¶ÅÊ∑ªÂä†ÊàñÂà†Èô§Â∞æÈöèÈÄóÂè∑\",\"\n‚ö†Ô∏è Êõ¥Êñ∞ÂèëÁé∞È°µÈúÄË¶ÅÈïøÊåâ\"Pixiv\"ÔºåÊâãÂä®Âà∑Êñ∞\n‰ª•‰∏ãÂÜÖÂÆπ‰∏∫‰π¶Ê∫êËÆæÁΩÆÔºö\n{\n\"SHOW_GENERAL_NEW\": false,\n\"SHOW_GENERAL_RANK\": false,\n\"SHOW_R18_GENRE\": false,\n\"SHOW_GENERAL_GENRE\": false\n}\n\n// SHOW_GENERAL_NEW\n// ÂèëÁé∞ÔºöÊúÄÊñ∞„ÄÅ‰ºÅÂàí„ÄÅÁ∫¶Á®øÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n// SHOW_GENERAL_RANK\n// ÂèëÁé∞ÔºöÊéíË°åÊ¶úÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n// SHOW_R18_GENRE\n// ÂèëÁé∞ÔºöÁÉ≠Èó®ÂàÜÁ±ªÊòæÁ§∫R18Â∞èËØ¥\n// SHOW_GENERAL_GENRE\n// ÂèëÁé∞ÔºöÁÉ≠Èó®ÂàÜÁ±ªÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n\n",
        "weight": 0
    },
    {
        "bookSourceComment": "Pixiv Â∞èËØ¥(Â§áÁî®)ÔºàÊõ¥Êñ∞üìÜÔºö2025-10-08Ôºâ\n\n‰π¶Ê∫êÁâàÊú¨Ôºö2.3.8\n‰ΩøÁî®ËØ¥ÊòéÔºöüìåÈòÖËØªÁâàÊú¨ 3.25.0527 Âèä‰πãÂêéÁâàÊú¨ÂèØÁî®\nÂèØÁî®ÂäüËÉΩÔºö‚úÖÊêúÁ¥¢‚úÖÂèëÁé∞‚úÖÊ∑ªÂä†ÁΩëÂùÄ‚úÖËÆ¢ÈòÖÊ∫ê\nÊêúÁ¥¢Â∞èËØ¥Ôºö‚úÖÂçïÁØá‚úÖÁ≥ªÂàó‚úÖÊ†áÁ≠æ‚úÖ‰ΩúËÄÖ\nÂèëÁé∞Â∞èËØ¥Ôºö‚úÖÂÖ≥Ê≥®‚úÖËøΩÊõ¥‚úÖÊé®Ëçê‚úÖÂèëÁé∞\nÂèëÁé∞Â∞èËØ¥Ôºö‚úÖÊî∂Ëóè‚úÖ‰π¶Á≠æ‚úÖÈ¶ñÈ°µ‚úÖÊéíË°å\nÊ∑ªÂä†ÁΩëÂùÄÔºö‚úÖÂ∞èËØ¥‚úÖÁ≥ªÂàó‚úÖ‰ΩúËÄÖ\nËÆ¢ÈòÖÁî®Ê≥ïÔºöÁÇπÂáªËÆ¢ÈòÖÊ∫êÊâìÂºÄÂ∞èËØ¥/Á≥ªÂàóÂ∞èËØ¥Ôºå„ÄêÂà∑Êñ∞„ÄëÔºåÁÇπÂáª„ÄêÂä†ÂÖ•‰π¶Êû∂„ÄëÊåâÈíÆÔºåÊ∑ªÂä†Âà∞‰π¶Êû∂\n\n‰π¶Ê∫êÂèëÂ∏ÉÔºöÂÖΩ‰∫∫ÈòÖËØªÈ¢ëÈÅì https://t.me/FurryReading\nÈ°πÁõÆÂú∞ÂùÄÔºöhttps://github.com/windyhusky/PixivSource\n‰ΩøÁî®ÊïôÁ®ãÔºöhttps://github.com/windyhusky/PixivSource/blob/main/doc/Pixiv.md\n\nËßÑÂàôËÆ¢ÈòÖÔºöimport ËÆ¢ÈòÖÊ∫ê\nhttps://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/import.json\nhttps://raw.githubusercontent.com/windyhusky/PixivSource/main/import.json\n\n‚öôÔ∏è ‰π¶Ê∫êËÆæÁΩÆÔºö\nËÆæÁΩÆÔºöÁºñËæë‰π¶Ê∫ê - Âü∫Êú¨ - ÂèòÈáèËØ¥Êòé - ‰øÆÊîπÂπ∂‰øùÂ≠ò",
        "bookSourceGroup": "üîû Pixiv",
        "bookSourceName": "üÖøÔ∏è Pixiv Â∞èËØ¥Â§áÁî®",
        "bookSourceType": 0,
        "bookSourceUrl": "https://www.pixiv.net",
        "bookUrlPattern": "(https?://)?(www\\.)?pixiv\\.net(/ajax)?/(novel/(show\\.php\\?id=|series/)?|users?/)\\d+.*",
        "concurrentRate": "3/2000",
        "customOrder": 1,
        "enabled": false,
        "enabledCookieJar": true,
        "enabledExplore": false,
        "exploreUrl": "@js:\nlet SHOW_R18_GENRE, SHOW_GENERAL_NEW, SHOW_GENERAL_RANK, SHOW_GENERAL_GENRE\ntry {\n    settings = JSON.parse(String(source.variableComment).match(RegExp(/{([\\s\\S]*?)}/gm)))\n    SHOW_R18_GENRE = settings.SHOW_R18_GENRE         // ÂèëÁé∞ÔºöÁÉ≠Èó®ÂàÜÁ±ªÊòæÁ§∫R18Â∞èËØ¥\n    SHOW_GENERAL_NEW = settings.SHOW_GENERAL_NEW     // ÂèëÁé∞ÔºöÊúÄÊñ∞„ÄÅ‰ºÅÂàí„ÄÅÁ∫¶Á®øÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n    SHOW_GENERAL_RANK = settings.SHOW_GENERAL_RANK   // ÂèëÁé∞ÔºöÊéíË°åÊ¶úÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n    SHOW_GENERAL_GENRE = settings.SHOW_GENERAL_GENRE // ÂèëÁé∞ÔºöÁÉ≠Èó®ÂàÜÁ±ªÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n} catch (e) {\n    SHOW_R18_GENRE = false\n    SHOW_GENERAL_NEW = false\n    SHOW_GENERAL_RANK = false\n    SHOW_GENERAL_GENRE = false\n}\n\nli = [\n    {\"‚≠êÔ∏è ÂÖ≥Ê≥®\": \"https://www.pixiv.net/ajax/follow_latest/novel?p={{page}}&mode=r18&lang=zh\"},\n    {\"üìÉ ËøΩÊõ¥\": \"https://www.pixiv.net/ajax/watch_list/novel?p={{page}}&new=1&lang=zh\"},\n    {\"üíØ Êé®Ëçê\": \"https://www.pixiv.net/ajax/top/novel?mode=r18&lang=zh\"},\n    {\"üîç ÂèëÁé∞\": \"https://www.pixiv.net/ajax/novel/discovery?mode=r18&lang=zh\"},\n    {\"‚ù§Ô∏è Êî∂Ëóè\": \"https://www.pixiv.net/ajax/user/{{cache.get(\\\"pixiv:uid\\\")}}/novels/bookmarks?tag=&offset={{(page-1)*24}}&limit=24&rest=show&lang=zh\"},\n    {\"„äôÔ∏è Êî∂Ëóè\": \"https://www.pixiv.net/ajax/user/{{cache.get(\\\"pixiv:uid\\\")}}/novels/bookmarks?tag=&offset={{(page-1)*24}}&limit=24&rest=hide&lang=zh\"},\n    {\"üè∑Ô∏è ‰π¶Á≠æ\": \"https://www.pixiv.net/novel/marker_all.php\"},\n    {\"üè† È¶ñÈ°µ\": \"https://www.pixiv.net\"},\n]\n\nnormal = [\n    {\"‚úÖ Â∏∏ËßÑ Â∞èËØ¥ Êé®Ëçê ‚úÖ\": \"\"},\n    {\"‚≠êÔ∏è ÂÖ≥Ê≥®\": \"https://www.pixiv.net/ajax/follow_latest/novel?p={{page}}&mode=all&lang=zh\"},\n    {\"üíØ Êé®Ëçê\": \"https://www.pixiv.net/ajax/top/novel?mode=all&lang=zh\"},\n    {\"üîç ÂèëÁé∞\": \"https://www.pixiv.net/ajax/novel/discovery?mode=safe&lang=zh\"},\n    {\"üÜô Êõ¥Êñ∞\": \"https://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/pixiv.json\"},\n]\n\nr18New = [\n    {\"üÜï ÊúÄÊñ∞ ‰ºÅÂàí Á∫¶Á®ø üí∞\": \"\"},\n    {\"üÜï ÊúÄÊñ∞\": \"https://www.pixiv.net/ajax/novel/new?lastId=0&limit=20&r18=true&lang=zh\"},\n    {\"üìë ‰ºÅÂàí\": \"https://www.pixiv.net/ajax/user_event/portal/novels?mode=r18&p={{page}}&lang=zh\"},\n    {\"üí∞ Á∫¶Á®ø\": \"https://www.pixiv.net/ajax/commission/page/request/complete/novels?mode=r18&p={{page}}&lang=zh\"},\n    {\"üîç ÂèëÁé∞\": \"https://www.pixiv.net/ajax/novel/discovery?mode=all&lang=zh\"},\n]\n\ngeneralNew = [\n    {\"‚úÖ ÊúÄÊñ∞ ‰ºÅÂàí Á∫¶Á®ø ‚úÖ\": \"\"},\n    {\"ÊúÄÊñ∞\": \"https://www.pixiv.net/ajax/novel/new?lastId=0&limit=20&r18=false&lang=zh\"},\n    {\"‰ºÅÂàí\": \"https://www.pixiv.net/ajax/user_event/portal/novels?mode=all&p={{page}}&lang=zh\"},\n    {\"Á∫¶Á®ø\": \"https://www.pixiv.net/ajax/commission/page/request/complete/novels?mode=all&p={{page}}&lang=zh\"},\n    {\"ÁºñËæë\": \"https://www.pixiv.net/novel/editors_picks\"},\n]\n\nr18Rank = [\n    {\"üëë ÊéíË°åÊ¶úÂçï üëë\": \"\"},\n    {\"‰ªäÊó•\": \"https://www.pixiv.net/novel/ranking.php?mode=daily_r18\"},\n    {\"Êú¨Âë®\": \"https://www.pixiv.net/novel/ranking.php?mode=weekly_r18\"},\n    {\"R18G\": \"https://www.pixiv.net/novel/ranking.php?mode=r18g\"},\n    {\"Áî∑ÊÄß\": \"https://www.pixiv.net/novel/ranking.php?mode=male_r18\"},\n    {\"Â•≥ÊÄß\": \"https://www.pixiv.net/novel/ranking.php?mode=female_r18\"}\n]\n\ngeneralRank = [\n    {\"üèÜ ÊéíË°åÊ¶úÂçï üèÜ\": \"\"},\n    {\"‰ªäÊó•\": \"https://www.pixiv.net/novel/ranking.php?mode=daily\"},\n    {\"Êú¨Âë®\": \"https://www.pixiv.net/novel/ranking.php?mode=weekly\"},\n    {\"Êú¨Êúà\": \"https://www.pixiv.net/novel/ranking.php?mode=monthly\"},\n    {\"Áî∑ÊÄß\": \"https://www.pixiv.net/novel/ranking.php?mode=male\"},\n    {\"Â•≥ÊÄß\": \"https://www.pixiv.net/novel/ranking.php?mode=female\"},\n    {\"Êñ∞‰∫∫\": \"https://www.pixiv.net/novel/ranking.php?mode=rookie\"},\n    {\"ÂéüÂàõ\": \"https://www.pixiv.net/novel/ranking.php?mode=weekly_original\"},\n    {\"AIÁîüÊàê\": \"https://www.pixiv.net/novel/ranking.php?mode=weekly_ai\"}\n]\n\nr18Genre = [\n    {\"üî• ÂéüÂàõÁÉ≠Èó® üî•\": \"\"},\n    {\"Áî∑ÊÄß\": \"https://www.pixiv.net/ajax/genre/novel/male?mode=r18&lang=zh\"},\n    {\"Â•≥ÊÄß\": \"https://www.pixiv.net/ajax/genre/novel/female?mode=r18&lang=zh\"},\n    {\"ÊÅãÁà±\": \"https://www.pixiv.net/ajax/genre/novel/romance?mode=r18&lang=zh\"},\n    {\"ÂºÇ‰∏ñÁïåÂ•áÂπª\": \"https://www.pixiv.net/ajax/genre/novel/isekai_fantasy?mode=r18&lang=zh\"},\n    {\"Áé∞‰ª£Â•áÂπª\": \"https://www.pixiv.net/ajax/genre/novel/contemporary_fantasy?mode=r18&lang=zh\"},\n    {\"ÊÇ¨Áñë\": \"https://www.pixiv.net/ajax/genre/novel/mystery?mode=r18&lang=zh\"},\n    {\"ÊÅêÊÄñ\": \"https://www.pixiv.net/ajax/genre/novel/horror?mode=r18&lang=zh\"},\n    {\"ÁßëÂπª\": \"https://www.pixiv.net/ajax/genre/novel/sci-fi?mode=r18&lang=zh\"},\n    {\"ÊñáÂ≠¶\": \"https://www.pixiv.net/ajax/genre/novel/literature?mode=r18&lang=zh\"},\n    {\"ÊÉÖÊÑü\": \"https://www.pixiv.net/ajax/genre/novel/drama?mode=r18&lang=zh\"},\n    {\"ÂéÜÂè≤\": \"https://www.pixiv.net/ajax/genre/novel/historical_pieces?mode=r18&lang=zh\"},\n    {\"ËÄΩÁæé\": \"https://www.pixiv.net/ajax/genre/novel/bl?mode=r18&lang=zh\"},\n    {\"ÁôæÂêà\": \"https://www.pixiv.net/ajax/genre/novel/yuri?mode=r18&lang=zh\"},\n    {\"Êï£Êñá¬∑ËØóÊ≠å\": \"https://www.pixiv.net/ajax/genre/novel/poetry?mode=r18&lang=zh\"},\n    {\"ÈöèÁ¨î¬∑Á∫™ÂÆû\": \"https://www.pixiv.net/ajax/genre/novel/non-fiction??mode=r18&lang=zh\"},\n    {\"ÂâßÊú¨\": \"https://www.pixiv.net/ajax/genre/novel/screenplays?mode=r18&lang=zh\"},\n    {\"ËØÑËÆ∫\": \"https://www.pixiv.net/ajax/genre/novel/reviews?mode=r18&lang=zh\"},\n    {\"ÂÖ∂‰ªñ\": \"https://www.pixiv.net/ajax/genre/novel/other?mode=r18&lang=zh\"}\n]\n\ngeneralgGenre = [\n    {\"‚ù§Ô∏è‚Äçüî• ÂéüÂàõÁÉ≠Èó® ‚ù§Ô∏è‚Äçüî•\": \"\"},\n    {\"ÁªºÂêà\": \"https://www.pixiv.net/ajax/genre/novel/all?mode=safe&lang=zh\"},\n    {\"ÊÅãÁà±\": \"https://www.pixiv.net/ajax/genre/novel/romance?mode=safe&lang=zh\"},\n    {\"ÂºÇ‰∏ñÁïåÂ•áÂπª\": \"https://www.pixiv.net/ajax/genre/novel/isekai_fantasy?mode=safe&lang=zh\"},\n    {\"Áé∞‰ª£Â•áÂπª\": \"https://www.pixiv.net/ajax/genre/novel/contemporary_fantasy?mode=safe&lang=zh\"},\n    {\"ÊÇ¨Áñë\": \"https://www.pixiv.net/ajax/genre/novel/mystery?mode=safe&lang=zh\"},\n    {\"ÊÅêÊÄñ\": \"https://www.pixiv.net/ajax/genre/novel/horror?mode=safe&lang=zh\"},\n    {\"ÁßëÂπª\": \"https://www.pixiv.net/ajax/genre/novel/sci-fi?mode=safe&lang=zh\"},\n    {\"ÊñáÂ≠¶\": \"https://www.pixiv.net/ajax/genre/novel/literature?mode=safe&lang=zh\"},\n    {\"ÊÉÖÊÑü\": \"https://www.pixiv.net/ajax/genre/novel/drama?mode=safe&lang=zh\"},\n    {\"ÂéÜÂè≤\": \"https://www.pixiv.net/ajax/genre/novel/historical_pieces?mode=safe&lang=zh\"},\n    {\"ËÄΩÁæé\": \"https://www.pixiv.net/ajax/genre/novel/bl?mode=safe&lang=zh\"},\n    {\"ÁôæÂêà\": \"https://www.pixiv.net/ajax/genre/novel/yuri?mode=safe&lang=zh\"},\n    {\"Êï£Êñá¬∑ËØóÊ≠å\": \"https://www.pixiv.net/ajax/genre/novel/poetry?mode=safe&lang=zh\"},\n    {\"ÈöèÁ¨î¬∑Á∫™ÂÆû\": \"https://www.pixiv.net/ajax/genre/novel/non-fiction??mode=safe&lang=zh\"},\n    {\"ÂâßÊú¨\": \"https://www.pixiv.net/ajax/genre/novel/screenplays?mode=safe&lang=zh\"},\n    {\"ËØÑËÆ∫\": \"https://www.pixiv.net/ajax/genre/novel/reviews?mode=safe&lang=zh\"},\n    {\"ÂÖ∂‰ªñ\": \"https://www.pixiv.net/ajax/genre/novel/other?mode=safe&lang=zh\"}\n]\n\nli = li.concat(normal)\nli = li.concat(r18New)\nif (SHOW_GENERAL_NEW === true) {\n    li = li.concat(generalNew)\n}\nli = li.concat(r18Rank)\nif (SHOW_GENERAL_RANK === true) {\n    li = li.concat(generalRank)\n}\nif (SHOW_R18_GENRE === true) {\n    li = li.concat(r18Genre)\n}\nif (SHOW_GENERAL_GENRE === true) {\n    li = li.concat(generalgGenre)\n}\nsleepToast('‰ΩøÁî®ÊåáÂçóüîñ\\n\\nÂèëÁé∞ - Êõ¥Êñ∞ - ÁÇπÂáª\"üî∞ ‰ΩøÁî®ÊåáÂçó\" - Êü•Áúã')\n\n// Ê∑ªÂä†Ê†ºÂºè\nli.forEach(item => {\n    item.title = Object.keys(item)[0]\n    item.url = Object.values(item)[0]\n    delete item[Object.keys(item)[0]]\n    item.style = {}\n    item.style.layout_flexGrow = 1\n    item.style.layout_flexShrink = 1\n    item.style.layout_alignSelf = \"auto\"\n    item.style.layout_wrapBefore = \"false\"\n    if (item.url === \"\") {\n        item.style.layout_flexBasisPercent = 1\n    } else {\n        item.style.layout_flexBasisPercent = -1\n    }\n})\n\nJSON.stringify(li)",
        "header": "{\"referer\":\"https://www.pixiv.net\"}",
        "jsLib": "var util = {}\n\nfunction objStringify(obj) {\n    return JSON.stringify(obj, (n, v) => {\n        if (typeof v == \"function\")\n            return v.toString();\n        return v;\n    });\n}\nfunction isBackupSource() {\n    let isBackupSource = source.bookSourceName.includes(\"Â§áÁî®\")\n    cache.put(\"isBackupSource\", isBackupSource)\n    return isBackupSource\n}\n// Ê£ÄÊµã Ê∫êÈòÖ\n// ÂèØÁî® java.ajax() ‰∏çÂèØÁî® java.webview() java.ajaxAll()\n// ÂèØÁî® java.getCookie() cache.put() cache.get() ÈªòËÆ§ÂÄº‰∏∫ undefined\n// ÂèØÁî® java.startBrowser() ‰∏çÂèØÁî® java.startBrowserAwaitAwait\n// ÂèØÁî® source.bookSourceName source.getVariable() source.setVariable()Á≠â\n// java.getUserAgent() java.getWebViewUA() ÁõÆÂâçËøîÂõûÂÜÖÂÆπÁõ∏Âêå\nfunction isSourceRead() {\n    let isSourceReadStatus = java.getUserAgent() === java.getWebViewUA()\n    cache.put(\"isSourceRead\", isSourceReadStatus)\n    return isSourceReadStatus\n}\n\nfunction publicFunc() {\n    let u = {}, settings\n    // ËæìÂá∫‰π¶Ê∫ê‰ø°ÊÅØ\n    java.log(`üÖøÔ∏è ${source.bookSourceComment.split(\"\\n\")[0]}`)\n    java.log(`üìå ${source.bookSourceComment.split(\"\\n\")[2]}`)\n    if (isSourceRead()) {\n        java.log(`üìÜ Êõ¥Êñ∞Êó∂Èó¥Ôºö${java.timeFormat(source.lastUpdateTime)}`)\n        java.log(\"üì± ËΩØ‰ª∂Âπ≥Âè∞Ôºöüçé Ê∫êÈòÖ SourceRead\")\n    } else {\n        java.log(`üìÜ Êõ¥Êñ∞Êó∂Èó¥Ôºö${timeFormat(source.lastUpdateTime)}`)\n        java.log(\"üì± ËΩØ‰ª∂Âπ≥Âè∞Ôºöü§ñ ÂºÄÊ∫êÈòÖËØª Leagdo\")\n    }\n\n    // Ëé∑ÂèñËÆæÁΩÆÔºåÂ§áÁî®‰π¶Ê∫ê‰ΩøÁî®ÊóßÁâàËÆæÁΩÆÔºå‰π¶Ê∫ê‰ªéÁºìÂ≠òËé∑ÂèñËÆæÁΩÆ\n    if (isBackupSource()) {\n        settings = JSON.parse(String(source.variableComment).match(RegExp(/{([\\s\\S]*?)}/gm)))\n    } else {\n        // cache.delete(\"pixivSettings\")\n        settings = getFromCache(\"pixivSettings\")\n    }\n    if (settings !== null) {\n        java.log(\"‚öôÔ∏è ‰ΩøÁî®Ëá™ÂÆö‰πâËÆæÁΩÆ\")\n    } else {\n        settings = {}\n        settings.SEARCH_AUTHOR = true       // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n        settings.CONVERT_CHINESE = true     // ÊêúÁ¥¢ÔºöÊêúÁ¥¢Êó∂ËøõË°åÁπÅÁÆÄËΩ¨Êç¢\n        settings.SHOW_LIKE_NOVELS = true    // ÊêúÁ¥¢ÔºöÊêúÁ¥¢ÁªìÊûúÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥\n        settings.SHOW_WATCHED_SERIES = true // ÊêúÁ¥¢ÔºöÊêúÁ¥¢ÁªìÊûúÊòæÁ§∫ËøΩÊï¥Á≥ªÂàóÂ∞èËØ¥\n        settings.MORE_INFORMATION = false   // ËØ¶ÊÉÖÔºö‰π¶Á±çÁÆÄ‰ªãÊòæÁ§∫Êõ¥Â§ö‰ø°ÊÅØ\n        settings.SHOW_UPDATE_TIME = true    // ÁõÆÂΩïÔºöÊòæÁ§∫Êõ¥Êñ∞Êó∂Èó¥Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Â∞ëËÆ∏ËØ∑Ê±Ç\n        settings.SHOW_ORIGINAL_LINK = true  // ÁõÆÂΩïÔºöÊòæÁ§∫ÂéüÂßãÈìæÊé•Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Â§ßÈáèËØ∑Ê±Ç\n        settings.REPLACE_TITLE_MARKS = true // Ê≠£ÊñáÔºöÊ≥®Èü≥ÂÜÖÂÆπ‰∏∫Ê±âÂ≠óÊó∂ÔºåÊõøÊç¢‰∏∫‰π¶ÂêçÂè∑\n        settings.SHOW_CAPTIONS = true       // Ê≠£ÊñáÔºöÁ´†È¶ñÊòæÁ§∫ÊèèËø∞\n        settings.SHOW_COMMENTS = true       // Ê≠£ÊñáÔºöÁ´†Â∞æÊòæÁ§∫ËØÑËÆ∫\n        settings.FAST  = false              // ÂÖ®Â±ÄÔºöÂø´ÈÄüÊ®°Âºè\n        settings.DEBUG = false              // ÂÖ®Â±ÄÔºöË∞ÉËØïÊ®°Âºè\n        java.log(\"‚öôÔ∏è ‰ΩøÁî®ÈªòËÆ§ËÆæÁΩÆÔºàÊó†Ëá™ÂÆö‰πâËÆæÁΩÆ Êàñ Ëá™ÂÆö‰πâËÆæÁΩÆÊúâËØØÔºâ\")\n    }\n    if (settings.FAST === true) {\n        settings.SEARCH_AUTHOR = false        // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n        settings.CONVERT_CHINESE = false      // ÊêúÁ¥¢ÔºöÁπÅÁÆÄÈÄöÊêú\n        settings.SHOW_UPDATE_TIME = false     // ÁõÆÂΩïÔºöÊòæÁ§∫Á´†ËäÇÊõ¥Êñ∞Êó∂Èó¥\n        settings.SHOW_ORIGINAL_LINK = false   // ÁõÆÂΩïÔºöÊòæÁ§∫Á´†ËäÇÊ∫êÈìæÊé•\n        settings.SHOW_COMMENTS = false        // Ê≠£ÊñáÔºöÊòæÁ§∫ËØÑËÆ∫\n    } else {\n        settings.SEARCH_AUTHOR = true        // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n    }\n    settings.IS_LEGADO = !isSourceRead()\n    settings.IS_SOURCE_READ = isSourceRead()\n    settings.IS_BACKUP_SOURCE = isBackupSource()\n    u.settings = settings\n    putInCache(\"pixivSettings\", settings)  // ËÆæÁΩÆÂÜôÂÖ•ÁºìÂ≠ò\n\n    u.debugFunc = (func) => {\n        if (util.settings.DEBUG === true) {\n            func()\n        }\n    }\n\n    u.checkStatus = function(status) {\n        if (status === true) return \"‚úÖ Â∑≤\"\n        else if (status === false) return \"‚ùå Êú™\"\n        else if (status === undefined) return \"üàöÔ∏è Êó†Êï∞ÊçÆÔºö\"\n    }\n\n    u.login = function() {\n        let resp = java.startBrowserAwait(`https://accounts.pixiv.net/login,\n    {\"headers\": {\"User-Agent\": \"${java.getWebViewUA()}\"}}`, 'ÁôªÂΩïË¥¶Âè∑', false)\n        if (resp.code() === 200) {\n            this.getCsrfToken(); this.getCookie()\n        } else {\n            java.log(resp.code()); sleepToast(\"‚ö†Ô∏è ÁôªÂΩïÂ§±Ë¥•\")\n        }\n    }\n\n    u.logout = function() {\n        this.removeCookie()\n        java.startBrowser(\"https://www.pixiv.net/logout.php\", \"ÈÄÄÂá∫Ë¥¶Âè∑\")\n        this.removeCookie()\n        sleepToast(`‚úÖ Â∑≤ÈÄÄÂá∫ÂΩìÂâçË¥¶Âè∑\\n\\nÈÄÄÂá∫ÂêéËØ∑ÁÇπÂáªÂè≥‰∏äËßíÁöÑ ‚úîÔ∏è ÈÄÄÂá∫\\n\\nÁôªÂΩïËØ∑ÁÇπÂáª„ÄêÁôªÂΩïË¥¶Âè∑„ÄëËøõË°åÁôªÂΩï`)\n    }\n\n    u.getCookie = function() {\n        let pixivCookie = String(java.getCookie(\"https://www.pixiv.net/\", null))\n        if (isLogin()) cache.put(\"pixivCookie\", pixivCookie, 60*60)  // ÁºìÂ≠ò1h\n    }\n\n    u.removeCookie = function() {\n        cookie.removeCookie('https://www.pixiv.net')\n        cookie.removeCookie('https://accounts.pixiv.net')\n        cookie.removeCookie('https://accounts.google.com')\n        cookie.removeCookie('https://api.weibo.com')\n        cache.delete(\"pixivCookie\")\n        cache.delete(\"pixiv:uid\")\n        cache.delete(\"csfrToken\")  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥\n        cache.delete(\"headers\")\n    }\n\n    // Ëé∑Âèñ Csrf TokenÔºå‰ª•‰æøËøõË°åÊî∂ËóèÁ≠âËØ∑Ê±Ç\n    // Ëé∑ÂèñÊñπÊ≥ïÊù•Ëá™ËÑöÊú¨ Pixiv Previewer\n    // https://github.com/Ocrosoft/PixivPreviewer\n    // https://greasyfork.org/zh-CN/scripts/30766-pixiv-previewer/code\n    u.getCsrfToken = function() {\n        let csfrToken = cache.get(\"csfrToken\")\n        if (!csfrToken) {\n            let html = java.webView(null, \"https://www.pixiv.net/\", null)\n            try {\n                csfrToken = html.match(/token\\\\\":\\\\\"([a-z0-9]{32})/)[1]\n                cache.put(\"csfrToken\", csfrToken)  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n            } catch (e) {\n                csfrToken = null\n                cache.delete(\"csfrToken\")  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n                // sleepToast(\"‚ö†Ô∏è Êú™ÁôªÂΩïË¥¶Âè∑(csfrToken)\")\n            }\n            java.log(`csfrToken:\\n${csfrToken}`)\n        }\n        return csfrToken\n    }\n\n    // Â∞ÜÂ§ö‰∏™ÈïøÁØáÂ∞èËØ¥Ëß£Êûê‰∏∫‰∏ÄÊú¨‰π¶\n    u.combineNovels = function(novels) {\n        return novels.filter(novel => {\n            // ÂçïÊú¨Áõ¥Êé•Ëß£Êûê‰∏∫‰∏ÄÊú¨‰π¶\n            if (novel.seriesId === undefined || novel.seriesId === null) {\n                return true\n            }\n            // ÈõÜÂêà‰∏≠Ê≤°ÊúâËØ•Á≥ªÂàóËß£Êûê‰∏∫‰∏ÄÊú¨‰π¶\n            if (!seriesSet.has(novel.seriesId)) {\n                seriesSet.add(novel.seriesId)\n                return true\n            }\n            return false\n        })\n    }\n\n    // Â±èËîΩ‰ΩúËÄÖ\n    u.authorFilter = function(novels) {\n        let authors = getFromCache(\"blockAuthorList\")\n        if (authors !== null && authors.length >= 0) {\n            java.log(`üö´ Â±èËîΩ‰ΩúËÄÖIDÔºö${JSON.stringify(authors)}`)\n            authors.forEach(author => {\n                novels = novels.filter(novel => novel.userId !== String(author))\n            })\n        }\n        return novels\n    }\n\n\n    // ËøáÊª§Êî∂Ëóè‰∏éËøΩÊõ¥\n    u.novelFilter = function(novels) {\n        let novels1 = [], novels2 = [], msg\n        let likeNovels = getFromCache(\"likeNovels\")\n        let watchedSeries = getFromCache(\"watchedSeries\")\n        let novels0 = novels.map(novel => novel.id)\n\n        msg = util.checkStatus(util.settings.SHOW_LIKE_NOVELS).replace(\"Êú™\",\"‰∏ç\")\n        java.log(`${msg}ÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥`)\n        if (util.settings.SHOW_LIKE_NOVELS === false) {\n            novels = novels.filter(novel => !likeNovels.includes(Number(novel.id)))\n            novels1 = novels.map(novel => novel.id)\n            java.log(`‚è¨ ËøáÊª§Êî∂ËóèÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels1.length}`)\n        }\n\n        msg = util.checkStatus(util.settings.SHOW_WATCHED_SERIES).replace(\"Êú™\",\"‰∏ç\")\n        java.log(`${msg}ÊòæÁ§∫ËøΩÊõ¥Á≥ªÂàó`)\n        if (util.settings.SHOW_WATCHED_SERIES === false) {\n            novels = novels.filter(novel => !watchedSeries.includes(Number(novel.seriesId)))\n            novels2 = novels.map(novel => novel.id)\n            if (novels1.length >= 1) novels0 = novels1\n            java.log(`‚è¨ ËøáÊª§ËøΩÊõ¥ÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n        }\n\n        let novels3 = novels.map(novel => novel.id)\n        if (novels0.length >= 1 && novels3.length === 0) {\n            let msg = `‚è¨ ËøáÊª§Â∞èËØ¥\\n‚ö†Ô∏è ËøáÊª§ÂêéÊó†ÁªìÊûú\\n\\nËØ∑Ê†πÊçÆÈúÄË¶Å\\n`\n            if (util.settings.SHOW_LIKE_NOVELS === false) msg += \"ÂºÄÂêØÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥\\n\"\n            if (util.settings.SHOW_WATCHED_SERIES === false) msg += \"ÂºÄÂêØÊòæÁ§∫ËøΩÊõ¥Á≥ªÂàó\"\n            sleepToast(msg, 1)\n        }\n\n        util.debugFunc(() => {\n            // java.log(JSON.stringify(novels0))\n            java.log(JSON.stringify(novels0.length))\n            // java.log(JSON.stringify(novels1))\n            java.log(JSON.stringify(novels1.length))\n            // java.log(JSON.stringify(novels2))\n            java.log(JSON.stringify(novels2.length))\n        })\n        return novels\n    }\n\n    // ËøáÊª§ÊèèËø∞‰∏éÊ†áÁ≠æÔºàÂ±èËîΩÊ†áÁ≠æ/Â±èËîΩÊèèËø∞Ôºâ\n    u.novelFilter2 = function(novels) {\n        let novels0 = novels.map(novel => novel.id)\n        let captionBlockWords = getFromCache(\"captionBlockWords\")\n        if (captionBlockWords === null) captionBlockWords = []\n        if (captionBlockWords) {\n            // ‰ªÖ‰øùÁïôÊ≤°Êúâ‰ªª‰ΩïÂ±èËîΩËØçÁöÑÂ∞èËØ¥\n            // novels = novels.filter(novel => {\n            //     return !captionBlockWords.some(item => {\n            //         if (novel.description !== undefined) return novel.description.includes(item)\n            //     })\n            // })\n            novels = novels.filter(novel => !captionBlockWords.some(item => novel.description.includes(item)))\n            let novels2 = novels.map(novel => novel.id)\n            java.log(`üö´ Â±èËîΩÊèèËø∞Ôºö${captionBlockWords.join(\"\\n\")}`)\n            java.log(`üö´ Â±èËîΩÊèèËø∞ÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n        }\n\n        let tagsBlockWords = getFromCache(\"tagsBlockWords\")\n        if (tagsBlockWords === null) tagsBlockWords = []\n        if (tagsBlockWords) {\n            // ‰ªÖ‰øùÁïôÊ≤°Êúâ‰ªª‰ΩïÂ±èËîΩËØçÁöÑÂ∞èËØ¥\n            // novels = novels.filter(novel => {\n            //     return !tagsBlockWords.some(item => {\n            //         if (novel.tags !== undefined) return novel.tags.includes(item)\n            //     })\n            // })\n            novels = novels.filter(novel => !tagsBlockWords.some(item => novel.tags.includes(item)))\n            let novels2 = novels.map(novel => novel.id)\n            java.log(`üö´ Â±èËîΩÊ†áÁ≠æÔºö${tagsBlockWords.join(\"„ÄÅ\")}`)\n            java.log(`üö´ Â±èËîΩÊ†áÁ≠æÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n        }\n        return novels\n    }\n\n    // Êî∂ËóèÂ∞èËØ¥/ËøΩÊõ¥Á≥ªÂàó ÂÜôÂÖ•ÁºìÂ≠ò\n    u.saveNovels = function(listInCacheName, list) {\n        let listInCache = getFromCache(listInCacheName)\n        if (listInCache === null) listInCache = []\n\n        listInCache = listInCache.concat(list)\n        listInCache = Array.from(new Set(listInCache))\n        cache.put(listInCacheName, JSON.stringify(listInCache))\n\n        if (listInCacheName === \"likeNovels\") listInCacheName = \"‚ù§Ô∏è Êî∂ËóèÂ∞èËØ¥ID\"\n        else if (listInCacheName === \"watchedSeries\") listInCacheName = \"üìÉ ËøΩÊõ¥Á≥ªÂàóID\"\n        java.log(`${listInCacheName}Ôºö${JSON.stringify(listInCache)}`)\n    }\n\n    // Â§ÑÁêÜ novels ÂàóË°®\n    u.handNovels = function(novels) {\n        let likeNovels = [], watchedSeries = []\n        novels = util.authorFilter(novels)\n        novels.forEach(novel => {\n            // novel.id = novel.id\n            // novel.title = novel.title\n            // novel.userName = novel.userName\n            // novel.userId = novel.userId\n            // novel.tags = novel.tags\n            cache.put(`${novel.userName}`, novel.userId)  // Âä†ÂÖ•ÁºìÂ≠òÔºå‰æø‰∫éÊêúÁ¥¢‰ΩúËÄÖ\n            if (novel.tags === undefined || novel.tags === null) {\n                novel.tags = []\n            }\n            // ÊêúÁ¥¢ÂçïÁØá\n            if (novel.isOneshot === undefined) {\n                // novel.seriesId = novel.seriesId\n                // novel.seriesTitle = novel.seriesTitle\n                // novel.textCount = novel.textCount\n                // novel.description = novel.description\n                novel.coverUrl = novel.url\n                // novel.createDate = novel.createDate\n                // novel.updateDate = novel.updateDate\n            }\n\n            // ÊêúÁ¥¢Á≥ªÂàó\n            if (novel.isOneshot !== undefined) {\n                if (novel.isOneshot === true) {\n                    novel.seriesId = undefined\n                    novel.id = novel.novelId  // Ëé∑ÂèñÁúüÊ≠£ÁöÑ novelId\n                    novel.seriesTitle = undefined\n                } else {\n                    novel.seriesId = novel.id\n                    novel.id = novel.novelId = novel.latestEpisodeId  // Ëé∑ÂèñÁúüÊ≠£ÁöÑ novelId\n                    novel.seriesTitle = novel.title\n                    // novel.isWatched = novel.isWatched  // ÊêúÁ¥¢Á≥ªÂàóÂèØËé∑Âèñ\n                }\n                novel.textCount = novel.textLength\n                novel.description = novel.caption\n                novel.coverUrl = novel.cover.urls[\"480mw\"]\n                novel.createDate = novel.createDateTime\n                novel.updateDate = novel.updateDateTime\n            }\n\n            // ÂçïÁØáÊ≠£ÊñáËØ¶ÊÉÖÈ°µ\n            if (novel.content) {\n                novel.novelId = novel.id\n                novel.tags = novel.tags.tags.map(item => item.tag)\n                novel.textCount = novel.userNovels[`${novel.id}`].textCount\n                // novel.latestChapter = novel.title\n                // novel.description = novel.description\n                novel.coverUrl = novel.userNovels[`${novel.id}`].url\n                // novel.createDate = novel.createDate\n                novel.updateDate = novel.uploadDate\n\n                if (novel.seriesNavData) {\n                    novel.seriesId = novel.seriesNavData.seriesId\n                    novel.seriesTitle = novel.seriesNavData.title\n                }\n            }\n\n            // Á≥ªÂàóËØ¶ÊÉÖ\n            if (novel.firstNovelId) {\n                novel.seriesId = novel.id\n                novel.id = novel.novelId = novel.firstNovelId\n                novel.seriesTitle = novel.title\n                novel.coverUrl = novel.cover.urls[\"480mw\"]\n                // novel.isWatched = novel.isWatched  // ÊêúÁ¥¢Á≥ªÂàóÂèØËé∑Âèñ\n            }\n\n            // ÂçïÁØáÂä†Êõ¥Â§ö‰ø°ÊÅØ\n            if (!novel.seriesId) {\n                novel.tags.unshift(\"ÂçïÊú¨\")\n                novel.latestChapter = novel.title\n                novel.detailedUrl = urlNovelDetailed(novel.id)\n                novel.total = 1\n                if (novel.bookmarkData) {\n                    novel.isBookmark = true\n                    cache.put(`collect${novel.id}`, novel.bookmarkData.id)\n                    likeNovels.push(Number(novel.id))\n                } else {\n                    novel.isBookmark = false\n                }\n            }\n            // Á≥ªÂàóÊ∑ªÂä†Êõ¥Â§ö‰ø°ÊÅØ\n            if (novel.seriesId) {\n                let series = getAjaxJson(urlSeriesDetailed(novel.seriesId)).body\n                novel.id = series.firstNovelId\n                novel.title = series.title\n                novel.tags = novel.tags.concat(series.tags)\n                novel.tags.unshift(\"ÈïøÁØá\")\n                novel.textCount = series.publishedTotalCharacterCount\n                novel.description = series.caption\n                novel.coverUrl = series.cover.urls[\"480mw\"]\n                novel.detailedUrl = urlSeriesDetailed(novel.seriesId)\n                novel.createDate = series.createDate\n                novel.updateDate = series.updateDate\n                novel.total = series.publishedContentCount\n                novel.isWatched = series.isWatched\n                if (novel.isWatched === true) {\n                    watchedSeries.push(Number(novel.seriesId))\n                }\n\n                // ÂèëÈÄÅËØ∑Ê±ÇËé∑ÂèñÁ¨¨‰∏ÄÁ´† Ëé∑ÂèñÊ†áÁ≠æ‰∏éÁÆÄ‰ªã\n                let firstNovel = {}\n                try {\n                    firstNovel = getAjaxJson(urlNovelDetailed(series.firstNovelId)).body\n                    novel.tags = novel.tags.concat(firstNovel.tags.tags.map(item => item.tag))\n                    if (firstNovel.bookmarkData) {\n                        firstNovel.isBookmark = true\n                        cache.put(`collect${firstNovel.id}`, firstNovel.bookmarkData.id)\n                        likeNovels.push(Number(firstNovel.id))\n                    }\n                } catch (e) {  // Èò≤Ê≠¢Á≥ªÂàóÈ¶ñÁØáÊó†ÊùÉÈôêËé∑Âèñ\n                    try {\n                        firstNovel = getAjaxJson(urlSeriesNovels(novel.seriesId, 30, 0)).body.thumbnails.novel[0]\n                        novel.id = novel.firstNovelId = firstNovel.id\n                        novel.tags = novel.tags.concat(firstNovel.tags)\n                    } catch (e) { // Èò≤Ê≠¢Á≥ªÂàóÈ¶ñÁØáÊó†ÊùÉÈôêËé∑Âèñ\n                        firstNovel = {}\n                        firstNovel.description = \"\"\n                    }\n                }\n                novel.tags.unshift(\"ÈïøÁØá\")\n                if (novel.description === \"\") {\n                    novel.description = firstNovel.description\n                }\n            }\n        })\n        // Êî∂ËóèÂ∞èËØ¥/ËøΩÊõ¥Á≥ªÂàó ÂÜôÂÖ•ÁºìÂ≠ò\n        util.saveNovels(\"likeNovels\", likeNovels)\n        util.saveNovels(\"watchedSeries\", watchedSeries)\n        util.debugFunc(() => {\n            java.log(`Â§ÑÁêÜÂ∞èËØ¥ÂÆåÊàê`)\n        })\n        return novels\n    }\n\n    // Â∞èËØ¥‰ø°ÊÅØÊ†ºÂºèÂåñ\n    u.formatNovels = function(novels) {\n        novels = util.novelFilter(novels)\n        novels.forEach(novel => {\n            if (novel.title) novel.title = novel.title.trim()\n            if (!novel.userName.startsWith(\"@\")) novel.userName = `@${novel.userName}`\n            novel.coverUrl = urlCoverUrl(novel.coverUrl)\n            novel.readingTime = `${novel.readingTime / 60} ÂàÜÈíü`\n            novel.createDate = dateFormat(novel.createDate)\n            novel.updateDate = dateFormat(novel.updateDate)\n\n            novel.tags2 = []\n            for (let i in novel.tags) {\n                let tag = novel.tags[i]\n                if (tag.includes(\"/\")) {\n                    let tags = tag.split(\"/\")\n                    novel.tags2 = novel.tags2.concat(tags)\n                } else {\n                    novel.tags2.push(tag)\n                }\n            }\n            novel.tags = Array.from(new Set(novel.tags2))\n            novel.tags = novel.tags.join(\",\")\n            if (novel.seriesId) {\n                collectMsg = `üìÉ ËøΩÊõ¥Ôºö${util.checkStatus(novel.isWatched)}ËøΩÊõ¥Á≥ªÂàó`\n            } else {\n                collectMsg = `‚ù§Ô∏è Êî∂ËóèÔºö${util.checkStatus(novel.isBookmark)}Âä†ÂÖ•Êî∂Ëóè`\n            }\n\n            if (util.settings.MORE_INFORMATION) {\n                novel.description = `\\nüÖøÔ∏è ÁôªÂΩïÔºö${util.checkStatus(isLogin())}ÁôªÂΩïË¥¶Âè∑\n                ${collectMsg}\\nüìñ ‰π¶ÂêçÔºö${novel.title}\\nüë§ ‰ΩúËÄÖÔºö${novel.userName}\n                #Ô∏è Ê†áÁ≠æÔºö${novel.tags}\\n‚¨ÜÔ∏è ‰∏ä‰º†Ôºö${novel.createDate}\n                üîÑ Êõ¥Êñ∞Ôºö${novel.updateDate}\\nüìÑ ÁÆÄ‰ªãÔºö${novel.description}`\n            } else {\n                novel.description = `\\nüÖøÔ∏è ÁôªÂΩïÔºö${util.checkStatus(isLogin())}ÁôªÂΩïË¥¶Âè∑\n                ${collectMsg}\\n‚¨ÜÔ∏è ‰∏ä‰º†Ôºö${novel.createDate}\\nüîÑ Êõ¥Êñ∞Ôºö${novel.updateDate}\n                üìÑ ÁÆÄ‰ªãÔºö${novel.description}`\n            }\n        })\n        novels = util.novelFilter2(novels)\n        return novels\n    }\n\n    // Ê≠£ÊñáÔºåËØ¶ÊÉÖÔºåÊêúÁ¥¢Ôºö‰ªéÁΩëÂùÄËé∑ÂèñidÔºåËøîÂõûÂçïÁØáÂ∞èËØ¥ resÔºåÁ≥ªÂàóËøîÂõûÈ¶ñÁØáÂ∞èËØ¥ res\n    // pixiv ÈªòËÆ§ÂàÜ‰∫´‰ø°ÊÅØ‰∏≠Êúâ#Âè∑Ôºå‰∏ç‰ºöË¢´ËØÜÂà´ÊàêÈìæÊé•ÔºåÊó†Ê≥ï‰ΩøÁî®Ê∑ªÂä†ÁΩëÂùÄ\n    u.getNovelRes = function(result) {\n        let novelId = 0, res = {\"body\": {}}\n        let isJson = isJsonString(result)\n        let isHtml = isHtmlString(result)\n\n        if (!isJson && isHtml) {\n            let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n            let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net(/ajax)?/users?/\\\\d+\"\n            let isAuthor = baseUrl.match(new RegExp(pattern))\n            if (isAuthor) {\n                java.log(`‰ΩúËÄÖIDÔºö${id}`)\n                novelId = Object.keys(getAjaxJson(urlUserWorkLatest(id)).body.novels).reverse()[0]\n            }\n\n            pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/series/\\\\d+\"\n            let isSeries = baseUrl.match(new RegExp(pattern))\n            if (isSeries) {\n                java.log(`Á≥ªÂàóIDÔºö${id}`)\n                try {\n                    novelId = getAjaxJson(urlSeriesDetailed(id)).body.firstNovelId\n                } catch (e) {\n                    novelId = getAjaxJson(urlSeriesNovels(id, 30, 0)).body.thumbnails.novel[0].id\n                }\n            } else {\n                let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/(show\\\\.php\\\\?id=)?\\\\d+\"\n                let isNovel = baseUrl.match(new RegExp(pattern))\n                if (isNovel) {\n                    novelId = id\n                }\n            }\n        }\n        if (isJson) {\n            res = JSON.parse(result)\n        }\n\n        if (novelId) {\n            java.log(`ÂåπÈÖçÂ∞èËØ¥IDÔºö${novelId}`)\n            res = getAjaxJson(urlNovelDetailed(novelId))\n        }\n        if (res.error === true) {\n            java.log(`Êó†Ê≥ï‰ªé Pixiv Ëé∑ÂèñÂΩìÂâçÂ∞èËØ¥`)\n            java.log(JSON.stringify(res))\n        }\n        return res.body\n    }\n\n    // ÁõÆÂΩïÔºö‰ªéÁΩëÂùÄËé∑ÂèñidÔºåÂ∞ΩÂèØËÉΩËøîÂõûÁ≥ªÂàó resÔºåÂçïÁØáÂ∞èËØ¥ËøîÂõûÂ∞èËØ¥ res\n    u.getNovelResSeries = function(result) {\n        let seriesId = 0, res = {\"body\": {}}\n        let isJson = isJsonString(result)\n        let isHtml = isHtmlString(result)\n\n        if (!isJson && isHtml) {\n            let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n            let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/series/\\\\d+\"\n            let isSeries = baseUrl.match(new RegExp(pattern))\n            if (isSeries) {\n                seriesId = id\n            } else {\n                let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/(show\\\\.php\\\\?id=)?\\\\d+\"\n                let isNovel = baseUrl.match(new RegExp(pattern))\n                if (isNovel) {\n                    java.log(`ÂåπÈÖçÂ∞èËØ¥IDÔºö${id}`)\n                    res = getAjaxJson(urlNovelDetailed(id))\n                }\n            }\n        }\n        if (isJson) {\n            res = JSON.parse(result)\n        }\n\n        if (res.body && res.body.seriesNavData) {\n            seriesId = res.body.seriesNavData.seriesId\n        }\n        if (seriesId) {\n            java.log(`Á≥ªÂàóIDÔºö${seriesId}`)\n            res = getAjaxJson(urlSeriesDetailed(seriesId))\n        }\n        if (res.error === true) {\n            java.log(`Êó†Ê≥ï‰ªé Pixiv Ëé∑ÂèñÂΩìÂâçÂ∞èËØ¥`)\n            java.log(JSON.stringify(res))\n        }\n        return res.body\n    }\n\n    util = u\n    java.put(\"util\", objStringify(u))\n}\n\nfunction checkMessageThread(checkTimes) {\n    if (checkTimes === undefined) {\n        checkTimes = cache.get(\"checkTimes\")\n    }\n    if (checkTimes === 0 && isLogin()) {\n        let latestMsg = getAjaxJson(urlMessageThreadLatest(5))\n        if (latestMsg.error === true) {\n            java.log(JSON.stringify(latestMsg))\n        } else if (latestMsg.body.total >= 1) {\n            let msg = latestMsg.body.message_threads.filter(item => item.thread_name === \"pixiv‰∫ãÂãôÂ±Ä\")[0]\n            if (msg && new Date().getTime()- 1000*msg.modified_at <= 3*24*60*60*1000) { // 3Â§©ÂÜÖËøõË°åÊèêÁ§∫\n                sleepToast(`ÊÇ®‰∫é ${timeFormat(1000*msg.modified_at)} Ëß¶Âèë Pixiv „ÄêËøáÂ∫¶ËÆøÈóÆ„ÄëÔºåËØ∑‰øÆÊîπÂØÜÁ†ÅÂπ∂ÈáçÊñ∞ÁôªÂΩï„ÄÇ\\nÂ¶ÇÂ∑≤‰øÆÊîπËØ∑ÂøΩÁï•`, 3)\n                sleepToast(`${msg.latest_content}`, 5)\n                java.startBrowser(\"https://accounts.pixiv.net/password/change\",'‰øÆÊîπÂØÜÁ†Å')\n            }\n        }\n    }\n    cache.put(\"checkTimes\", checkTimes + 1, 4*60*60)  // ÁºìÂ≠ò4hÔºåÊØè4hÊèêÈÜí‰∏ÄÊ¨°\n    // cache.put(\"checkTimes\", checkTimes + 1, 60)  // ÊµãËØïÁî®ÔºåÁºìÂ≠ò60sÔºåÊØèÂàÜÈíüÊèêÈÜí‰∏ÄÊ¨°\n    // java.log(checkTimes + 1)\n}\n\n// Ëé∑ÂèñËØ∑Ê±ÇÁöÑuser idÊñπ‰æøÂÖ∂‰ªñajaxËØ∑Ê±ÇÊûÑÈÄ†\nfunction getPixivUid() {\n    let uid = cache.get(\"pixiv:uid\")\n    if (!uid || String(uid) === \"null\") {\n        let html = java.webView(null, \"https://www.pixiv.net/\", null)\n        try {\n            uid = html.match(/user_id:'(\\d+)'/)[1]\n        } catch (e) {\n            uid = null\n        }\n        cache.put(\"pixiv:uid\", String(uid))\n    }\n}\n\nfunction getHeaders() {\n    let headers = {\n        \"accept\": \"application/json\",\n        \"accept-encoding\": \"gzip, deflate, br, zstd\",\n        \"accept-language\": \"zh-CN\",\n        // \"content-type\": \"application/json; charset=utf-8\",\n        // \"content-type\": \"application/x-www-form-urlencoded; charset=utf-8\",\n        \"origin\": \"https//www.pixiv.net\",\n        \"referer\": \"https://www.pixiv.net/\",\n        // \"sec-ch-ua\": `\"Not/A)Brand\";v=\"8\", \"Chromium\";v=\"132\", \"Google Chrome\";v=\"132\"`,\n        // \"sec-ch-ua-mobile\": \"?0\",\n        // \"sec-ch-ua-platform\": \"Windows\",\n        // \"sec-fetch-dest\": \"empty\",\n        // \"sec-fetch-mode\": \"cors\",\n        // \"sec-fetch-site\": \"same-origin\",\n        \"user-agent\": cache.get(\"userAgent\"),\n        \"x-csrf-token\": cache.get(\"csfrToken\"),\n        \"Cookie\": cache.get(\"pixivCookie\")\n    }\n    putInCache(\"headers\", headers)\n    return headers\n}\n\n\npublicFunc()\nif (result.code() === 200) {\n    getPixivUid(); getWebViewUA(); util.getCookie(); util.getCsrfToken(); getHeaders()\n    if (!util.settings.FAST) checkMessageThread()   // Ê£ÄÊµãËøáÂ∫¶ËÆøÈóÆ\n}\n\nutil.debugFunc(() => {\n    java.log(`DEBUG = ${util.settings.DEBUG}\\n`)\n    java.log(JSON.stringify(util.settings, null, 4))\n    java.log(`${getWebViewUA()}\\n`)\n    java.log(`${cache.get(\"csfrToken\")}\\n`)\n    java.log(`${cache.get(\"pixivCookie\")}\\n`)\n    java.log(`${cache.get(\"headers\")}\\n`)\n})\n\njava.getStrResponse(null, null)\nvar checkTimes = 0\nvar cacheSaveSeconds = 7*24*60*60  // ÁºìÂ≠òÊó∂Èó¥7Â§©\n\n\nfunction cacheGetAndSet(cache, key, supplyFunc) {\n    let v = cache.get(key)\n    // ÁºìÂ≠ò‰ø°ÊÅØÈîôËØØÊó∂Ôºå‰øùÁïô10minÂêéÈáçÊñ∞ËØ∑Ê±Ç\n    if (v && JSON.parse(v).error === true) {\n        if (new Date().getTime() >= JSON.parse(v).timestamp + 10*60*1000) {\n            cache.delete(key)\n            v = cache.get(key)\n        }\n    }\n    // Êó†ÁºìÂ≠ò‰ø°ÊÅØÊó∂ÔºåËøõË°åËØ∑Ê±Ç\n    if (v === undefined || v === null) {\n        v = supplyFunc()\n        v.timestamp = new Date().getTime()\n        v = JSON.stringify(v)\n        cache.put(key, v, cacheSaveSeconds)\n    }\n    return JSON.parse(v)\n}\n\nfunction putInCache(objectName, object, saveSeconds) {\n    const {java, cache} = this\n    if (object === undefined) object = null\n    if (saveSeconds === undefined) saveSeconds = 0\n    cache.put(objectName, JSON.stringify(object), saveSeconds)\n}\nfunction getFromCache(objectName) {\n    const {java, cache} = this\n    let object = cache.get(objectName)\n    if (object === undefined) return null  // ÂÖºÂÆπÊ∫êÈòÖ\n    return JSON.parse(object)\n}\n\nfunction putInCacheMap(mapName, mapObject, saveSeconds) {\n    const {java, cache} = this\n    let orderedArray = []\n    mapObject.forEach((value, key) => {\n        const item = {}\n        item[key] = value\n        orderedArray.push(item)\n    })\n    // [{'key1': 'value1'}, {'key2': 'value2'}]\n    if (saveSeconds === undefined) saveSeconds = 0\n    cache.put(mapName, JSON.stringify(orderedArray), saveSeconds)\n}\nfunction getFromCacheMap(mapName) {\n    const {java, cache} = this\n    let cached = cache.get(mapName)\n    let newMap = new Map()\n    if (cached === null || cached === undefined) {\n        return newMap\n    }\n\n    let parsedData\n    try {\n        parsedData = JSON.parse(cached)\n    } catch (e) {\n        return newMap\n    }\n\n    if (Array.isArray(parsedData)) {\n        parsedData.forEach(item => {\n            for (let key in item) {\n                newMap.set(key, item[key])\n            }\n        })\n    } else {\n        for (let key in parsedData) {\n            newMap.set(key, parsedData[key])\n        }\n    }\n    return newMap\n}\n\nfunction isHtmlString(str) {\n    return str.startsWith(\"<!DOCTYPE html>\")\n}\nfunction isJsonString(str) {\n    try {\n        if (typeof JSON.parse(str) === \"object\") {\n            return true\n        }\n    } catch(e) {}\n    return false\n}\n\nfunction getWebViewUA() {\n    const {java, cache} = this\n    let userAgent = String(java.getWebViewUA())\n    if (userAgent.includes(\"Windows NT 10.0; Win64; x64\")) {\n        userAgent = \"Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Mobile Safari/537.36\"\n    }\n    // java.log(`userAgent=${userAgent}`)\n    cache.put(\"userAgent\", userAgent)\n    return String(userAgent)\n}\nfunction isLogin() {\n    const {java, cache} = this\n    return !!cache.get(\"csfrToken\")\n}\n\nfunction getAjaxJson(url, forceUpdate) {\n    const {java, cache} = this\n    if (forceUpdate) cache.delete(url)\n    return cacheGetAndSet(cache, url, () => {\n        return JSON.parse(java.ajax(url))\n    })\n}\nfunction getAjaxAllJson(urls, forceUpdate) {\n    const {java, cache} = this\n    if (forceUpdate) cache.delete(urls)\n    return cacheGetAndSet(cache, urls, () => {\n        let result = java.ajaxAll(urls).map(resp => JSON.parse(resp.body()))\n        cache.put(urls, JSON.stringify(result), cacheSaveSeconds)\n        for (let i in urls) cache.put(urls[i], JSON.stringify(result[i]), cacheSaveSeconds)\n        return result\n    })\n}\nfunction getWebviewJson(url, parseFunc) {\n    const {java, cache} = this\n    return cacheGetAndSet(cache, url, () => {\n        let html = java.webView(null, url, null)\n        return JSON.parse(parseFunc(html))\n    })\n}\n\nfunction urlNovelUrl(novelId) {\n    return `https://www.pixiv.net/novel/show.php?id=${novelId}`\n}\nfunction urlNovelDetailed(novelId) {\n    return `https://www.pixiv.net/ajax/novel/${novelId}`\n}\nfunction urlNovelsDetailed(userId, nidList) {\n    return `https://www.pixiv.net/ajax/user/${userId}/novels?${nidList.map(v => `ids[]=${v}`).join(\"&\")}`\n}\nfunction urlNovelBookmarkData(novelId) {\n    return `https://www.pixiv.net/ajax/novel/${novelId}/bookmarkData`\n}\nfunction urlNovelComments(novelId, offset, limit) {\n    return `https://www.pixiv.net/ajax/novels/comments/roots?novel_id=${novelId}&offset=${offset}&limit=${limit}&lang=zh`\n}\nfunction urlNovelCommentsReply(commentId, page) {\n    return `https://www.pixiv.net/ajax/novels/comments/replies?comment_id=${commentId}&page=${page}&lang=zh`\n}\nfunction urlNovelsRecommendInit(novelId, limit=9) {\n    return `https://www.pixiv.net/ajax/novel/${novelId}/recommend/init?limit=${limit}&lang=zh`\n}\nfunction urlNovelsRecommendDetailed(nidList) {\n    if (nidList.length >= 9) nidList.length = 9\n    return `https://www.pixiv.net/ajax/novel/recommend/novels?${nidList.map(v => `novelIds[]=${v}`).join(\"&\")}`\n}\n\nfunction urlSeriesUrl(seriesId) {\n    return `https://www.pixiv.net/novel/series/${seriesId}`\n}\nfunction urlSeriesDetailed(seriesId) {\n    return `https://www.pixiv.net/ajax/novel/series/${seriesId}?lang=zh`\n}\nfunction urlSeriesNovelsTitles(seriesId) {\n    return `https://www.pixiv.net/ajax/novel/series/${seriesId}/content_titles`\n}\nfunction urlSeriesNovels(seriesId, limit, offset) {\n    if (limit > 30) limit = 30\n    if (limit < 10) limit = 10\n    return `https://www.pixiv.net/ajax/novel/series_content/${seriesId}?limit=${limit}&last_order=${offset}&order_by=asc&lang=zh`\n}\n\nfunction urlUserUrl(userID) {\n    return `https://www.pixiv.net/users/${userID}/novels`\n}\nfunction urlUserDetailed(userID) {\n    return `https://www.pixiv.net/ajax/user/${userID}`\n}\nfunction urlUserWorkLatest(userID) {\n    return `https://www.pixiv.net/ajax/user/${userID}/works/latest`\n}\nfunction urlUserAllWorks(userId) {\n    return `https://www.pixiv.net/ajax/user/${userId}/profile/all?lang=zh`\n}\nfunction urlUserBookmarks(userId) {\n    return `https://www.pixiv.net/ajax/user/${userId}/novels/bookmarks?tag=&offset={{(page-1)*30}}&limit=30&rest=show&lang=zh`\n}\n\nfunction urlSearchNovel(novelName, page) {\n    return `https://www.pixiv.net/ajax/search/novels/${encodeURI(novelName)}?word=${encodeURI(novelName)}&order=date_d&mode=all&p=${page}&s_mode=s_tag&lang=zh`\n}\nfunction urlSearchSeries(seriesName, page) {\n    return`https://www.pixiv.net/ajax/search/novels/${encodeURI(seriesName)}?word=${encodeURI(seriesName)}&order=date_d&mode=all&p=${page}&s_mode=s_tag&gs=1&lang=zh`\n}\n// ‰∏çÂÆåÂÖ®ÂåπÈÖçÁî®Êà∑Âêç\nfunction urlSearchUser(userName, full) {\n    if (full === undefined || full === false) {\n        return `https://www.pixiv.net/search/users?nick=${userName}&s_mode=s_usr&nick_mf=1`\n    } else {\n        return `https://www.pixiv.net/search/users?nick=${userName}&s_mode=s_usr_full&i=1`\n    }\n}\n\nfunction urlCoverUrl(url) {\n    return `${url}, {\"headers\": {\"Referer\":\"https://www.pixiv.net/\"}}`\n}\nfunction urlIllustDetailed(illustId) {\n    return `https://www.pixiv.net/ajax/illust/${illustId}?lang=zh`\n}\nfunction urlIllustOriginal(illustId, order) {\n    const {java, cache} = this\n    if (order <= 1) order = 1\n    let url = urlIllustDetailed(illustId)\n    let illustOriginal = cacheGetAndSet(cache, url, () => {\n        return JSON.parse(java.ajax(url))\n    }).body.urls.original\n    return urlCoverUrl(illustOriginal.replace(`_p0`, `_p${order - 1}`))\n}\nfunction urlEmojiUrl(emojiId) {\n    return urlCoverUrl(`https://s.pximg.net/common/images/emoji/${emojiId}.png`)\n}\nfunction urlStampUrl(stampId) {\n    return urlCoverUrl(`https://s.pximg.net/common/images/stamp/generated-stamps/${stampId}_s.jpg`)\n}\n\nfunction urlMessageThreadLatest(max) {\n    if (max === undefined || max <= 5) max = 5\n    return `https://www.pixiv.net/rpc/index.php?mode=latest_message_threads2&num=${max}&lang=zh`\n}\nfunction urlMessageThreadContents(threadId, max) {\n    return `https://www.pixiv.net/rpc/index.php?mode=message_thread_contents&thread_id=${threadId}&num=${max}`\n}\nfunction urlMessageThreadDetail(threadId) {\n    return `https://www.pixiv.net/rpc/index.php?mode=message_thread&thread_id=${threadId}`\n}\nfunction urlNotification() {\n    return `https://www.pixiv.net/ajax/notification&lang=zh`\n}\n\nfunction dateFormat(str) {\n    let addZero = function (num) {\n        return num < 10 ? '0' + num : num;\n    }\n    let time = new Date(str);\n    let Y = time.getFullYear() + \"Âπ¥\";\n    let M = addZero(time.getMonth() + 1) + \"Êúà\";\n    let D = addZero(time.getDate()) + \"Êó•\";\n    return Y + M + D;\n}\nfunction timeFormat(str) {\n    let addZero = function (num) {\n        return num < 10 ? '0' + num : num;\n    }\n    let time = new Date(str);\n    let YY = time.getFullYear()\n    let MM = addZero(time.getMonth() + 1)\n    let DD = addZero(time.getDate())\n    let hh = addZero(time.getHours())\n    let mm = addZero(time.getMinutes())\n    let ss = addZero(time.getSeconds())\n    return `${YY}-${MM}-${DD} ${hh}:${mm}:${ss}`\n}\nfunction timeTextFormat(text) {\n    return `${text.slice(0, 10)} ${text.slice(11, 19)}`\n}\nfunction sleep(time) {\n    let endTime = new Date().getTime() + time\n    while(true){\n        if (new Date().getTime() > endTime){\n            return;\n        }\n    }\n}\nfunction sleepToast(text, second) {\n    const {java} = this\n    java.log(text)\n    // java.toast(text)\n    java.longToast(text)\n    if (second === undefined) second = 0.01\n    sleep(1000*second)\n}\n\nfunction updateSource() {\n    const {java, source} = this\n    java.longToast(\"üÜô Êõ¥Êñ∞‰π¶Ê∫ê\\n\\nJsdelivr CDN Êõ¥Êñ∞ÊúâÂª∂Ëøü\\nGithub Êõ¥Êñ∞ÈúÄ‰ª£ÁêÜ\")\n    let onlineSource, comment, sourceName, sourceNameCapitalize, index = 0\n    if (source.bookSourceUrl.includes(\"pixiv\")) sourceName = \"pixiv\"\n    else if (source.bookSourceUrl.includes(\"furrynovel\")) sourceName = \"linpx\"\n    sourceNameCapitalize = sourceName[0].toUpperCase() + sourceName.substring(1)\n\n    if (source.bookSourceName.includes(\"Â§áÁî®\")) index = 1\n    else if (source.bookSourceName.includes(\"Êº´Áîª\")) index = 2\n    if (source.bookSourceUrl.includes(\"furrynovel.com\")) {\n        sourceNameCapitalize = \"FurryNovel\"\n        index = 1\n    }\n\n    try {\n        let updateUrl = `https://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/${sourceName}.json`\n        onlineSource = JSON.parse(java.get(updateUrl,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body())[index]\n    } catch (e) {\n        try {\n            let updateUrl = `https://raw.githubusercontent.com/windyhusky/PixivSource/main/${sourceName}.json`\n            onlineSource = JSON.parse(java.get(updateUrl,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body())[index]\n        } catch (e) {\n            onlineSource = {lastUpdateTime: new Date().getTime(), bookSourceComment: source.bookSourceComment}\n        }\n    }\n    comment = onlineSource.bookSourceComment.split(\"\\n\")\n    // onlineSource = source\n    // comment = source.bookSourceComment.split(\"\\n\")\n\n    let htm = `\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Êõ¥Êñ∞ ${source.bookSourceName} ‰π¶Ê∫ê</title>\n    <style> \n    table { text-align: center; margin: 0 auto; } .ann { display: flex; justify-content: center; align-items: center; height: 5vh; } \n    button { background-color: rgb(76, 175, 80); color: white; border: none; border-radius: 4px; height: 6vh; width: 30vw; overflow: hidden; } \n    button span { cursor: pointer; display: inline-block; position: relative; transition: 0.4s; } \n    button span:after { content: '>'; position: absolute; opacity: 0; top: 0; right: 30px; transition: 0.2s; } \n    button:active span { padding-right: 20px; } \n    button:active span:after { opacity: 1; right: -40px; }\n    </style>\n</head>\n\n<body>\n    <table border=\"1\" cellspacing=\"0\">\n        <th colspan=\"2\"> ${source.bookSourceName} ‰π¶Ê∫ê <a href=\"https://github.com/windyhusky/PixivSource/blob/main/doc/${sourceNameCapitalize}.md\">üî∞ ‰ΩøÁî®ÊåáÂçó</a></th>\n        <tr>\n            <td>‚òÅÔ∏è ËøúÁ®ãÁâàÊú¨Ôºö${onlineSource.bookSourceComment.split(\"\\n\")[2].replace(\"‰π¶Ê∫êÁâàÊú¨Ôºö\", \"\")}</td>\n            <td>üìÜ Êõ¥Êñ∞Ôºö${timeFormat(onlineSource.lastUpdateTime)}</td>\n        </tr>\n        <tr>\n            <td>üì• Êú¨Âú∞ÁâàÊú¨Ôºö${source.bookSourceComment.split(\"\\n\")[2].replace(\"‰π¶Ê∫êÁâàÊú¨Ôºö\", \"\")}</td>\n            <td>üìÜ Êõ¥Êñ∞Ôºö${timeFormat(source.lastUpdateTime)}</td>\n        </tr> \n        <tr><td colspan=\"2\" style=\"text-align: left;\">${comment.slice(3, 10).join(\"<br>\")}</td></tr>\n        <tr><td colspan=\"2\" style=\"text-align: left;\">${comment.slice(comment.length-2, comment.length).join(\"<br>\")}</td></tr>\n    </table>\n    \n    <table border=\"0\" cellspacing=\"20\">\n        <th colspan=\"2\"> Êõ¥Êñ∞ ${source.bookSourceName} ‰π¶Ê∫ê </th>\n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/${sourceName}.json\">\n            <button><span>Êõ¥Êñ∞‰π¶Ê∫ê<br>(Jsdelivr CDN)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/btsrk.json\">\n            <button><span>Êõ¥Êñ∞ËÆ¢ÈòÖ<br>(Jsdelivr CDN)</span></button>\n            </a></div></td>\n        </tr>\n        \n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://raw.githubusercontent.com/windyhusky/PixivSource/main/${sourceName}.json\">\n            <button><span>‰π¶Ê∫êÈìæÊé•<br>(GitHub)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://raw.githubusercontent.com/windyhusky/PixivSource/main/btsrk.json\">\n            <button><span>ËÆ¢ÈòÖÈìæÊé•<br>(GitHub)</span></button>\n            </a></div></td>\n        </tr>\n        \n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://codeberg.org/DowneyRem/PixivSource/raw/branch/main/${sourceName}.json\">\n            <button><span>Â§áÁî®‰π¶Ê∫êÈìæÊé•<br>(Codeberg)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://codeberg.org/DowneyRem/PixivSource/raw/branch/main/btsrk.json\">\n            <button><span>Â§áÁî®ËÆ¢ÈòÖÈìæÊé•<br>(Codeberg)</span></button>\n            </a></div></td>\n        </tr>\n    </table>\n</body>\n</html>`;\n    java.startBrowser(`data:text/html;charset=utf-8;base64, ${java.base64Encode(htm)}`, 'Êõ¥Êñ∞‰π¶Ê∫ê');\n    return []\n}",
        "lastUpdateTime": 1759852800251,
        "loginCheckJs": "var util = {}\n\nfunction objStringify(obj) {\n    return JSON.stringify(obj, (n, v) => {\n        if (typeof v == \"function\")\n            return v.toString();\n        return v;\n    });\n}\nfunction isBackupSource() {\n    let isBackupSource = source.bookSourceName.includes(\"Â§áÁî®\")\n    cache.put(\"isBackupSource\", isBackupSource)\n    return isBackupSource\n}\n// Ê£ÄÊµã Ê∫êÈòÖ\n// ÂèØÁî® java.ajax() ‰∏çÂèØÁî® java.webview() java.ajaxAll()\n// ÂèØÁî® java.getCookie() cache.put() cache.get() ÈªòËÆ§ÂÄº‰∏∫ undefined\n// ÂèØÁî® java.startBrowser() ‰∏çÂèØÁî® java.startBrowserAwaitAwait\n// ÂèØÁî® source.bookSourceName source.getVariable() source.setVariable()Á≠â\n// java.getUserAgent() java.getWebViewUA() ÁõÆÂâçËøîÂõûÂÜÖÂÆπÁõ∏Âêå\nfunction isSourceRead() {\n    let isSourceReadStatus = java.getUserAgent() === java.getWebViewUA()\n    cache.put(\"isSourceRead\", isSourceReadStatus)\n    return isSourceReadStatus\n}\n\nfunction publicFunc() {\n    let u = {}, settings\n    // ËæìÂá∫‰π¶Ê∫ê‰ø°ÊÅØ\n    java.log(`üÖøÔ∏è ${source.bookSourceComment.split(\"\\n\")[0]}`)\n    java.log(`üìå ${source.bookSourceComment.split(\"\\n\")[2]}`)\n    if (isSourceRead()) {\n        java.log(`üìÜ Êõ¥Êñ∞Êó∂Èó¥Ôºö${java.timeFormat(source.lastUpdateTime)}`)\n        java.log(\"üì± ËΩØ‰ª∂Âπ≥Âè∞Ôºöüçé Ê∫êÈòÖ SourceRead\")\n    } else {\n        java.log(`üìÜ Êõ¥Êñ∞Êó∂Èó¥Ôºö${timeFormat(source.lastUpdateTime)}`)\n        java.log(\"üì± ËΩØ‰ª∂Âπ≥Âè∞Ôºöü§ñ ÂºÄÊ∫êÈòÖËØª Leagdo\")\n    }\n\n    // Ëé∑ÂèñËÆæÁΩÆÔºåÂ§áÁî®‰π¶Ê∫ê‰ΩøÁî®ÊóßÁâàËÆæÁΩÆÔºå‰π¶Ê∫ê‰ªéÁºìÂ≠òËé∑ÂèñËÆæÁΩÆ\n    if (isBackupSource()) {\n        settings = JSON.parse(String(source.variableComment).match(RegExp(/{([\\s\\S]*?)}/gm)))\n    } else {\n        // cache.delete(\"pixivSettings\")\n        settings = getFromCache(\"pixivSettings\")\n    }\n    if (settings !== null) {\n        java.log(\"‚öôÔ∏è ‰ΩøÁî®Ëá™ÂÆö‰πâËÆæÁΩÆ\")\n    } else {\n        settings = {}\n        settings.SEARCH_AUTHOR = true       // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n        settings.CONVERT_CHINESE = true     // ÊêúÁ¥¢ÔºöÊêúÁ¥¢Êó∂ËøõË°åÁπÅÁÆÄËΩ¨Êç¢\n        settings.SHOW_LIKE_NOVELS = true    // ÊêúÁ¥¢ÔºöÊêúÁ¥¢ÁªìÊûúÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥\n        settings.SHOW_WATCHED_SERIES = true // ÊêúÁ¥¢ÔºöÊêúÁ¥¢ÁªìÊûúÊòæÁ§∫ËøΩÊï¥Á≥ªÂàóÂ∞èËØ¥\n        settings.MORE_INFORMATION = false   // ËØ¶ÊÉÖÔºö‰π¶Á±çÁÆÄ‰ªãÊòæÁ§∫Êõ¥Â§ö‰ø°ÊÅØ\n        settings.SHOW_UPDATE_TIME = true    // ÁõÆÂΩïÔºöÊòæÁ§∫Êõ¥Êñ∞Êó∂Èó¥Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Â∞ëËÆ∏ËØ∑Ê±Ç\n        settings.SHOW_ORIGINAL_LINK = true  // ÁõÆÂΩïÔºöÊòæÁ§∫ÂéüÂßãÈìæÊé•Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Â§ßÈáèËØ∑Ê±Ç\n        settings.REPLACE_TITLE_MARKS = true // Ê≠£ÊñáÔºöÊ≥®Èü≥ÂÜÖÂÆπ‰∏∫Ê±âÂ≠óÊó∂ÔºåÊõøÊç¢‰∏∫‰π¶ÂêçÂè∑\n        settings.SHOW_CAPTIONS = true       // Ê≠£ÊñáÔºöÁ´†È¶ñÊòæÁ§∫ÊèèËø∞\n        settings.SHOW_COMMENTS = true       // Ê≠£ÊñáÔºöÁ´†Â∞æÊòæÁ§∫ËØÑËÆ∫\n        settings.FAST  = false              // ÂÖ®Â±ÄÔºöÂø´ÈÄüÊ®°Âºè\n        settings.DEBUG = false              // ÂÖ®Â±ÄÔºöË∞ÉËØïÊ®°Âºè\n        java.log(\"‚öôÔ∏è ‰ΩøÁî®ÈªòËÆ§ËÆæÁΩÆÔºàÊó†Ëá™ÂÆö‰πâËÆæÁΩÆ Êàñ Ëá™ÂÆö‰πâËÆæÁΩÆÊúâËØØÔºâ\")\n    }\n    if (settings.FAST === true) {\n        settings.SEARCH_AUTHOR = false        // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n        settings.CONVERT_CHINESE = false      // ÊêúÁ¥¢ÔºöÁπÅÁÆÄÈÄöÊêú\n        settings.SHOW_UPDATE_TIME = false     // ÁõÆÂΩïÔºöÊòæÁ§∫Á´†ËäÇÊõ¥Êñ∞Êó∂Èó¥\n        settings.SHOW_ORIGINAL_LINK = false   // ÁõÆÂΩïÔºöÊòæÁ§∫Á´†ËäÇÊ∫êÈìæÊé•\n        settings.SHOW_COMMENTS = false        // Ê≠£ÊñáÔºöÊòæÁ§∫ËØÑËÆ∫\n    } else {\n        settings.SEARCH_AUTHOR = true        // ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n    }\n    settings.IS_LEGADO = !isSourceRead()\n    settings.IS_SOURCE_READ = isSourceRead()\n    settings.IS_BACKUP_SOURCE = isBackupSource()\n    u.settings = settings\n    putInCache(\"pixivSettings\", settings)  // ËÆæÁΩÆÂÜôÂÖ•ÁºìÂ≠ò\n\n    u.debugFunc = (func) => {\n        if (util.settings.DEBUG === true) {\n            func()\n        }\n    }\n\n    u.checkStatus = function(status) {\n        if (status === true) return \"‚úÖ Â∑≤\"\n        else if (status === false) return \"‚ùå Êú™\"\n        else if (status === undefined) return \"üàöÔ∏è Êó†Êï∞ÊçÆÔºö\"\n    }\n\n    u.login = function() {\n        let resp = java.startBrowserAwait(`https://accounts.pixiv.net/login,\n    {\"headers\": {\"User-Agent\": \"${java.getWebViewUA()}\"}}`, 'ÁôªÂΩïË¥¶Âè∑', false)\n        if (resp.code() === 200) {\n            this.getCsrfToken(); this.getCookie()\n        } else {\n            java.log(resp.code()); sleepToast(\"‚ö†Ô∏è ÁôªÂΩïÂ§±Ë¥•\")\n        }\n    }\n\n    u.logout = function() {\n        this.removeCookie()\n        java.startBrowser(\"https://www.pixiv.net/logout.php\", \"ÈÄÄÂá∫Ë¥¶Âè∑\")\n        this.removeCookie()\n        sleepToast(`‚úÖ Â∑≤ÈÄÄÂá∫ÂΩìÂâçË¥¶Âè∑\\n\\nÈÄÄÂá∫ÂêéËØ∑ÁÇπÂáªÂè≥‰∏äËßíÁöÑ ‚úîÔ∏è ÈÄÄÂá∫\\n\\nÁôªÂΩïËØ∑ÁÇπÂáª„ÄêÁôªÂΩïË¥¶Âè∑„ÄëËøõË°åÁôªÂΩï`)\n    }\n\n    u.getCookie = function() {\n        let pixivCookie = String(java.getCookie(\"https://www.pixiv.net/\", null))\n        if (isLogin()) cache.put(\"pixivCookie\", pixivCookie, 60*60)  // ÁºìÂ≠ò1h\n    }\n\n    u.removeCookie = function() {\n        cookie.removeCookie('https://www.pixiv.net')\n        cookie.removeCookie('https://accounts.pixiv.net')\n        cookie.removeCookie('https://accounts.google.com')\n        cookie.removeCookie('https://api.weibo.com')\n        cache.delete(\"pixivCookie\")\n        cache.delete(\"pixiv:uid\")\n        cache.delete(\"csfrToken\")  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥\n        cache.delete(\"headers\")\n    }\n\n    // Ëé∑Âèñ Csrf TokenÔºå‰ª•‰æøËøõË°åÊî∂ËóèÁ≠âËØ∑Ê±Ç\n    // Ëé∑ÂèñÊñπÊ≥ïÊù•Ëá™ËÑöÊú¨ Pixiv Previewer\n    // https://github.com/Ocrosoft/PixivPreviewer\n    // https://greasyfork.org/zh-CN/scripts/30766-pixiv-previewer/code\n    u.getCsrfToken = function() {\n        let csfrToken = cache.get(\"csfrToken\")\n        if (!csfrToken) {\n            let html = java.webView(null, \"https://www.pixiv.net/\", null)\n            try {\n                csfrToken = html.match(/token\\\\\":\\\\\"([a-z0-9]{32})/)[1]\n                cache.put(\"csfrToken\", csfrToken)  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n            } catch (e) {\n                csfrToken = null\n                cache.delete(\"csfrToken\")  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n                // sleepToast(\"‚ö†Ô∏è Êú™ÁôªÂΩïË¥¶Âè∑(csfrToken)\")\n            }\n            java.log(`csfrToken:\\n${csfrToken}`)\n        }\n        return csfrToken\n    }\n\n    // Â∞ÜÂ§ö‰∏™ÈïøÁØáÂ∞èËØ¥Ëß£Êûê‰∏∫‰∏ÄÊú¨‰π¶\n    u.combineNovels = function(novels) {\n        return novels.filter(novel => {\n            // ÂçïÊú¨Áõ¥Êé•Ëß£Êûê‰∏∫‰∏ÄÊú¨‰π¶\n            if (novel.seriesId === undefined || novel.seriesId === null) {\n                return true\n            }\n            // ÈõÜÂêà‰∏≠Ê≤°ÊúâËØ•Á≥ªÂàóËß£Êûê‰∏∫‰∏ÄÊú¨‰π¶\n            if (!seriesSet.has(novel.seriesId)) {\n                seriesSet.add(novel.seriesId)\n                return true\n            }\n            return false\n        })\n    }\n\n    // Â±èËîΩ‰ΩúËÄÖ\n    u.authorFilter = function(novels) {\n        let authors = getFromCache(\"blockAuthorList\")\n        if (authors !== null && authors.length >= 0) {\n            java.log(`üö´ Â±èËîΩ‰ΩúËÄÖIDÔºö${JSON.stringify(authors)}`)\n            authors.forEach(author => {\n                novels = novels.filter(novel => novel.userId !== String(author))\n            })\n        }\n        return novels\n    }\n\n\n    // ËøáÊª§Êî∂Ëóè‰∏éËøΩÊõ¥\n    u.novelFilter = function(novels) {\n        let novels1 = [], novels2 = [], msg\n        let likeNovels = getFromCache(\"likeNovels\")\n        let watchedSeries = getFromCache(\"watchedSeries\")\n        let novels0 = novels.map(novel => novel.id)\n\n        msg = util.checkStatus(util.settings.SHOW_LIKE_NOVELS).replace(\"Êú™\",\"‰∏ç\")\n        java.log(`${msg}ÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥`)\n        if (util.settings.SHOW_LIKE_NOVELS === false) {\n            novels = novels.filter(novel => !likeNovels.includes(Number(novel.id)))\n            novels1 = novels.map(novel => novel.id)\n            java.log(`‚è¨ ËøáÊª§Êî∂ËóèÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels1.length}`)\n        }\n\n        msg = util.checkStatus(util.settings.SHOW_WATCHED_SERIES).replace(\"Êú™\",\"‰∏ç\")\n        java.log(`${msg}ÊòæÁ§∫ËøΩÊõ¥Á≥ªÂàó`)\n        if (util.settings.SHOW_WATCHED_SERIES === false) {\n            novels = novels.filter(novel => !watchedSeries.includes(Number(novel.seriesId)))\n            novels2 = novels.map(novel => novel.id)\n            if (novels1.length >= 1) novels0 = novels1\n            java.log(`‚è¨ ËøáÊª§ËøΩÊõ¥ÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n        }\n\n        let novels3 = novels.map(novel => novel.id)\n        if (novels0.length >= 1 && novels3.length === 0) {\n            let msg = `‚è¨ ËøáÊª§Â∞èËØ¥\\n‚ö†Ô∏è ËøáÊª§ÂêéÊó†ÁªìÊûú\\n\\nËØ∑Ê†πÊçÆÈúÄË¶Å\\n`\n            if (util.settings.SHOW_LIKE_NOVELS === false) msg += \"ÂºÄÂêØÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥\\n\"\n            if (util.settings.SHOW_WATCHED_SERIES === false) msg += \"ÂºÄÂêØÊòæÁ§∫ËøΩÊõ¥Á≥ªÂàó\"\n            sleepToast(msg, 1)\n        }\n\n        util.debugFunc(() => {\n            // java.log(JSON.stringify(novels0))\n            java.log(JSON.stringify(novels0.length))\n            // java.log(JSON.stringify(novels1))\n            java.log(JSON.stringify(novels1.length))\n            // java.log(JSON.stringify(novels2))\n            java.log(JSON.stringify(novels2.length))\n        })\n        return novels\n    }\n\n    // ËøáÊª§ÊèèËø∞‰∏éÊ†áÁ≠æÔºàÂ±èËîΩÊ†áÁ≠æ/Â±èËîΩÊèèËø∞Ôºâ\n    u.novelFilter2 = function(novels) {\n        let novels0 = novels.map(novel => novel.id)\n        let captionBlockWords = getFromCache(\"captionBlockWords\")\n        if (captionBlockWords === null) captionBlockWords = []\n        if (captionBlockWords) {\n            // ‰ªÖ‰øùÁïôÊ≤°Êúâ‰ªª‰ΩïÂ±èËîΩËØçÁöÑÂ∞èËØ¥\n            // novels = novels.filter(novel => {\n            //     return !captionBlockWords.some(item => {\n            //         if (novel.description !== undefined) return novel.description.includes(item)\n            //     })\n            // })\n            novels = novels.filter(novel => !captionBlockWords.some(item => novel.description.includes(item)))\n            let novels2 = novels.map(novel => novel.id)\n            java.log(`üö´ Â±èËîΩÊèèËø∞Ôºö${captionBlockWords.join(\"\\n\")}`)\n            java.log(`üö´ Â±èËîΩÊèèËø∞ÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n        }\n\n        let tagsBlockWords = getFromCache(\"tagsBlockWords\")\n        if (tagsBlockWords === null) tagsBlockWords = []\n        if (tagsBlockWords) {\n            // ‰ªÖ‰øùÁïôÊ≤°Êúâ‰ªª‰ΩïÂ±èËîΩËØçÁöÑÂ∞èËØ¥\n            // novels = novels.filter(novel => {\n            //     return !tagsBlockWords.some(item => {\n            //         if (novel.tags !== undefined) return novel.tags.includes(item)\n            //     })\n            // })\n            novels = novels.filter(novel => !tagsBlockWords.some(item => novel.tags.includes(item)))\n            let novels2 = novels.map(novel => novel.id)\n            java.log(`üö´ Â±èËîΩÊ†áÁ≠æÔºö${tagsBlockWords.join(\"„ÄÅ\")}`)\n            java.log(`üö´ Â±èËîΩÊ†áÁ≠æÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n        }\n        return novels\n    }\n\n    // Êî∂ËóèÂ∞èËØ¥/ËøΩÊõ¥Á≥ªÂàó ÂÜôÂÖ•ÁºìÂ≠ò\n    u.saveNovels = function(listInCacheName, list) {\n        let listInCache = getFromCache(listInCacheName)\n        if (listInCache === null) listInCache = []\n\n        listInCache = listInCache.concat(list)\n        listInCache = Array.from(new Set(listInCache))\n        cache.put(listInCacheName, JSON.stringify(listInCache))\n\n        if (listInCacheName === \"likeNovels\") listInCacheName = \"‚ù§Ô∏è Êî∂ËóèÂ∞èËØ¥ID\"\n        else if (listInCacheName === \"watchedSeries\") listInCacheName = \"üìÉ ËøΩÊõ¥Á≥ªÂàóID\"\n        java.log(`${listInCacheName}Ôºö${JSON.stringify(listInCache)}`)\n    }\n\n    // Â§ÑÁêÜ novels ÂàóË°®\n    u.handNovels = function(novels) {\n        let likeNovels = [], watchedSeries = []\n        novels = util.authorFilter(novels)\n        novels.forEach(novel => {\n            // novel.id = novel.id\n            // novel.title = novel.title\n            // novel.userName = novel.userName\n            // novel.userId = novel.userId\n            // novel.tags = novel.tags\n            cache.put(`${novel.userName}`, novel.userId)  // Âä†ÂÖ•ÁºìÂ≠òÔºå‰æø‰∫éÊêúÁ¥¢‰ΩúËÄÖ\n            if (novel.tags === undefined || novel.tags === null) {\n                novel.tags = []\n            }\n            // ÊêúÁ¥¢ÂçïÁØá\n            if (novel.isOneshot === undefined) {\n                // novel.seriesId = novel.seriesId\n                // novel.seriesTitle = novel.seriesTitle\n                // novel.textCount = novel.textCount\n                // novel.description = novel.description\n                novel.coverUrl = novel.url\n                // novel.createDate = novel.createDate\n                // novel.updateDate = novel.updateDate\n            }\n\n            // ÊêúÁ¥¢Á≥ªÂàó\n            if (novel.isOneshot !== undefined) {\n                if (novel.isOneshot === true) {\n                    novel.seriesId = undefined\n                    novel.id = novel.novelId  // Ëé∑ÂèñÁúüÊ≠£ÁöÑ novelId\n                    novel.seriesTitle = undefined\n                } else {\n                    novel.seriesId = novel.id\n                    novel.id = novel.novelId = novel.latestEpisodeId  // Ëé∑ÂèñÁúüÊ≠£ÁöÑ novelId\n                    novel.seriesTitle = novel.title\n                    // novel.isWatched = novel.isWatched  // ÊêúÁ¥¢Á≥ªÂàóÂèØËé∑Âèñ\n                }\n                novel.textCount = novel.textLength\n                novel.description = novel.caption\n                novel.coverUrl = novel.cover.urls[\"480mw\"]\n                novel.createDate = novel.createDateTime\n                novel.updateDate = novel.updateDateTime\n            }\n\n            // ÂçïÁØáÊ≠£ÊñáËØ¶ÊÉÖÈ°µ\n            if (novel.content) {\n                novel.novelId = novel.id\n                novel.tags = novel.tags.tags.map(item => item.tag)\n                novel.textCount = novel.userNovels[`${novel.id}`].textCount\n                // novel.latestChapter = novel.title\n                // novel.description = novel.description\n                novel.coverUrl = novel.userNovels[`${novel.id}`].url\n                // novel.createDate = novel.createDate\n                novel.updateDate = novel.uploadDate\n\n                if (novel.seriesNavData) {\n                    novel.seriesId = novel.seriesNavData.seriesId\n                    novel.seriesTitle = novel.seriesNavData.title\n                }\n            }\n\n            // Á≥ªÂàóËØ¶ÊÉÖ\n            if (novel.firstNovelId) {\n                novel.seriesId = novel.id\n                novel.id = novel.novelId = novel.firstNovelId\n                novel.seriesTitle = novel.title\n                novel.coverUrl = novel.cover.urls[\"480mw\"]\n                // novel.isWatched = novel.isWatched  // ÊêúÁ¥¢Á≥ªÂàóÂèØËé∑Âèñ\n            }\n\n            // ÂçïÁØáÂä†Êõ¥Â§ö‰ø°ÊÅØ\n            if (!novel.seriesId) {\n                novel.tags.unshift(\"ÂçïÊú¨\")\n                novel.latestChapter = novel.title\n                novel.detailedUrl = urlNovelDetailed(novel.id)\n                novel.total = 1\n                if (novel.bookmarkData) {\n                    novel.isBookmark = true\n                    cache.put(`collect${novel.id}`, novel.bookmarkData.id)\n                    likeNovels.push(Number(novel.id))\n                } else {\n                    novel.isBookmark = false\n                }\n            }\n            // Á≥ªÂàóÊ∑ªÂä†Êõ¥Â§ö‰ø°ÊÅØ\n            if (novel.seriesId) {\n                let series = getAjaxJson(urlSeriesDetailed(novel.seriesId)).body\n                novel.id = series.firstNovelId\n                novel.title = series.title\n                novel.tags = novel.tags.concat(series.tags)\n                novel.tags.unshift(\"ÈïøÁØá\")\n                novel.textCount = series.publishedTotalCharacterCount\n                novel.description = series.caption\n                novel.coverUrl = series.cover.urls[\"480mw\"]\n                novel.detailedUrl = urlSeriesDetailed(novel.seriesId)\n                novel.createDate = series.createDate\n                novel.updateDate = series.updateDate\n                novel.total = series.publishedContentCount\n                novel.isWatched = series.isWatched\n                if (novel.isWatched === true) {\n                    watchedSeries.push(Number(novel.seriesId))\n                }\n\n                // ÂèëÈÄÅËØ∑Ê±ÇËé∑ÂèñÁ¨¨‰∏ÄÁ´† Ëé∑ÂèñÊ†áÁ≠æ‰∏éÁÆÄ‰ªã\n                let firstNovel = {}\n                try {\n                    firstNovel = getAjaxJson(urlNovelDetailed(series.firstNovelId)).body\n                    novel.tags = novel.tags.concat(firstNovel.tags.tags.map(item => item.tag))\n                    if (firstNovel.bookmarkData) {\n                        firstNovel.isBookmark = true\n                        cache.put(`collect${firstNovel.id}`, firstNovel.bookmarkData.id)\n                        likeNovels.push(Number(firstNovel.id))\n                    }\n                } catch (e) {  // Èò≤Ê≠¢Á≥ªÂàóÈ¶ñÁØáÊó†ÊùÉÈôêËé∑Âèñ\n                    try {\n                        firstNovel = getAjaxJson(urlSeriesNovels(novel.seriesId, 30, 0)).body.thumbnails.novel[0]\n                        novel.id = novel.firstNovelId = firstNovel.id\n                        novel.tags = novel.tags.concat(firstNovel.tags)\n                    } catch (e) { // Èò≤Ê≠¢Á≥ªÂàóÈ¶ñÁØáÊó†ÊùÉÈôêËé∑Âèñ\n                        firstNovel = {}\n                        firstNovel.description = \"\"\n                    }\n                }\n                novel.tags.unshift(\"ÈïøÁØá\")\n                if (novel.description === \"\") {\n                    novel.description = firstNovel.description\n                }\n            }\n        })\n        // Êî∂ËóèÂ∞èËØ¥/ËøΩÊõ¥Á≥ªÂàó ÂÜôÂÖ•ÁºìÂ≠ò\n        util.saveNovels(\"likeNovels\", likeNovels)\n        util.saveNovels(\"watchedSeries\", watchedSeries)\n        util.debugFunc(() => {\n            java.log(`Â§ÑÁêÜÂ∞èËØ¥ÂÆåÊàê`)\n        })\n        return novels\n    }\n\n    // Â∞èËØ¥‰ø°ÊÅØÊ†ºÂºèÂåñ\n    u.formatNovels = function(novels) {\n        novels = util.novelFilter(novels)\n        novels.forEach(novel => {\n            if (novel.title) novel.title = novel.title.trim()\n            if (!novel.userName.startsWith(\"@\")) novel.userName = `@${novel.userName}`\n            novel.coverUrl = urlCoverUrl(novel.coverUrl)\n            novel.readingTime = `${novel.readingTime / 60} ÂàÜÈíü`\n            novel.createDate = dateFormat(novel.createDate)\n            novel.updateDate = dateFormat(novel.updateDate)\n\n            novel.tags2 = []\n            for (let i in novel.tags) {\n                let tag = novel.tags[i]\n                if (tag.includes(\"/\")) {\n                    let tags = tag.split(\"/\")\n                    novel.tags2 = novel.tags2.concat(tags)\n                } else {\n                    novel.tags2.push(tag)\n                }\n            }\n            novel.tags = Array.from(new Set(novel.tags2))\n            novel.tags = novel.tags.join(\",\")\n            if (novel.seriesId) {\n                collectMsg = `üìÉ ËøΩÊõ¥Ôºö${util.checkStatus(novel.isWatched)}ËøΩÊõ¥Á≥ªÂàó`\n            } else {\n                collectMsg = `‚ù§Ô∏è Êî∂ËóèÔºö${util.checkStatus(novel.isBookmark)}Âä†ÂÖ•Êî∂Ëóè`\n            }\n\n            if (util.settings.MORE_INFORMATION) {\n                novel.description = `\\nüÖøÔ∏è ÁôªÂΩïÔºö${util.checkStatus(isLogin())}ÁôªÂΩïË¥¶Âè∑\n                ${collectMsg}\\nüìñ ‰π¶ÂêçÔºö${novel.title}\\nüë§ ‰ΩúËÄÖÔºö${novel.userName}\n                #Ô∏è Ê†áÁ≠æÔºö${novel.tags}\\n‚¨ÜÔ∏è ‰∏ä‰º†Ôºö${novel.createDate}\n                üîÑ Êõ¥Êñ∞Ôºö${novel.updateDate}\\nüìÑ ÁÆÄ‰ªãÔºö${novel.description}`\n            } else {\n                novel.description = `\\nüÖøÔ∏è ÁôªÂΩïÔºö${util.checkStatus(isLogin())}ÁôªÂΩïË¥¶Âè∑\n                ${collectMsg}\\n‚¨ÜÔ∏è ‰∏ä‰º†Ôºö${novel.createDate}\\nüîÑ Êõ¥Êñ∞Ôºö${novel.updateDate}\n                üìÑ ÁÆÄ‰ªãÔºö${novel.description}`\n            }\n        })\n        novels = util.novelFilter2(novels)\n        return novels\n    }\n\n    // Ê≠£ÊñáÔºåËØ¶ÊÉÖÔºåÊêúÁ¥¢Ôºö‰ªéÁΩëÂùÄËé∑ÂèñidÔºåËøîÂõûÂçïÁØáÂ∞èËØ¥ resÔºåÁ≥ªÂàóËøîÂõûÈ¶ñÁØáÂ∞èËØ¥ res\n    // pixiv ÈªòËÆ§ÂàÜ‰∫´‰ø°ÊÅØ‰∏≠Êúâ#Âè∑Ôºå‰∏ç‰ºöË¢´ËØÜÂà´ÊàêÈìæÊé•ÔºåÊó†Ê≥ï‰ΩøÁî®Ê∑ªÂä†ÁΩëÂùÄ\n    u.getNovelRes = function(result) {\n        let novelId = 0, res = {\"body\": {}}\n        let isJson = isJsonString(result)\n        let isHtml = isHtmlString(result)\n\n        if (!isJson && isHtml) {\n            let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n            let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net(/ajax)?/users?/\\\\d+\"\n            let isAuthor = baseUrl.match(new RegExp(pattern))\n            if (isAuthor) {\n                java.log(`‰ΩúËÄÖIDÔºö${id}`)\n                novelId = Object.keys(getAjaxJson(urlUserWorkLatest(id)).body.novels).reverse()[0]\n            }\n\n            pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/series/\\\\d+\"\n            let isSeries = baseUrl.match(new RegExp(pattern))\n            if (isSeries) {\n                java.log(`Á≥ªÂàóIDÔºö${id}`)\n                try {\n                    novelId = getAjaxJson(urlSeriesDetailed(id)).body.firstNovelId\n                } catch (e) {\n                    novelId = getAjaxJson(urlSeriesNovels(id, 30, 0)).body.thumbnails.novel[0].id\n                }\n            } else {\n                let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/(show\\\\.php\\\\?id=)?\\\\d+\"\n                let isNovel = baseUrl.match(new RegExp(pattern))\n                if (isNovel) {\n                    novelId = id\n                }\n            }\n        }\n        if (isJson) {\n            res = JSON.parse(result)\n        }\n\n        if (novelId) {\n            java.log(`ÂåπÈÖçÂ∞èËØ¥IDÔºö${novelId}`)\n            res = getAjaxJson(urlNovelDetailed(novelId))\n        }\n        if (res.error === true) {\n            java.log(`Êó†Ê≥ï‰ªé Pixiv Ëé∑ÂèñÂΩìÂâçÂ∞èËØ¥`)\n            java.log(JSON.stringify(res))\n        }\n        return res.body\n    }\n\n    // ÁõÆÂΩïÔºö‰ªéÁΩëÂùÄËé∑ÂèñidÔºåÂ∞ΩÂèØËÉΩËøîÂõûÁ≥ªÂàó resÔºåÂçïÁØáÂ∞èËØ¥ËøîÂõûÂ∞èËØ¥ res\n    u.getNovelResSeries = function(result) {\n        let seriesId = 0, res = {\"body\": {}}\n        let isJson = isJsonString(result)\n        let isHtml = isHtmlString(result)\n\n        if (!isJson && isHtml) {\n            let id = baseUrl.match(new RegExp(\"\\\\d+\"))[0]\n            let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/series/\\\\d+\"\n            let isSeries = baseUrl.match(new RegExp(pattern))\n            if (isSeries) {\n                seriesId = id\n            } else {\n                let pattern = \"(https?://)?(www\\\\.)?pixiv\\\\.net/novel/(show\\\\.php\\\\?id=)?\\\\d+\"\n                let isNovel = baseUrl.match(new RegExp(pattern))\n                if (isNovel) {\n                    java.log(`ÂåπÈÖçÂ∞èËØ¥IDÔºö${id}`)\n                    res = getAjaxJson(urlNovelDetailed(id))\n                }\n            }\n        }\n        if (isJson) {\n            res = JSON.parse(result)\n        }\n\n        if (res.body && res.body.seriesNavData) {\n            seriesId = res.body.seriesNavData.seriesId\n        }\n        if (seriesId) {\n            java.log(`Á≥ªÂàóIDÔºö${seriesId}`)\n            res = getAjaxJson(urlSeriesDetailed(seriesId))\n        }\n        if (res.error === true) {\n            java.log(`Êó†Ê≥ï‰ªé Pixiv Ëé∑ÂèñÂΩìÂâçÂ∞èËØ¥`)\n            java.log(JSON.stringify(res))\n        }\n        return res.body\n    }\n\n    util = u\n    java.put(\"util\", objStringify(u))\n}\n\nfunction checkMessageThread(checkTimes) {\n    if (checkTimes === undefined) {\n        checkTimes = cache.get(\"checkTimes\")\n    }\n    if (checkTimes === 0 && isLogin()) {\n        let latestMsg = getAjaxJson(urlMessageThreadLatest(5))\n        if (latestMsg.error === true) {\n            java.log(JSON.stringify(latestMsg))\n        } else if (latestMsg.body.total >= 1) {\n            let msg = latestMsg.body.message_threads.filter(item => item.thread_name === \"pixiv‰∫ãÂãôÂ±Ä\")[0]\n            if (msg && new Date().getTime()- 1000*msg.modified_at <= 3*24*60*60*1000) { // 3Â§©ÂÜÖËøõË°åÊèêÁ§∫\n                sleepToast(`ÊÇ®‰∫é ${timeFormat(1000*msg.modified_at)} Ëß¶Âèë Pixiv „ÄêËøáÂ∫¶ËÆøÈóÆ„ÄëÔºåËØ∑‰øÆÊîπÂØÜÁ†ÅÂπ∂ÈáçÊñ∞ÁôªÂΩï„ÄÇ\\nÂ¶ÇÂ∑≤‰øÆÊîπËØ∑ÂøΩÁï•`, 3)\n                sleepToast(`${msg.latest_content}`, 5)\n                java.startBrowser(\"https://accounts.pixiv.net/password/change\",'‰øÆÊîπÂØÜÁ†Å')\n            }\n        }\n    }\n    cache.put(\"checkTimes\", checkTimes + 1, 4*60*60)  // ÁºìÂ≠ò4hÔºåÊØè4hÊèêÈÜí‰∏ÄÊ¨°\n    // cache.put(\"checkTimes\", checkTimes + 1, 60)  // ÊµãËØïÁî®ÔºåÁºìÂ≠ò60sÔºåÊØèÂàÜÈíüÊèêÈÜí‰∏ÄÊ¨°\n    // java.log(checkTimes + 1)\n}\n\n// Ëé∑ÂèñËØ∑Ê±ÇÁöÑuser idÊñπ‰æøÂÖ∂‰ªñajaxËØ∑Ê±ÇÊûÑÈÄ†\nfunction getPixivUid() {\n    let uid = cache.get(\"pixiv:uid\")\n    if (!uid || String(uid) === \"null\") {\n        let html = java.webView(null, \"https://www.pixiv.net/\", null)\n        try {\n            uid = html.match(/user_id:'(\\d+)'/)[1]\n        } catch (e) {\n            uid = null\n        }\n        cache.put(\"pixiv:uid\", String(uid))\n    }\n}\n\nfunction getHeaders() {\n    let headers = {\n        \"accept\": \"application/json\",\n        \"accept-encoding\": \"gzip, deflate, br, zstd\",\n        \"accept-language\": \"zh-CN\",\n        // \"content-type\": \"application/json; charset=utf-8\",\n        // \"content-type\": \"application/x-www-form-urlencoded; charset=utf-8\",\n        \"origin\": \"https//www.pixiv.net\",\n        \"referer\": \"https://www.pixiv.net/\",\n        // \"sec-ch-ua\": `\"Not/A)Brand\";v=\"8\", \"Chromium\";v=\"132\", \"Google Chrome\";v=\"132\"`,\n        // \"sec-ch-ua-mobile\": \"?0\",\n        // \"sec-ch-ua-platform\": \"Windows\",\n        // \"sec-fetch-dest\": \"empty\",\n        // \"sec-fetch-mode\": \"cors\",\n        // \"sec-fetch-site\": \"same-origin\",\n        \"user-agent\": cache.get(\"userAgent\"),\n        \"x-csrf-token\": cache.get(\"csfrToken\"),\n        \"Cookie\": cache.get(\"pixivCookie\")\n    }\n    putInCache(\"headers\", headers)\n    return headers\n}\n\n\npublicFunc()\nif (result.code() === 200) {\n    getPixivUid(); getWebViewUA(); util.getCookie(); util.getCsrfToken(); getHeaders()\n    if (!util.settings.FAST) checkMessageThread()   // Ê£ÄÊµãËøáÂ∫¶ËÆøÈóÆ\n}\n\nutil.debugFunc(() => {\n    java.log(`DEBUG = ${util.settings.DEBUG}\\n`)\n    java.log(JSON.stringify(util.settings, null, 4))\n    java.log(`${getWebViewUA()}\\n`)\n    java.log(`${cache.get(\"csfrToken\")}\\n`)\n    java.log(`${cache.get(\"pixivCookie\")}\\n`)\n    java.log(`${cache.get(\"headers\")}\\n`)\n})\n\njava.getStrResponse(null, null)",
        "loginUrl": "https://accounts.pixiv.net/login",
        "respondTime": 180000,
        "ruleBookInfo": {
            "author": "userName",
            "canReName": "true",
            "coverUrl": "coverUrl",
            "init": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction novelHandler(novel){\n    novel = util.formatNovels(util.handNovels([novel]))[0]\n    if (novel.seriesId === undefined || novel.seriesId === null) {\n        book.bookUrl = novel.detailedUrl = urlNovelUrl(novel.id)\n        book.tocUrl = novel.catalogUrl = urlNovelDetailed(novel.id)\n    } else {\n        book.bookUrl = novel.detailedUrl = urlSeriesUrl(novel.seriesId)\n        book.tocUrl = novel.catalogUrl = urlSeriesDetailed(novel.seriesId)\n    }\n    // ÊîæÂÖ•‰ø°ÊÅØ‰ª•‰æøÁôªÈôÜÁïåÈù¢‰ΩøÁî®\n    source.putLoginInfo(JSON.stringify(novel))\n    cache.put(\"novel\", JSON.stringify(novel))\n    return novel\n}\n\n(() => {\n    return novelHandler(util.getNovelRes(result))\n})()",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "tocUrl": "catalogUrl",
            "wordCount": "textCount"
        },
        "ruleContent": {
            "content": "@js:\nvar util = objParse(String(java.get(\"util\")))\nlet emoji = {\n    \"normal\": 101, \"surprise\": 102, \"series\": 103, \"heaven\": 104, \"happy\": 105,\n    \"excited\": 106, \"sing\": 107, \"cry\": 108, \"normal2\": 201, \"shame2\": 202,\n    \"love2\": 203, \"interesting2\": 204, \"blush2\": 205, \"fire2\": 206, \"angry2\": 207,\n    \"shine2\": 208, \"panic2\": 209, \"normal3\": 301, \"satisfaction3\": 302, \"surprise3\": 303,\n    \"smile3\": 304, \"shock3\": 305, \"gaze3\": 306, \"wink3\": 307, \"happy3\": 308,\n    \"excited3\": 309, \"love3\": 310, \"normal4\": 401, \"surprise4\": 402, \"series4\": 403,\n    \"love4\": 404, \"shine4\": 405, \"sweet4\": 406, \"shame4\": 407, \"sleep4\": 408,\n    \"heart\": 501, \"teardrop\": 502, \"star\": 503\n}\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction getNovelInfo(res) {\n    // ÊîæÂÖ•Â∞èËØ¥‰ø°ÊÅØ‰ª•‰æøÁôªÈôÜÁïåÈù¢‰ΩøÁî®\n    let novel = source.getLoginInfoMap()\n    if (novel === undefined) novel = JSON.parse(cache.get(\"novel\"))\n    if (res && res.error === true) return\n    novel.id = Number(res.id)\n    novel.title = res.title\n    novel.userId = res.userId\n    novel.userName = res.userName\n\n    if (res.bookmarkData) {\n        novel.isBookmark = true\n        cache.put(`collect${novel.id}`, res.bookmarkData.id)\n        util.saveNovels(\"likeNovels\", [Number(novel.id)])\n    } else {\n        novel.isBookmark = false\n    }\n\n    if (res.seriesNavData) {\n        novel.seriesId = Number(res.seriesNavData.seriesId)\n        novel.seriesTitle = res.seriesNavData.title\n        novel.isWatched = res.seriesNavData.isWatched\n        util.saveNovels(\"watchedSeries\", [Number(novel.seriesId)])\n    } else {\n        novel.seriesId = null\n        novel.seriesTitle = \"\"\n        novel.isWatched = false\n    }\n\n    // Á≥ªÂàó + ÈòÖËØªÔºå‰ΩøÁî®ÂΩìÂâçÁ´†ËäÇÂêçÁß∞\n    if (novel.seriesId && util.settings.IS_LEGADO) {\n        let novelIds = JSON.parse(cache.get(`novelIds${novel.seriesId}`))\n        novel.id = novelIds[book.durChapterIndex]\n        novel.title = book.durChapterTitle\n\n        let bookmarkId = JSON.parse(cache.get(`collect${novel.id}`))\n        novel.isBookmark = !!bookmarkId\n    }\n\n    // Ê∑ªÂä†ÊäïÁ•®‰ø°ÊÅØ\n    if (res.pollData) novel.pollChoicesCount = res.pollData.choices.length\n    else novel.pollChoicesCount = 0\n    source.putLoginInfo(JSON.stringify(novel))\n    cache.put(\"novel\", JSON.stringify(novel))\n}\n\nfunction getContent(res) {\n    getNovelInfo(res)  // ÊîæÂÖ•‰ø°ÊÅØ‰ª•‰æøÁôªÈôÜÁïåÈù¢‰ΩøÁî®\n    let content = String(res.content)\n    // let content = \"undefined\"\n    if (content.includes(\"undefined\")) {\n        return checkContent()\n    }\n\n    // Âú®Ê≠£ÊñáÂÜÖÈÉ®Ê∑ªÂä†Â∞èËØ¥ÊèèËø∞\n    if (util.settings.SHOW_CAPTIONS && res.description !== \"\") {\n        content = res.description + \"\\n\" + \"‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\\n\".repeat(2) + content\n    }\n\n    // Ëé∑Âèñ [uploadedimage:] ÁöÑÂõæÁâáÈìæÊé•\n    let hasEmbeddedImages = res.textEmbeddedImages !== undefined && res.textEmbeddedImages !== null\n    if (hasEmbeddedImages) {\n        Object.keys(res.textEmbeddedImages).forEach((key) => {\n            content = content.replace(`[uploadedimage:${key}]`, `<img src=\"${urlCoverUrl(res.textEmbeddedImages[key].urls.original)}\">`)\n        })\n    }\n\n    // Ëé∑Âèñ [pixivimage:] ÁöÑÂõæÁâáÈìæÊé• [pixivimage:1234] [pixivimage:1234-1]\n    let matched = content.match(RegExp(/\\[pixivimage:(\\d+)-?(\\d+)]/gm))\n    if (matched) {\n        matched.forEach(pixivimage => {\n            let matched2, illustId, order = 0\n            if (pixivimage.includes(\"-\")) {\n                matched2 = pixivimage.match(RegExp(\"(\\\\d+)-(\\\\d+)\"))\n                illustId = matched2[1]; order = matched2[2]\n            } else {\n                matched2 = pixivimage.match(RegExp(\"\\\\d+\"))\n                illustId = matched2[0];\n            }\n            content = content.replace(`${pixivimage}`, `<img src=\"${urlIllustOriginal(illustId, order)}\">`)\n        })\n    }\n\n    // ÊõøÊç¢ Pixiv ÂàÜÈ°µÊ†áËÆ∞Á¨¶Âè∑ [newpage]\n    matched = content.match(RegExp(/[ „ÄÄ]*\\[newpage][ „ÄÄ]*/gm))\n    if (matched) {\n        for (let i in matched) {\n            content = content.replace(`${matched[i]}`, `${\"<p>‚Äã<p/>\".repeat(3)}`)\n        }\n    }\n\n    // ÊõøÊç¢ Pixiv Á´†ËäÇÊ†áËÆ∞Á¨¶Âè∑ [chapter:]\n    matched = content.match(RegExp(/\\[chapter:(.*?)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[chapter:(.*?)]/m)\n            let chapter = matched2[1].trim()\n            content = content.replace(`${matched[i]}`, `${chapter}<p>‚Äã<p/>`)\n        }\n    }\n\n    // ÊõøÊç¢ Pixiv Ë∑≥ËΩ¨È°µÈù¢Ê†áËÆ∞Á¨¶Âè∑ [[jump:]]\n    matched = content.match(RegExp(/\\[jump:(\\d+)]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let page = matched[i].match(/\\d+/)\n            content = content.replace(`${matched[i]}`, `\\n\\nË∑≥ËΩ¨Ëá≥Á¨¨${page}ËäÇ`)\n        }\n    }\n\n    // ÊõøÊç¢ Pixiv ÈìæÊé•Ê†áËÆ∞Á¨¶Âè∑ [[jumpuri: > ]]\n    matched = content.match(RegExp(/\\[\\[jumpuri:(.*?)>(.*?)]]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[\\[jumpuri:(.*?)>(.*?)]]/m)\n            let matchedText = matched2[0]\n            let urlName = matched2[1].trim()\n            let urlLink = matched2[2].trim()\n            // ÈòÖËØª‰∏çÊîØÊåÅË∂ÖÈìæÊé•\n            //content = content.replace(`${matchedText}`, `<a href=${urlLink}>${urlName}</a>`)\n            if (urlLink === urlName) {\n                content = content.replace(`${matchedText}`, `${urlName}`)\n            } else {\n                content = content.replace(`${matchedText}`, `${urlName}: ${urlLink}`)\n            }\n        }\n    }\n\n    // ÊõøÊç¢ Pixiv Ê≥®Èü≥Ê†áËÆ∞Á¨¶Âè∑ [[rb: > ]]\n    matched = content.match(RegExp(/\\[\\[rb:(.*?)>(.*?)]]/gm))\n    if (matched) {\n        for (let i in matched) {\n            let matched2 = matched[i].match(/\\[\\[rb:(.*?)>(.*?)]]/m)\n            let matchedText = matched2[0]\n            let kanji = matched2[1].trim()\n            let kana = matched2[2].trim()\n\n            if (!util.settings.REPLACE_TITLE_MARKS) {\n                // ÈªòËÆ§ÊõøÊç¢ÊàêÔºàÊã¨Âè∑Ôºâ\n                content = content.replace(`${matchedText}`, `${kanji}Ôºà${kana}Ôºâ`)\n            } else {\n                let reg = RegExp(\"[\\\\u4E00-\\\\u9FFF]+\", \"g\");\n                if (reg.test(kana)) {\n                    // kana‰∏∫‰∏≠ÊñáÔºåÂàôÊõøÊç¢Âõû„Ää‰π¶ÂêçÂè∑„Äã\n                    content = content.replace(`${matchedText}`, `${kanji}„Ää${kana}„Äã`)\n                } else {\n                    // ÈòÖËØª‰∏çÊîØÊåÅ <ruby> <rt> Ê≥®Èü≥\n                    // content = content.replace(`${matchedText}`, `<ruby>${kanji}<rt>${kana}</rt></ruby>`)\n                    content = content.replace(`${matchedText}`, `${kanji}Ôºà${kana}Ôºâ`)\n                }\n            }\n        }\n    }\n\n    // Ê∑ªÂä†ÊäïÁ•®\n    if (res.pollData) {\n        let poll = `üìÉ ÊäïÁ•®(‚úÖ${res.pollData.total}Â∑≤Êäï)Ôºö\\n${res.pollData.question}\\n`\n        res.pollData.choices.forEach(choice => {\n            poll += `ÈÄâÈ°π${choice.id}Ôºö${choice.text}(‚úÖ${choice.count})\\n`\n        })\n        content += \"\\n\" + \"‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\\n\".repeat(2) + poll\n    }\n\n    // Ê∑ªÂä†ËØÑËÆ∫\n    if (util.settings.SHOW_COMMENTS) {\n        return content + getComment(res)\n    } else {\n        return content\n    }\n}\n\nfunction getComment(res) {\n    // let resp = getAjaxJson(urlNovelComments(res.id, 0, res.commentCount), true)\n    const limit = 50  // Ê®°Êãü Pixiv ËØ∑Ê±Ç\n    let resp = {\"error\": false, \"message\": \"\", \"body\": {comments:[]} }\n    let maxPage = (res.commentCount / limit) + 1\n    for (let i = 0; i < maxPage; i++) {\n        let result = getAjaxJson(urlNovelComments(res.id, i*limit, 50), true)\n        if (result.error !== true && result.body.comments !== null) {\n            resp.body.comments = resp.body.comments.concat(result.body.comments)\n        }\n    }\n\n    // Âà∑Êñ∞Êó∂ÔºåÂà∑Êñ∞ËØÑËÆ∫Ôºå‰∏çÊõ¥Êñ∞Ê≠£Êñá\n    let commentCount = resp.body.comments.length\n    java.log(`„Äê${res.title}„Äë(${res.id})ÔºåÂÖ±Êúâ${commentCount}Êù°ËØÑËÆ∫Ôºå${res.commentCount - commentCount}Êù°ÂõûÂ§ç`)\n    if (commentCount === 0) {\n        return \"\"\n    }\n\n    let comments = `üí¨ ËØÑËÆ∫(ÂÖ±ËÆ°${commentCount}Êù°)Ôºö\\n`\n    resp.body.comments.forEach(comment => {\n        if (comment.comment === \"\") {\n            comment.comment = `<img src=\"${urlStampUrl(comment.stampId)}\">`\n        }\n        if (Object.keys(emoji).includes(comment.comment.slice(1, -1))) {\n            comment.emojiId = emoji[comment.comment.slice(1, -1)]\n            comment.comment = `<img src=\"${urlEmojiUrl(comment.emojiId)}\">`\n        }\n        if (comment.userId === String(cache.get(\"pixiv:uid\"))) {\n            comments += `@${comment.userName}Ôºö${comment.comment}(${comment.commentDate})(${comment.id})\\n`\n        } else {\n            comments += `@${comment.userName}Ôºö${comment.comment}(${comment.commentDate})\\n`\n        }\n\n        // Ëé∑ÂèñËØÑËÆ∫ÂõûÂ§ç\n        if (comment.hasReplies === true) {\n            let resp = getAjaxJson(urlNovelCommentsReply(comment.id, 1), true)\n            if (resp.error === true) return comments\n\n            resp.body.comments.reverse().forEach(reply => {\n                if (reply.comment === \"\") {\n                    reply.comment = `<img src=\"${urlStampUrl(reply.stampId)}\">`\n                }\n                if (Object.keys(emoji).includes(reply.comment.slice(1, -1))) {\n                    reply.emojiId = emoji[reply.comment.slice(1, -1)]\n                    reply.comment = `<img src=\"${urlEmojiUrl(reply.emojiId)}\">`\n                }\n                if (comment.userId === String(cache.get(\"pixiv:uid\"))) {\n                    comments += `@${reply.userName}(‚§¥Ô∏è@${reply.replyToUserName})Ôºö${reply.comment}(${reply.commentDate})(${reply.id})\\n`\n                } else {\n                    comments += `@${reply.userName}(‚§¥Ô∏è@${reply.replyToUserName})Ôºö${reply.comment}(${reply.commentDate})\\n`\n                }\n            })\n            comments += \"‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\\n\"\n        }\n    })\n    if (comments) {\n        comments = \"\\n\" + \"‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\\n\".repeat(2) + comments\n    }\n    return comments\n}\n\nfunction checkContent() {\n    let latestMsg = getAjaxJson(urlMessageThreadLatest(5))\n    if (latestMsg.error === true) {\n        java.log(JSON.stringify(latestMsg))\n\n    } else if (latestMsg.body.total >= 1) {\n        let msg = latestMsg.body.message_threads.filter(item => item.thread_name === \"pixiv‰∫ãÂãôÂ±Ä\")[0]\n        if (msg === undefined) {\n            sleepToast(`ÊÇ®‰∫é ${java.timeFormat(new Date().getTime())} Ëß¶Âèë Pixiv „ÄêËØ∑Ê±ÇÈôêÂà∂„ÄëÔºåÂª∫ËÆÆÁ®çÂÄô/ÈáçÊñ∞ÁôªÂΩïÂÜçÁªßÁª≠`, 3)\n            // java.startBrowser(\"https://www.pixiv.net\", 'ÈÄÄÂá∫ÁôªÂΩï')\n            // java.startBrowser(\"https://www.pixiv.net/logout.php\",'ÈÄÄÂá∫ÁôªÂΩï')  // ‰∏çÊ∏ÖÈô§ WebView ÁºìÂ≠òÊó†Ê≥ïÈáçÊñ∞ÁôªÂΩï\n\n        } else if (new Date().getTime()- 1000*msg.modified_at <= 3*24*60*60*1000) { // 3*24hÂÜÖÊèêÈÜí\n            sleepToast(`ÊÇ®‰∫é ${java.timeFormat(1000*msg.modified_at)} Ëß¶Âèë Pixiv „ÄêËøáÂ∫¶ËÆøÈóÆ„ÄëÔºåËØ∑‰øÆÊîπÂØÜÁ†ÅÂπ∂ÈáçÊñ∞ÁôªÂΩï`, 3)\n            sleepToast(`${msg.latest_content}`, 5)\n            java.startBrowser(\"https://accounts.pixiv.net/password/change\",'‰øÆÊîπÂØÜÁ†Å')\n        }\n    }\n}\n\n(() => {\n    return getContent(util.getNovelRes(result))\n})()",
            "imageStyle": "DEFAULT"
        },
        "ruleExplore": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\nvar seriesSet = new Set();  // Â≠òÂÇ®seriesID ÊúâBUGÊó†Ê≥ïÂ§ÑÁêÜÁøªÈ°µ\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction handlerFactory() {\n    if (baseUrl.includes(\"https://cdn.jsdelivr.net\")) {\n        return () => {updateSource(); return []}\n    }\n    if (!isLogin()) {\n        return handlerNoLogin()\n    }\n    if (baseUrl.includes(\"/bookmark\")) {\n        return handlerBookMarks()\n    }\n    if (baseUrl.includes(\"/top\")) {\n        return handlerRecommend()\n    }\n    if (baseUrl.includes(\"/follow_latest\")) {\n        return handlerFollowLatest()\n    }\n    if (baseUrl.includes(\"/watch_list\")) {\n        return handlerWatchList()\n    }\n    if (baseUrl.includes(\"/discovery\")) {\n        return handlerDiscovery()\n    }\n    if (baseUrl.includes(\"/new\")) {\n        return handlerDiscovery()\n    }\n    if (baseUrl.includes(\"/commission/\")) {\n        return handlerFollowLatest()\n    }\n    if (baseUrl.includes(\"/user_event/portal\")) {\n        return handlerFollowLatest()\n    }\n    if (baseUrl.includes(\"/genre\")) {\n        return handlerWatchList()\n    }\n    // Ê≠£ÂàôÂåπÈÖçÁΩëÂùÄÂÜÖÂÆπ\n    if (baseUrl.includes(\"/ranking\")) {\n        return handlerRanking()\n    }\n    if (baseUrl.includes(\"/marker_all\")) {\n        return handlerRanking()\n    }\n    if (baseUrl.includes(\"/editors_picks\")) {\n        return handlerRanking()\n    }\n    if (baseUrl.includes(\"/ajax/search/novels\")) {\n        return handlerSearch()\n    }\n    if (baseUrl.startsWith(\"https://www.pixiv.net\")) {\n        return handlerRanking()\n    }\n    else {\n        return []\n    }\n}\n\nfunction handlerNoLogin() {\n    return () => {\n        sleepToast(\"‚ö†Ô∏è ÂΩìÂâçÊú™ÁôªÂΩïË¥¶Âè∑\\n\\nËØ∑ÁôªÂΩï Pixiv Ë¥¶Âè∑\", 1.5)\n        util.removeCookie(); util.login()\n        sleepToast(\"ÁôªÂΩïÊàêÂäüÂêéÔºåËØ∑ÈáçÊñ∞ËøõÂÖ•ÂèëÁé∞\", 2)\n        return []\n    }\n}\n\n// Êé®ËçêÂ∞èËØ¥\nfunction handlerRecommend() {\n    return () => {\n        let res = JSON.parse(result)\n        const recommend = res.body.page.recommend\n        const novels = res.body.thumbnails.novel\n        let nidSet = new Set(recommend.ids)\n        // java.log(nidSet.size)\n        let list = novels.filter(novel => nidSet.has(String(novel.id)))\n        // java.log(`ËøáÊª§ÁªìÊûú:${JSON.stringify(list)}`)\n        return util.formatNovels(util.handNovels(util.combineNovels(list)))\n    }\n}\n\n// Êî∂ËóèÂ∞èËØ¥Ôºå‰ªñ‰∫∫Êî∂Ëóè\nfunction handlerBookMarks() {\n    return () => {\n        let res = JSON.parse(result).body.works\n        if (res === undefined || res.length === 0) {\n            //ÊµÅÁ®ãÊó†Ê≥ïÊú¨ÁéØËäÇ‰∏≠Ê≠¢ Âè™ËÉΩ‰∫§Áªô‰∏ã‰∏ÄÊµÅÁ®ãÂ§ÑÁêÜ\n            return []\n        }\n        return util.formatNovels(util.handNovels(res))\n    }\n}\n\n//ÂÖ≥Ê≥®‰ΩúËÄÖÔºåÂ∞èËØ¥ÂßîÊâòÔºåÂ∞èËØ¥‰ºÅÂàí\nfunction handlerFollowLatest() {\n    return () => {\n        let res = JSON.parse(result)\n        return util.formatNovels(util.handNovels(util.combineNovels(res.body.thumbnails.novel)))\n    }\n}\n\n//Êé®ËçêÂ∞èËØ¥ÔºåÊúÄËøëÂ∞èËØ¥\nfunction handlerDiscovery() {\n    return () => {\n        let res = JSON.parse(result)\n        return util.formatNovels(util.handNovels(util.combineNovels(res.body.novels)))\n    }\n}\n\n// ÊêúÁ¥¢Ê†áÁ≠æ\nfunction handlerSearch() {\n    return () => {\n        let res = JSON.parse(result)\n        return util.formatNovels(util.handNovels(util.combineNovels(res.body.novel.data)))\n    }\n}\n\n// ËøΩÊõ¥ÂàóË°®ÔºåÁÉ≠Èó®ÂàÜÁ±ª\nfunction handlerWatchList() {\n    return () => {\n        let res = JSON.parse(result)\n        return util.formatNovels(util.handNovels(res.body.thumbnails.novelSeries))\n    }\n}\n\n// ÊéíË°åÊ¶úÔºå‰π¶Á≠æÔºåÈ¶ñÈ°µÔºåÁºñËæëÈÉ®Êé®ËçêÔºåÈ°∫Â∫èÁõ∏Âêå\nfunction handlerRanking() {\n    if (util.settings.IS_LEGADO) return handlerRankingAjaxAll()\n    // else if (util.settings.IS_SOURCE_READ) return handlerRankingWebview()\n    else if (util.settings.IS_SOURCE_READ) return handlerRankingAjax()\n    else return []\n}\n\n// ÊéíË°åÊ¶úÔºå‰π¶Á≠æÔºåÈ¶ñÈ°µÔºåÁºñËæëÈÉ®Êé®ËçêÔºåÈ°∫Â∫èÁõ∏Âêå\nfunction handlerRankingAjaxAll() {\n    return () => {\n        let  novelIds = [], novelUrls = []\n        // let result = result + java.ajax(`${baseUrl}&p=2`)  // Ê≠£ÂàôËé∑ÂèñÁΩëÂùÄ‰∏≠ÁöÑ novelId\n        let matched = result.match(RegExp(/\\/novel\\/show\\.php\\?id=\\d{5,}/gm))\n        for (let i in matched) {\n            let novelId = matched[i].match(RegExp(/\\d{5,}/))[0]\n            if (novelIds.indexOf(novelId) === -1) {\n                novelIds.push(novelId)\n                novelUrls.push(urlNovelDetailed(novelId))\n            }\n        }\n        // java.log(JSON.stringify(novelIds))\n        let novels = getAjaxAllJson(novelUrls).map(resp => resp.body)\n        return util.formatNovels(util.handNovels(util.combineNovels(novels)))\n    }\n}\n\n// ÊéíË°åÊ¶úÔºå‰π¶Á≠æÔºåÈ¶ñÈ°µ\nfunction handlerRankingWebview() {\n    return () => {\n        let novelIds = []  // Ê≠£ÂàôËé∑ÂèñÁΩëÂùÄ‰∏≠ÁöÑ novelId\n        // let result = result + java.ajax(`${baseUrl}&p=2`)  // Ê≠£ÂàôËé∑ÂèñÁΩëÂùÄ‰∏≠ÁöÑ novelId\n        let matched = result.match(RegExp(/\\/novel\\/show\\.php\\?id=\\d{5,}/gm))\n        for (let i in matched) {\n            let novelId = matched[i].match(RegExp(/\\d{5,}/))[0]\n            if (novelIds.indexOf(novelId) === -1) {\n                novelIds.push(novelId)\n            }\n        }\n        // java.log(JSON.stringify(novelIds))\n        let userNovels = getWebviewJson(\n            urlNovelsDetailed(`${cache.get(\"pixiv:uid\")}`, novelIds), html => {\n                return (html.match(new RegExp(\">\\\\{.*?}<\"))[0].replace(\">\", \"\").replace(\"<\", \"\"))\n            }).body\n        return util.formatNovels(util.handNovels(util.combineNovels(Object.values(userNovels))))\n    }\n}\n\n// ÊéíË°åÊ¶úÔºå‰π¶Á≠æÔºåÈ°∫Â∫èÁõ∏Âêå\nfunction handlerRankingAjax() {\n    return () => {\n        let novels = [], novelIds = []\n        // let result = result + java.ajax(`${baseUrl}&p=2`)  // Ê≠£ÂàôËé∑ÂèñÁΩëÂùÄ‰∏≠ÁöÑ novelId\n        let matched = result.match(RegExp(/\\/novel\\/show\\.php\\?id=\\d{5,}/gm))\n        for (let i in matched) {\n            let novelId = matched[i].match(RegExp(/\\d{5,}/))[0]\n            if (novelIds.indexOf(novelId) === -1) {\n                novelIds.push(novelId)\n                // java.log(urlNovelDetailed(novelId))\n                let res = getAjaxJson(urlNovelDetailed(novelId))\n                if (res.error !== true) {\n                    novels.push(res.body)\n                } else {\n                    java.log(JSON.stringify(res))\n                }\n            }\n        }\n        return util.formatNovels(util.handNovels(util.combineNovels(novels)))\n    }\n}\n\n(() => {\n    return handlerFactory()()\n})()",
            "bookUrl": "detailedUrl",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "wordCount": "textCount"
        },
        "ruleSearch": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nvar first = true;\n// Â≠òÂÇ®seriesID\nvar seriesSet = {\n    keywords: \"Pixiv:Search\",\n    has: (value) => {\n        let page = Number(java.get(\"page\"))\n        if (page === 1 && first) {\n            first = false\n            cache.deleteMemory(this.keywords)\n            return false\n        }\n\n        let v = cache.getFromMemory(this.keywords)\n        if (v === undefined || v === null) {\n            return false\n        }\n        let set = new Set(JSON.parse(v))\n        return set.has(value)\n    },\n\n    add: (value) => {\n        let v = cache.getFromMemory(this.keywords)\n        if (v === undefined || v === null) {\n            cache.putMemory(this.keywords, JSON.stringify([value]))\n\n        } else {\n            let arr = JSON.parse(v)\n            if (typeof arr === \"string\") {\n                arr = Array(arr)\n            }\n            arr.push(value)\n            cache.putMemory(this.keywords, JSON.stringify(arr))\n        }\n    },\n};\n\nfunction getUserNovels() {\n    if (!isLogin()) {\n        sleepToast(\"üë§ ÊêúÁ¥¢‰ΩúËÄÖ\\n\\n‚ö†Ô∏è ÂΩìÂâçÊú™ÁôªÂΩïË¥¶Âè∑\\nËØ∑ÁôªÂΩï Pixiv Ë¥¶Âè∑\", 1.5)\n        util.removeCookie(); util.login()\n        sleepToast(\"üë§ ÊêúÁ¥¢‰ΩúËÄÖ\\n\\nÁôªÂΩïÊàêÂäüÂêéÔºåËØ∑ÈáçÊñ∞ÊêúÁ¥¢\", 2)\n        return []\n    }\n\n    let uidList = [], novels = []\n    let username = String(java.get(\"keyword\"))\n    let page = Number(java.get(\"page\"))\n\n    // cache.delete(username)\n    let userid = cache.get(username)\n    if (userid !== undefined && userid !== null) {\n        uidList = [userid]\n        java.log(`üë§ ÁºìÂ≠ò‰ΩúËÄÖIDÔºö${userid}`)\n    } else {\n        html = java.ajax(urlSearchUser(username))\n        // java.log(html)\n        // ‰ªÖÂåπÈÖçÊúâÊäïÁ®ø‰ΩúÂìÅÁöÑÁî®Êà∑\n        let match = html.match(new RegExp(`\"userIds\":\\\\[(?:(?:\\\\d+,?)+)]`))\n        // java.log(JSON.stringify(match))\n        if (match === null || match.length === 0) {\n            return []\n        }\n\n        match = JSON.stringify(match).replace(\"\\\\\",\"\").split(\",\")\n        // java.log(JSON.stringify(match))\n        let regNumber = new RegExp(\"\\\\d+\")\n        uidList = match.map(v => {\n            return v.match(regNumber)[0]\n        })\n        java.log(`üë§ Ëé∑Âèñ‰ΩúËÄÖIDÔºö${JSON.stringify(uidList)}`)\n    }\n\n    let tempUids = []\n    for (let i in uidList) {\n        let uid = uidList[i]\n        let resp = getAjaxJson(urlUserAllWorks(uid), true)\n        // java.log(urlUserAllWorks(id))\n        // java.log(JSON.stringify(resp))\n        if (resp.error === true) {\n            return []\n        }\n\n        // ‰ªÖËé∑ÂèñÂâç3‰∏™ÊúâÂ∞èËØ¥ÁöÑ‰ΩúËÄÖ\n        let novelIds = Object.keys(resp.body.novels)\n        // java.log(`${uid}-${novelIds.length}`)\n        if (novelIds.length >= 1) tempUids.push(uid)\n        if (tempUids.length === 3) {\n            java.log(`üë§ ÊòæÁ§∫‰ΩúËÄÖIDÔºö${JSON.stringify(tempUids)}`)\n            break\n        }\n\n        // Ëé∑ÂèñÁ≥ªÂàóÂ∞èËØ¥Ôºå‰∏é util.handnovels Á≥ªÂàóËØ¶ÊÉÖÂÖºÂÆπ\n        let seriesIds = []\n        if (resp.body.novelSeries.length >= 1) {\n            resp.body.novelSeries.forEach(novel =>{\n                seriesIds.push(novel.id)\n                novel.textCount = novel.publishedTotalCharacterCount\n                novel.description = novel.caption\n            })\n            novels = novels.concat(resp.body.novelSeries)\n        }\n\n        // Ëé∑ÂèñÊâÄÊúâÁ≥ªÂàóÂÜÖÈÉ®ÁöÑÂ∞èËØ¥ ID\n        let seriesNovelIds = []\n        seriesIds.forEach(seriesId => {\n            let returnList = getAjaxJson(urlSeriesNovelsTitles(seriesId)).body\n            returnList.map(novel => {return seriesNovelIds.push(novel.id)})\n        })\n        // java.log(`ÊúâÁ≥ªÂàóÁöÑÂ∞èËØ¥IDÔºö${JSON.stringify(seriesNovelIds)}`)\n        // java.log(JSON.stringify(seriesNovelIds.length))\n\n        // Ëé∑ÂèñÂçïÁØáÂ∞èËØ¥\n        if (novelIds.length >= 1 && util.settings.IS_LEGADO) {\n            novelIds = novelIds.filter(novelid => (!seriesNovelIds.includes(novelid)))\n            novelIds = novelIds.reverse().slice((page - 1) * 20, page * 20)\n            // java.log(`ÁúüÂçïÁØáÁöÑÂ∞èËØ¥IDÔºö${JSON.stringify(novelIds)}`)\n            // java.log(JSON.stringify(novelIds.length))\n            let novelUrls = novelIds.map(novelId => {return urlNovelDetailed(novelId)})\n            // java.log(JSON.stringify(novelUrls))\n            // cache.delete(novelUrls)\n            novels = novels.concat(getAjaxAllJson(novelUrls).map(resp => resp.body))\n        }\n\n        // // Ëé∑ÂèñÂçïÁØáÂ∞èËØ¥\n        if (novelIds.length >= 1 && util.settings.IS_SOURCE_READ) {\n            novelIds = novelIds.filter(novelid => (!seriesNovelIds.includes(novelid)))\n            // java.log(`ÁúüÂçïÁØáÁöÑÂ∞èËØ¥IDÔºö${JSON.stringify(novelIds)}`)\n            // java.log(JSON.stringify(novelIds.length))\n            novelIds = novelIds.reverse().slice((page - 1) * 20, page * 20)\n            novelIds.forEach(novelId => {\n                // java.log(urlNovelDetailed(novelId))\n                let res = getAjaxJson(urlNovelDetailed(novelId))\n                if (res.error !== true) {\n                    novels.push(res.body)\n                } else {\n                    java.log(JSON.stringify(res))\n                }\n            })\n        }\n    }\n    \n    util.debugFunc(() => {\n        java.log(`Ëé∑ÂèñÁî®Êà∑ÊêúÁ¥¢Â∞èËØ¥ÁªìÊùü`)\n    })\n    return novels\n}\n\nfunction search(name, type, page) {\n    let resp = {}\n    if (type.includes(\"novel\")) {\n        resp = getAjaxJson(urlSearchNovel(name, page))\n        java.log(urlSearchNovel(name, page))\n    }\n    if (type.includes(\"series\")) {\n        resp = getAjaxJson(urlSearchSeries(name, page))\n        java.log(urlSearchSeries(name, page))\n    }\n    if (resp.error === true || resp.total === 0) {\n        return {\"data\": [], \"total\":0, \"lastPage\": 0}\n    }\n    return resp.body.novel\n}\n\nfunction getSeries() {\n    let novels = []\n    let name = String(java.get(\"keyword\"))\n    let maxPages = getFromCache(\"maxPages\")  // ‰ªÖÈªòËÆ§ÊêúÁ¥¢‰ΩøÁî®\n    if (!maxPages) {\n        maxPages = getFromCache(\"seriesMaxPages\")  // ÊêúÁ¥¢Ê†áÁ≠æ‰ΩøÁî®\n        if (!maxPages) maxPages = 1\n        putInCache(\"seriesMaxPages\", maxPages)\n    }\n    java.log(`üìÑ ÊêúÁ¥¢Á≥ªÂàóÊúÄÂ§ßÈ°µÁ†ÅÔºö${maxPages}`)\n\n    if (JSON.parse(result).error === true) {\n        return []\n    }\n    let lastPage = JSON.parse(result).body.novel.lastPage\n    novels = novels.concat(JSON.parse(result).body.novel.data)\n    java.log(urlSearchSeries(name, 1))\n    cache.put(urlSearchSeries(name, 1), result, cacheSaveSeconds)  // Âä†ÂÖ•ÁºìÂ≠ò\n    for (let page = Number(java.get(\"page\")) + 1; page <= lastPage && page <= maxPages; page++) {\n        novels = novels.concat(search(name,\"series\", page).data)\n    }\n    return novels\n}\n\nfunction getNovels() {\n    let novels = []\n    let name = String(java.get(\"keyword\"))\n    let maxPages = getFromCache(\"maxPages\")  // ‰ªÖÈªòËÆ§ÊêúÁ¥¢‰ΩøÁî®\n    if (!maxPages) {\n        maxPages = getFromCache(\"novelsMaxPages\")  // ÊêúÁ¥¢Ê†áÁ≠æ‰ΩøÁî®\n        if (!maxPages) maxPages = 1\n        putInCache(\"novelsMaxPages\", maxPages)\n    }\n    java.log(`üìÑ ÊêúÁ¥¢ÂçïÁØáÊúÄÂ§ßÈ°µÁ†ÅÔºö${maxPages}`)\n\n    let resp = search(name, \"novel\", 1)\n    novels = novels.concat(resp.data)\n    for (let page = Number(java.get(\"page\")) + 1; page <= resp.lastPage && page <= maxPages; page++) {\n        novels = novels.concat(search(name,\"novel\", page).data)\n    }\n    return util.combineNovels(novels)\n}\n\nfunction getConvertNovels() {\n    let novels = []\n    let novelName = String(java.get(\"keyword\"))\n    let name1 = String(java.s2t(novelName))\n    let name2 = String(java.t2s(novelName))\n    if (name1 !== novelName) novels = novels.concat(search(name1, \"novel\", 1).data)\n    if (name2 !== novelName) novels = novels.concat(search(name2, \"novel\", 1).data)\n    novels = util.combineNovels(novels)\n    if (name1 !== novelName) novels = novels.concat(search(name1, \"series\", 1).data)\n    if (name2 !== novelName) novels = novels.concat(search(name2, \"series\", 1).data)\n    return novels\n}\n\nfunction novelFilter(novels) {\n    let textCount = 0, tags = []\n    let limitedTextCount = String(java.get(\"limitedTextCount\")).replace(\"Â≠óÊï∞\", \"\").replace(\"Â≠óÊï∏\", \"\")\n    // limitedTextCount = `3w 3k 3w5 3k5`.[0]\n    if (limitedTextCount.includes(\"w\") || limitedTextCount.includes(\"W\")) {\n        let num = limitedTextCount.toLowerCase().split(\"w\")\n        textCount = 10000 * num[0] + 1000 * num[1]\n    } else if (limitedTextCount.includes(\"k\") || limitedTextCount.includes(\"K\")) {\n        let num = limitedTextCount.toLowerCase().split(\"k\")\n        textCount = 1000 * num[0] + 100 * num[1]\n    }\n\n    let novels0 = novels.map(novel => novel.id)\n    if (textCount >= 1) {\n        novels = novels.filter(novel => novel.textCount >= textCount)\n        let novels1 = novels.map(novel => novel.id)\n        java.log(`üî¢ Â≠óÊï∞ÈôêÂà∂Ôºö${limitedTextCount}`)\n        java.log(`‚è¨ Â≠óÊï∞ÈôêÂà∂ÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels1.length}`)\n    }\n\n    let inputTags = String(java.get(\"inputTags\")).split(\" \")\n    for (let i in inputTags) {\n        let tag = inputTags[i].trim()\n        if (tag !== \"\") tags.push(`${tag}`)\n    }\n\n    if (tags.length >= 1) {\n        // ‰ªÖ‰øùÁïôÂê´ÊúâÊâÄÊúâÊ†áÁ≠æÁöÑÂ∞èËØ¥\n        // novels = novels.filter(novel => {\n        //     // java.log(`${JSON.stringify(novel.tags)}\\n${tags.every(item => novel.tags.includes(item))}`)\n        //     return tags.every(item => novel.tags.includes(item))\n        // })\n        novels = novels.filter(novel => tags.every(item => novel.tags.includes(item)))\n        let novels2 = novels.map(novel => novel.id)\n        java.log(`#Ô∏è‚É£ ËøáÊª§Ê†áÁ≠æÔºö${tags.join(\"„ÄÅ\")}`)\n        java.log(`#Ô∏è‚É£ ËøáÊª§Ê†áÁ≠æÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n    }\n\n    let inputAuthor = String(java.get(\"inputAuthor\")).trim()\n    if (inputAuthor) {\n        // novels = novels.filter(novel => {\n        //     java.log(`${novel.userName}-${novel.userName.includes(inputAuthor)}`)\n        //     return novel.userName.includes(inputAuthor)\n        // })\n        novels = novels.filter(novel => novel.userName.includes(inputAuthor))\n        let novels2 = novels.map(novel => novel.id)\n        java.log(`üë§ ËøáÊª§‰ΩúËÄÖÔºö${tags.join(\"„ÄÅ\")}`)\n        java.log(`üë§ ËøáÊª§‰ΩúËÄÖÔºöËøáÊª§Ââç${novels0.length}ÔºõËøáÊª§Âêé${novels2.length}`)\n    }\n    return novels\n}\n\n(() => {\n    let novels = []\n    let keyword = String(java.get(\"keyword\"))\n    if (keyword.startsWith(\"@\") || keyword.startsWith(\"Ôº†\")) {\n        java.put(\"keyword\", keyword.slice(1))\n        novels = novels.concat(getUserNovels())\n    } else if (keyword.startsWith(\"#\") || keyword.startsWith(\"ÔºÉ\")) {\n        java.put(\"keyword\", keyword.slice(1))\n        // Âà†Èô§ÈªòËÆ§ÊêúÁ¥¢ÊúÄÂ§ßÈ°µÁ†ÅÔºå‰ΩøÁî®ÂÜÖÈÉ®ËÆæÂÆöÁöÑÊúÄÂ§ßÈ°µÁ†Å\n        cache.delete(\"maxPages\")\n        novels = novels.concat(getSeries())\n        novels = novels.concat(getNovels())\n    } else {\n        // ËÆæÁΩÆÈªòËÆ§ÊêúÁ¥¢ÊúÄÂ§ßÈ°µÁ†Å\n        putInCache(\"maxPages\", 1)\n        novels = novels.concat(getSeries())\n        novels = novels.concat(getNovels())\n        if (util.settings.SEARCH_AUTHOR) novels = novels.concat(getUserNovels())\n        if (util.settings.CONVERT_CHINESE) novels = novels.concat(getConvertNovels())\n    }\n    // java.log(JSON.stringify(novels))\n    // ËøîÂõûÁ©∫ÂàóË°®‰∏≠Ê≠¢ÊµÅÁ®ã\n    if (novels.length === 0) {\n        return []\n    }\n    return novelFilter(util.formatNovels(util.handNovels(novels)))\n})()",
            "bookUrl": "detailedUrl",
            "checkKeyWord": "ÊµãËØïÈ°µÈù¢",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "wordCount": "textCount"
        },
        "ruleToc": {
            "chapterList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction urlNovel(novelId){\n    if (util.settings.SHOW_ORIGINAL_LINK) {\n        return urlNovelUrl(novelId)\n    } else {\n        return urlNovelDetailed(novelId)\n    }\n}\n\nfunction oneShotHandler(res) {\n    res.textCount = res.userNovels[`${res.id}`].textCount\n    res.createDate = timeTextFormat(res.createDate)\n    return [{\n        title: res.title.replace(RegExp(/^\\s+|\\s+$/g), \"\"),\n        chapterUrl: urlNovel(res.id),\n        chapterInfo: `${res.createDate}„ÄÄ„ÄÄ${res.textCount}Â≠ó`\n    }]\n}\n\nfunction seriesHandler(res) {\n    const limit = 30\n    let returnList = [], novelIds = []\n    let seriesID = res.id, allChaptersCount = res.total\n    util.debugFunc(() => {\n        java.log(`Êú¨Á≥ªÂàó ${seriesID} ‰∏ÄÂÖ±Êúâ${allChaptersCount}Á´†`);\n    })\n\n    //ÂèëÈÄÅËØ∑Ê±ÇËé∑ÂæóÁõ∏Â∫îÊï∞ÈáèÁöÑÁõÆÂΩïÂàóË°®\n    function sendAjaxForGetChapters(lastIndex) {\n        resp = getAjaxJson(urlSeriesNovels(seriesID, limit, lastIndex), true)\n        res = resp.body.thumbnails.novel\n        // res = resp.body.page.seriesContents\n        res.forEach(v => {\n            v.title = v.title.replace(RegExp(/^\\s+|\\s+$/g), \"\").replace(RegExp(/Ôºà|Ôºâ|-/g), \"\")\n            v.chapterUrl = urlNovel(v.id)\n            novelIds.push(v.id)\n            if (v.updateDate !== undefined) {\n                v.updateDate = timeTextFormat(v.createDate)\n                v.chapterInfo = `${v.updateDate}„ÄÄ„ÄÄ${v.textCount}Â≠ó`\n            } else {\n                v.updateDate = java.timeFormat(v.uploadTimestamp)\n                v.chapterInfo = `${v.updateDate}„ÄÄ„ÄÄ${v.textLength}Â≠ó`\n            }\n            util.debugFunc(() => {\n                java.log(`${v.title}`)\n            })\n        })\n        return res;\n    }\n\n    if (!util.settings.SHOW_UPDATE_TIME) {\n        returnList = getAjaxJson(urlSeriesNovelsTitles(seriesID), true).body\n        returnList.forEach(v => {\n            v.title = v.title.replace(RegExp(/^\\s+|\\s+$/g), \"\").replace(RegExp(/Ôºà|Ôºâ|-/g), \"\")\n            v.chapterUrl = urlNovel(v.id)\n            novelIds.push(v.id)\n        })\n    } else {\n        //ÈÄªËæëÊéßÂà∂ËÄÖ ‰πüÂ∞±ÊòØ‰ΩøÁî®‰∏äÈù¢ÂÆö‰πâÁöÑ‰∏§‰∏™ÂáΩÊï∞Êù•ÂÅöÂØπÂ∫îÂäüËÉΩ\n        //Ë¶ÅÁà¨ÂèñÁöÑÊÄªÊ¨°Êï∞\n        let max = (allChaptersCount / limit) + 1\n        for (let i = 0; i < max; i++) {\n            //java.log(\"iÁöÑÂÄº:\"+i)\n            let list = sendAjaxForGetChapters(i * limit);\n            //ÂèñÂá∫ÊØè‰∏™ÂÄº\n            returnList = returnList.concat(list)\n        }\n    }\n    // ÊîæÂÖ•Â∞èËØ¥‰ø°ÊÅØ‰ª•‰æøÁôªÈôÜÁïåÈù¢‰ΩøÁî®\n    let novel = source.getLoginInfoMap()\n    if (novel === undefined) novel = JSON.parse(cache.get(\"novel\"))\n    novel.novelIds = novelIds\n    cache.put(`novelIds${seriesID}`, JSON.stringify(novelIds), cacheSaveSeconds)\n    // java.log(JSON.stringify(returnList))\n    source.putLoginInfo(JSON.stringify(novel))\n    cache.put(\"novel\", JSON.stringify(novel))\n    return returnList\n}\n\n(function (res) {\n    res = util.getNovelResSeries(result)\n    if (res.firstNovelId === undefined || res.seriesNavData === null) {\n        return oneShotHandler(res)\n    } else {\n        return seriesHandler(res)\n    }\n})()",
            "chapterName": "title",
            "chapterUrl": "chapterUrl",
            "updateTime": "chapterInfo"
        },
        "searchUrl": "@js:\njava.put(\"key\", key)\njava.put(\"page\", page)\nlet keyword = key.split(\" \")\nlet limitedTextCount\nif (key.includes(\"Â≠óÊï∞\") || key.includes(\"Â≠óÊï∏\") ) {\n    limitedTextCount = keyword.pop()\n    keyword = keyword.join(\" \")\n} else {\n    limitedTextCount = \"\"\n    keyword = key\n}\njava.put(\"keyword\", keyword)\njava.put(\"limitedTextCount\", limitedTextCount)\n\nif (keyword.startsWith(\"@\") || keyword.startsWith(\"Ôº†\")) {\n    if (keyword.includes(\"#\") || keyword.includes(\"ÔºÉ\")) {\n        let author = keyword.split(\" \")[0]\n        let tags = keyword.replace(author, \"\").trim().slice(1)\n        java.put(\"keyword\", author)\n        java.put(\"inputTags\", tags)\n        java.log(`üë§ ÊêúÁ¥¢‰ΩúËÄÖÔºö${author} #Ô∏è‚É£ ËøáÊª§Ê†áÁ≠æÔºö${tags.replace(\" \", \"„ÄÅ\")}`)\n    } else {\n        java.put(\"keyword\", keyword)\n        java.log(`üë§ ÊêúÁ¥¢‰ΩúËÄÖÔºö${keyword.slice(1)}`)\n    }\n\n} else if (keyword.startsWith(\"#\") || keyword.startsWith(\"ÔºÉ\")) {\n    keyword = keyword.slice(1)\n    if (keyword.includes(\"@\") || keyword.includes(\"Ôº†\")) {\n        let author = keyword.match(new RegExp(/[@Ôº†](.*)/))\n        keyword = keyword.replace(author[0], \"\").trim()\n        java.put(\"inputAuthor\", author[1])\n        java.log(`#Ô∏è‚É£ ÊêúÁ¥¢Ê†áÁ≠æÔºö${keyword} üë§ ËøáÊª§‰ΩúËÄÖÔºö${author[1]}`)\n    } else {\n        java.log(`#Ô∏è‚É£ ÊêúÁ¥¢Ê†áÁ≠æÔºö${keyword}`)\n    }\n    java.put(\"keyword\", `#${keyword}`)\n\n} else {\n    java.log(`üîç ÊêúÁ¥¢ÂÜÖÂÆπÔºö${keyword}`)\n}\nurlSearchSeries(keyword, page)\n\n// ÂêåÊó∂ÊêúÁ¥¢Â§ö‰∏™ÈìæÊé•ÁöÑÊêúÁ¥¢ÁªìÊûú\n// let li = [\n//     urlSearchSeries(keyword, page),\n//     urlSearchNovel(keyword, page)\n// ]\n// // resp = getAjaxAllJson(li)\n// // resp = resp.map(res => JSON.stringify(res)).join(\",\")\n// resp = java.ajaxAll(li).map(resp => resp.body()).join(\",\")\n// resp = `[${resp}]`",
        "variableComment": "‚öôÔ∏è ‰π¶Ê∫êËÆæÁΩÆÔºö\n‚ñ∂Ô∏è ÁºñËæë‰π¶Ê∫ê - Âü∫Êú¨ - ÂèòÈáèËØ¥Êòé - ‰øÆÊîπÂπ∂‰øùÂ≠ò\n‚öôÔ∏è Ëá™ÂÆö‰πâËÆæÁΩÆÔºöÂ∞Ü true Êîπ‰∏∫ falseÔºåÊàñÁõ∏Âèç\n‚ö†Ô∏è ËÆæÁΩÆÊ∫êÂèòÈáè„ÄêÊó†Ê≥ï„ÄëÊõ¥Êîπ‰π¶Ê∫êËá™ÂÆö‰πâËÆæÁΩÆ\n‚ö†Ô∏è Ê≥®ÊÑè‰∏çË¶ÅÊ∑ªÂä†ÊàñÂà†Èô§Â∞æÈöèÈÄóÂè∑\",\"\n‚ö†Ô∏è Êõ¥Êñ∞ÂèëÁé∞È°µÈúÄË¶ÅÈïøÊåâ\"Pixiv\"ÔºåÊâãÂä®Âà∑Êñ∞\n‰ª•‰∏ãÂÜÖÂÆπ‰∏∫‰π¶Ê∫êËÆæÁΩÆÔºö\n{\n\"SEARCH_AUTHOR\": true,\n\"CONVERT_CHINESE\": true,\n\"SHOW_LIKE_NOVELS\": true,\n\"SHOW_WATCHED_SERIES\": true,\n\n\"SHOW_UPDATE_TIME\": true,\n\"MORE_INFORMATION\": false,\n\"SHOW_ORIGINAL_LINK\": true,\n\n\"REPLACE_TITLE_MARKS\": true,\n\"SHOW_CAPTIONS\": true,\n\"SHOW_COMMENTS\": true,\n\n\"FAST\": false,\n\"DEBUG\": false,\n\n\"SHOW_GENERAL_NEW\": false,\n\"SHOW_GENERAL_RANK\": false,\n\"SHOW_R18_GENRE\": false,\n\"SHOW_GENERAL_GENRE\": false\n}\n\n// SEARCH_AUTHOR\n// ÊêúÁ¥¢ÔºöÈªòËÆ§ÊêúÁ¥¢‰ΩúËÄÖÂêçÁß∞\n// CONVERT_CHINESE\n// ÊêúÁ¥¢ÔºöÊêúÁ¥¢Êó∂ËøõË°åÁπÅÁÆÄËΩ¨Êç¢Ôºå‰ΩÜÊêúÁ¥¢‰ºöÂèòÊÖ¢\n// SHOW_LIKE_NOVELS\n// ÊêúÁ¥¢/ÂèëÁé∞ÔºöÁªìÊûúÊòæÁ§∫Êî∂ËóèÂ∞èËØ¥\n// SHOW_WATCHED_SERIES\n// ÊêúÁ¥¢/ÂèëÁé∞ÔºöÁªìÊûúÊòæÁ§∫ËøΩÊõ¥Á≥ªÂàó\n\n// MORE_INFORMATION\n// ËØ¶ÊÉÖÔºö‰π¶Á±çÁÆÄ‰ªãÊòæÁ§∫Êõ¥Â§ö‰ø°ÊÅØ\n\n// SHOW_UPDATE_TIME\n// ÁõÆÂΩïÔºöÊòæÁ§∫Êõ¥Êñ∞Êó∂Èó¥Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Â∞ëËÆ∏ËØ∑Ê±Ç\n// SHOW_ORIGINAL_LINK\n// ÁõÆÂΩïÔºöÊòæÁ§∫ÂéüÂßãÈìæÊé•Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Â§ßÈáèËØ∑Ê±Ç\n\n// REPLACE_TITLE_MARKS\n// Ê≠£ÊñáÔºöÊ≥®Èü≥ÂÜÖÂÆπ‰∏∫Ê±âÂ≠óÊó∂ÔºåÊõøÊç¢‰∏∫‰π¶ÂêçÂè∑\n// SHOW_CAPTIONS\n// Ê≠£ÊñáÔºöÁ´†È¶ñÊòæÁ§∫Â∞èËØ¥ÊèèËø∞\n// SHOW_COMMENTS\n// Ê≠£ÊñáÔºöÁ´†Â∞æÊòæÁ§∫Â∞èËØ¥ËØÑËÆ∫\n\n// FAST\n// Âø´ÈÄüÊ®°ÂºèÔºåÁ¶ÅÁî®ÁπÅÁÆÄÁªüÊêúÔºå‰∏çÊòæÁ§∫Á´†ËäÇÊù•Ê∫êÈìæÊé•\n// DEBUG\n// Ë∞ÉËØïÊ®°Âºè\n\n// SHOW_GENERAL_NEW\n// ÂèëÁé∞ÔºöÊúÄÊñ∞„ÄÅ‰ºÅÂàí„ÄÅÁ∫¶Á®øÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n// SHOW_GENERAL_RANK\n// ÂèëÁé∞ÔºöÊéíË°åÊ¶úÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n// SHOW_R18_GENRE\n// ÂèëÁé∞ÔºöÁÉ≠Èó®ÂàÜÁ±ªÊòæÁ§∫R18Â∞èËØ¥\n// SHOW_GENERAL_GENRE\n// ÂèëÁé∞ÔºöÁÉ≠Èó®ÂàÜÁ±ªÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n\n",
        "weight": 0
    },
    {
        "bookSourceComment": "üÖøÔ∏è Pixiv Êº´ÁîªÔºàÊõ¥Êñ∞üìÜÔºö2025-10-08Ôºâ\n\n‰π¶Ê∫êÁâàÊú¨Ôºö2.3.8\nÂèØÁî®ÂäüËÉΩÔºö‚úÖÊêúÁ¥¢‚úÖÂèëÁé∞‚úÖÊ∑ªÂä†ÁΩëÂùÄ‚úÖËÆ¢ÈòÖÊ∫ê\nÊêúÁ¥¢ÊèíÁîªÔºö‚úÖÊº´Áîª‚òëÔ∏èÊèíÁîª‚ùåÂä®Âõæ‚úÖÊ†áÁ≠æ\nÂèëÁé∞Êº´ÁîªÔºö‚úÖÂÖ≥Ê≥®‚úÖËøΩÊõ¥‚úÖÊé®Ëçê‚úÖÂèëÁé∞‚úÖÊî∂Ëóè\nÊ∑ªÂä†ÁΩëÂùÄÔºö‚úÖPixivÊèíÁîªÈìæÊé•‚úÖPixivÊº´ÁîªÁõÆÂΩï\nËÆ¢ÈòÖÁî®Ê≥ïÔºöÁÇπÂáªËÆ¢ÈòÖÊ∫êÊâìÂºÄÊèíÁîª/Êº´ÁîªÁõÆÂΩïÔºå„ÄêÂà∑Êñ∞„ÄëÔºåÁÇπÂáª„ÄêÂä†ÂÖ•‰π¶Êû∂„ÄëÊåâÈíÆÔºåÊ∑ªÂä†Âà∞‰π¶Êû∂\n\n‰π¶Ê∫êÂèëÂ∏ÉÔºöÂÖΩ‰∫∫ÈòÖËØªÈ¢ëÈÅì https://t.me/FurryReading\nÈ°πÁõÆÂú∞ÂùÄÔºöhttps://github.com/windyhusky/PixivSource\n‰ΩøÁî®ÊïôÁ®ãÔºöhttps://github.com/windyhusky/PixivSource/blob/main/doc/Pixiv.md\n\nËßÑÂàôËÆ¢ÈòÖÔºöimport ËÆ¢ÈòÖÊ∫ê\nhttps://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/import.json\nhttps://raw.githubusercontent.com/windyhusky/PixivSource/main/import.json\n\n‚öôÔ∏è ‰π¶Ê∫êËÆæÁΩÆÔºö\n‰π¶Ê∫êÁÆ°ÁêÜ - ÁºñËæë‰π¶Ê∫ê - Âü∫Êú¨ - ÂèòÈáèËØ¥Êòé - ‰øÆÊîπÂπ∂‰øùÂ≠ò",
        "bookSourceGroup": "üîû Pixiv Êº´Áîª",
        "bookSourceName": "üÖøÔ∏è Pixiv Êº´Áîª",
        "bookSourceType": 2,
        "bookSourceUrl": "https://www.pixiv.net/manga",
        "bookUrlPattern": "(https?://)?(www\\.)?pixiv\\.net/((artworks|user/\\d+/series)|ajax/(illust|series))/\\d+",
        "concurrentRate": "3/2000",
        "customOrder": 2,
        "enabled": true,
        "enabledCookieJar": true,
        "enabledExplore": true,
        "exploreUrl": "@js:\nlet SHOW_GENERAL_NEW, SHOW_GENERAL_RANK\ntry {\n    settings = JSON.parse(String(source.variableComment).match(RegExp(/{([\\s\\S]*?)}/gm)))\n    SHOW_GENERAL_NEW = settings.SHOW_GENERAL_NEW     // ÂèëÁé∞ÔºöÊúÄÊñ∞„ÄÅ‰ºÅÂàí„ÄÅÁ∫¶Á®øÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n    SHOW_GENERAL_RANK = settings.SHOW_GENERAL_RANK   // ÂèëÁé∞ÔºöÊéíË°åÊ¶úÊòæÁ§∫‰∏ÄËà¨Â∞èËØ¥\n} catch (e) {\n    SHOW_GENERAL_NEW = false\n    SHOW_GENERAL_RANK = false\n}\n\nli = [\n    {\"‚≠êÔ∏è ÂÖ≥Ê≥®\": \"https://www.pixiv.net/ajax/follow_latest/illust?p={{page}}&mode=all&lang=zh\"},\n    {\"üìÉ ËøΩÊõ¥\": \"https://www.pixiv.net/ajax/watch_list/manga?p={{page}}&new=1&lang=zh\"},\n    {\"üíØ Êé®Ëçê\": \"https://www.pixiv.net/ajax/top/illust?mode=all&lang=zh\"},\n    {\"üîç ÂèëÁé∞\": \"https://www.pixiv.net/ajax/illust/discovery?mode=all&lang=zh\"},\n    {\"‚ù§Ô∏è Êî∂Ëóè\": \"https://www.pixiv.net/ajax/user/{{cache.get(\\\"pixiv:uid\\\")}}/illusts/bookmarks?tag=&offset={{(page-1)*24}}&limit=24&rest=show&lang=zh\"},\n    {\"„äôÔ∏è Êî∂Ëóè\": \"https://www.pixiv.net/ajax/user/{{cache.get(\\\"pixiv:uid\\\")}}/illusts/bookmarks?tag=&offset={{(page-1)*24}}&limit=24&rest=hide&lang=zh\"},\n    {\"üè† È¶ñÈ°µ\": \"https://www.pixiv.net\"},\n    {\"üÜô Êõ¥Êñ∞\": \"https://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/pixiv.json\"}\n]\n\ngeneralNew = [\n    {\"üÜï ÊúÄÊñ∞ ‰ºÅÂàí Á∫¶Á®ø üí∞\": \"\"},\n    {\"üÜï ÊúÄÊñ∞\": \"https://www.pixiv.net/ajax/illust/new?lastId=0&limit=20&type=manga&lang=zh\"},\n    {\"üìë ‰ºÅÂàí\": \"https://www.pixiv.net/ajax/user_event/portal/artworks?mode=all&p={{page}}&lang=zh\"},\n    {\"üí∞ Á∫¶Á®ø\": \"https://www.pixiv.net/ajax/commission/page/request/complete/manga?mode=all&p={{page}}&lang=zh\"},\n    {\"üîç ÂèëÁé∞\": \"https://www.pixiv.net/ajax/illust/discovery?mode=all&lang=zh\"}\n]\n\nr18Rank = [\n    {\"üëë ÊéíË°åÊ¶úÂçï üëë\": \"\"},\n    {\"‰ªäÊó•\": \"https://www.pixiv.net/ranking.php?mode=daily_r18&content=manga&p={{page}}&format=json\"},\n    {\"Êú¨Âë®\": \"https://www.pixiv.net/ranking.php?mode=weekly_r18&content=manga&p={{page}}&format=json\"},\n    {\"R18G\": \"https://www.pixiv.net/ranking.php?mode=r18g&content=manga&p={{page}}&format=json\"},\n    {\"Áî∑ÊÄß\": \"https://www.pixiv.net/ranking.php?mode=male_r18\"},\n    {\"Â•≥ÊÄß\": \"https://www.pixiv.net/ranking.php?mode=female_r18\"}\n]\n\ngeneralRank = [\n    {\"üèÜ ÊéíË°åÊ¶úÂçï üèÜ\": \"\"},\n    {\"‰ªäÊó•\": \"https://www.pixiv.net/ranking.php?mode=daily&content=manga&p={{page}}&format=json\"},\n    {\"Êú¨Âë®\": \"https://www.pixiv.net/ranking.php?mode=weekly&content=manga&p={{page}}&format=json\"},\n    {\"Êú¨Êúà\": \"https://www.pixiv.net/ranking.php?mode=monthly&content=manga&p={{page}}&format=json\"},\n    {\"Êñ∞‰∫∫\": \"https://www.pixiv.net/ranking.php?mode=rookie&content=manga&p={{page}}&format=json\"}\n]\n\nif (SHOW_GENERAL_RANK === true) {\n    li = li.concat(generalNew)\n}\nli = li.concat(r18Rank)\nif (SHOW_GENERAL_RANK === true) {\n    li = li.concat(generalRank)\n}\n\nli.forEach(item => {\n    item.title = Object.keys(item)[0]\n    item.url = Object.values(item)[0]\n    delete item[Object.keys(item)[0]]\n    item.style = {}\n    item.style.layout_flexGrow = 1\n    item.style.layout_flexShrink = 1\n    item.style.layout_alignSelf = \"auto\"\n    item.style.layout_wrapBefore = \"false\"\n    if (item.url === \"\") {\n        item.style.layout_flexBasisPercent = 1\n    } else {\n        item.style.layout_flexBasisPercent = -1\n    }\n})\n\nJSON.stringify(li)",
        "header": "{\"referer\":\"https://www.pixiv.net\"}",
        "jsLib": "var util = {}\n\nfunction objStringify(obj) {\n    return JSON.stringify(obj, (n, v) => {\n        if (typeof v == \"function\")\n            return v.toString();\n        return v;\n    });\n}\n\nfunction publicFunc() {\n    let u = {}, settings = {}\n    // ËæìÂá∫‰π¶Ê∫ê‰ø°ÊÅØ\n    java.log(`${source.bookSourceComment.split(\"\\n\")[0]}`)\n    java.log(`üìå ${source.bookSourceComment.split(\"\\n\")[2]}`)\n    java.log(`üìÜ Êõ¥Êñ∞Êó∂Èó¥Ôºö${timeFormat(source.lastUpdateTime)}`)\n\n    settings = JSON.parse(String(source.variableComment).match(RegExp(/{([\\s\\S]*?)}/gm)))\n    if (settings !== null) {\n        java.log(\"‚öôÔ∏è ‰ΩøÁî®Ëá™ÂÆö‰πâËÆæÁΩÆ\")\n    } else {\n        settings = {}\n        settings.CONVERT_CHINESE = true     // ÊêúÁ¥¢ÔºöÊêúÁ¥¢Êó∂ËøõË°åÁπÅÁÆÄËΩ¨Êç¢\n        settings.SEARCH_ILLUSTS = false     // ÊêúÁ¥¢ÊèíÁîª\n        settings.SHOW_ORIGINAL_LINK = true  // ÁõÆÂΩïÂ§ÑÊòæÁ§∫Ê∫êÈìæÊé•Ôºå‰ΩÜ‰ºöÂ¢ûÂä†ËØ∑Ê±ÇÊ¨°Êï∞\n        settings.DEBUG = false              // Ë∞ÉËØïÊ®°Âºè\n        java.log(\"‚öôÔ∏è ‰ΩøÁî®ÈªòËÆ§ËÆæÁΩÆÔºàÊó†Ëá™ÂÆö‰πâËÆæÁΩÆ Êàñ Ëá™ÂÆö‰πâËÆæÁΩÆÊúâËØØÔºâ\")\n    }\n    u.CONVERT_CHINESE = settings.CONVERT_CHINESE\n    u.SEARCH_ILLUSTS = settings.SEARCH_ILLUSTS\n    u.SHOW_ORIGINAL_LINK = settings.SHOW_ORIGINAL_LINK\n    u.DEBUG = settings.DEBUG\n\n    u.debugFunc = (func) => {\n        if (util.DEBUG === true) {\n            func()\n        }\n    }\n\n    // Ëé∑Âèñ Csrf TokenÔºå‰ª•‰æøËøõË°åÊî∂ËóèÁ≠âËØ∑Ê±Ç\n    // Ëé∑ÂèñÊñπÊ≥ïÊù•Ëá™ËÑöÊú¨ Pixiv Previewer\n    // https://github.com/Ocrosoft/PixivPreviewer\n    // https://greasyfork.org/zh-CN/scripts/30766-pixiv-previewer/code\n    u.getCsrfToken = function() {\n        let csfrToken = cache.get(\"csfrToken\")\n        if (!csfrToken) {\n            let html = java.webView(null, \"https://www.pixiv.net/\", null)\n            try {\n                csfrToken = html.match(/token\\\\\":\\\\\"([a-z0-9]{32})/)[1]\n                cache.put(\"csfrToken\", csfrToken)  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n            } catch (e) {\n                csfrToken = null\n                cache.delete(\"csfrToken\")  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n                // sleepToast(\"‚ö†Ô∏è Êú™ÁôªÂΩïË¥¶Âè∑(csfrToken)\")\n            }\n            java.log(`csfrToken:\\n${csfrToken}`)\n        }\n        return csfrToken\n    }\n\n    u.handIllusts = function (illusts) {\n        illusts.forEach(illust => {\n            // illust.id = illust.id\n            // illust.title = illust.title\n            // illust.userName = illust.userName\n            // illust.tags = illust.tags\n            if (!(illust.tags instanceof Array)) {\n                illust.tags = illust.tags.tags.map(item => item.tag)\n                illust.coverUrl = illust.url = illust.urls.regular  // ÂÖºÂÆπÊ≠£ÊñáÊêúÁ¥¢\n                illust.updateDate = illust.uploadDate\n            }\n            illust.textCount = null\n            // illust.pageCount = illust.pageCount\n            // illust.description = illust.description\n            illust.coverUrl = illust.url\n            illust.detailedUrl = urlIllustDetailed(illust.id)\n            // illust.createDate = illust.createDate\n            // illust.updateDate = illust.updateDate\n            // illust.aiType = illust.aiType\n\n            if (illust.seriesNavData === undefined || illust.seriesNavData === null) {\n                illust.latestChapter = illust.title\n            } else {\n                illust.seriesId = illust.seriesNavData.seriesId\n                illust.title = illust.seriesNavData.title\n            }\n\n            if (illust.seriesId !== undefined) {\n                let resp = getAjaxJson(urlSeriesDetailed(illust.seriesId)).body\n                let series = resp.illustSeries.filter(item => item.id === illust.seriesId)[0]\n                // illust.title = illust.title\n                illust.tags = illust.tags.concat(series.tags)\n                illust.latestChapter = resp.thumbnails.illust.filter(item => item.id === series.latestIllustId)[0].title\n                illust.description = series.description\n                if (series.url === undefined) {\n                    let firstChapter = getAjaxJson(urlIllustDetailed(series.firstIllustId)).body\n                    illust.coverUrl = firstChapter.urls.regular\n                    illust.tags = illust.tags.concat(firstChapter.tags.tags.map(item => item.tag))\n                }\n                illust.createDate = series.createDate\n                illust.updateDate = series.updateDate\n                illust.total = series.total\n            }\n        })\n        return illusts\n    }\n\n    u.formatIllusts = function (illusts) {\n        illusts.forEach(illust => {\n            illust.title = illust.title.replace(RegExp(/^\\s+|\\s+$/g), \"\")\n            illust.tags = Array.from(new Set(illust.tags))\n            illust.tags = illust.tags.join(\",\")\n            illust.coverUrl = urlCoverUrl(illust.coverUrl)\n            illust.createDate = dateFormat(illust.createDate)\n            illust.updateDate = dateFormat(illust.updateDate)\n            if (util.MORE_INFORMATION) {\n                illust.description = `\\n‰π¶ÂêçÔºö${illust.title}\\n‰ΩúËÄÖÔºö${illust.userName}\\nÊ†áÁ≠æÔºö${illust.tags}\\nÈ°µÈù¢Ôºö${illust.pageCount}\\n‰∏ä‰º†Ôºö${illust.createDate}\\nÊõ¥Êñ∞Ôºö${illust.updateDate}\\nÁÆÄ‰ªãÔºö${illust.description}`\n            } else {\n                illust.description = `\\n${illust.title}ÔºåÂÖ±${illust.pageCount}È°µ\\n${illust.description}\\n‰∏ä‰º†Êó∂Èó¥Ôºö${illust.createDate}\\nÊõ¥Êñ∞Êó∂Èó¥Ôºö${illust.updateDate}`\n            }\n        })\n        return illusts\n    }\n\n    u.getIllustRes = function (result) {\n        let illustId = 0, res = {}\n        let isJson = isJsonString(result)\n        let isHtml = result.startsWith(\"<!DOCTYPE html>\")\n        if (!isJson && isHtml) {\n            let pattern1 = \"(https?://)?(www\\\\.)?pixiv\\\\.net/(artworks|ajax/illust)/(\\\\d+)\"\n            let isIllust = baseUrl.match(new RegExp(pattern1))\n            let pattern2 = \"(https?://)?(www\\\\.)?pixiv\\\\.net/(user/\\\\d+|ajax)/series/(\\\\d+)\"\n            let isSeries = baseUrl.match(new RegExp(pattern2))\n\n            if (isIllust) {\n                illustId = isIllust[4]\n            } else if (isSeries) {\n                seriesId = isSeries[4]\n                java.log(`ÂåπÈÖçÁ≥ªÂàóIDÔºö${seriesId}`)\n                illustId = getAjaxJson(urlSeriesDetailed(seriesId)).body.page.series.reverse()[0].workId\n            }\n        }\n        if (isJson) {\n            res = JSON.parse(result)\n        }\n\n        if (illustId) {\n            java.log(`ÂåπÈÖçÊèíÁîªIDÔºö${illustId}`)\n            res = getAjaxJson(urlIllustDetailed(illustId))\n        }\n        if (res.error) {\n            java.log(`Êó†Ê≥ï‰ªé Pixiv Ëé∑ÂèñÂΩìÂâçÊº´Áîª`)\n            java.log(JSON.stringify(res))\n            return []\n        }\n        return res.body\n    }\n\n    util = u\n    java.put(\"util\", objStringify(u))\n}\n\n// Ëé∑ÂèñËØ∑Ê±ÇÁöÑuser idÊñπ‰æøÂÖ∂‰ªñajaxËØ∑Ê±ÇÊûÑÈÄ†\nfunction getPixivUid() {\n    let uid = cache.get(\"pixiv:uid\")\n    if (!uid || String(uid) === \"null\") {\n        let html = java.webView(null, \"https://www.pixiv.net/\", null)\n        try {\n            uid = html.match(/user_id:'(\\d+)'/)[1]\n        } catch (e) {\n            uid = null\n        }\n        cache.put(\"pixiv:uid\", String(uid))\n    }\n}\n\npublicFunc()\nif (result.code() === 200) {\n    getPixivUid(); util.getCsrfToken()\n}\njava.getStrResponse(null, null)\nvar cacheSaveSeconds = 7*24*60*60  // ÁºìÂ≠òÊó∂Èó¥7Â§©\n\nfunction cacheGetAndSet(cache, key, supplyFunc) {\n    let v = cache.get(key)\n    // ÁºìÂ≠ò‰ø°ÊÅØÈîôËØØÊó∂Ôºå‰øùÁïô10minÂêéÈáçÊñ∞ËØ∑Ê±Ç\n    if (v && JSON.parse(v).error === true) {\n        if (new Date().getTime() >= JSON.parse(v).timestamp + 10*60*1000) {\n            cache.delete(key)\n            v = cache.get(key)\n        }\n    }\n    // Êó†ÁºìÂ≠ò‰ø°ÊÅØÊó∂ÔºåËøõË°åËØ∑Ê±Ç\n    if (v === undefined || v === null) {\n        v = supplyFunc()\n        v.timestamp = new Date().getTime()\n        v = JSON.stringify(v)\n        cache.put(key, v, cacheSaveSeconds)\n    }\n    return JSON.parse(v)\n}\n\nfunction isHtmlString(str) {\n    return str.startsWith(\"<!DOCTYPE html>\")\n}\nfunction isJsonString(str) {\n    try {\n        if (typeof JSON.parse(str) === \"object\") {\n            return true\n        }\n    } catch(e) {}\n    return false\n}\n\nfunction isLogin() {\n    const {java, cache} = this\n    return !!cache.get(\"csfrToken\")\n}\n\nfunction getAjaxJson(url, forceUpdate) {\n    const {java, cache} = this\n    if (forceUpdate) cache.delete(url)\n    return cacheGetAndSet(cache, url, () => {\n        return JSON.parse(java.ajax(url))\n    })\n}\nfunction getAjaxAllJson(urls, forceUpdate) {\n    const {java, cache} = this\n    if (forceUpdate) cache.delete(urls)\n    return cacheGetAndSet(cache, urls, () => {\n        let result = java.ajaxAll(urls).map(resp => JSON.parse(resp.body()))\n        cache.put(urls, JSON.stringify(result), cacheSaveSeconds)\n        for (let i in urls) cache.put(urls[i], JSON.stringify(result[i]), cacheSaveSeconds)\n        return result\n    })\n}\nfunction getWebviewJson(url, parseFunc) {\n    const {java, cache} = this\n    return cacheGetAndSet(cache, url, () => {\n        let html = java.webView(null, url, null)\n        return JSON.parse(parseFunc(html))\n    })\n}\n\nfunction urlIllustUrl(illustId) {\n    return `https://www.pixiv.net/artworks/${illustId}`\n}\nfunction urlIllustDetailed(illustId) {\n    return `https://www.pixiv.net/ajax/illust/${illustId}?lang=zh`\n}\nfunction urlIllustsDetailed(userId, idList) {\n    return `https://www.pixiv.net/ajax/user/${userId}/illusts?${idList.map(v => \"ids[]=\" + v).join(\"&\")}`\n}\nfunction urlSeriesUrl(userId, seriesId) {\n    return `https://www.pixiv.net/user/${userId}/series/${seriesId}`\n}\nfunction urlSeriesDetailed(seriesId, page=1) {\n    return `https://www.pixiv.net/ajax/series/${seriesId}?p=${page}&lang=zh`\n}\n\nfunction urlUserAllWorks(userId) {\n    return `https://www.pixiv.net/ajax/user/${userId}/profile/all?lang=zh`\n}\n\nfunction urlSearchArtwork(name, page) {\n    return `https://www.pixiv.net/ajax/search/artworks/${encodeURI(name)}?word=${encodeURI(name)}&order=date_d&mode=all&p=${page}&s_mode=s_tc&type=all&lang=zh`\n}\nfunction urlSearchIllust(name, page) {\n    return `https://www.pixiv.net/ajax/search/artworks/${encodeURI(name)}?word=${encodeURI(name)}&order=date_d&mode=all&p=${page}&s_mode=s_tc&type=illust&lang=zh`\n}\nfunction urlSearchManga(name, page) {\n    return `https://www.pixiv.net/ajax/search/artworks/${encodeURI(name)}?word=${encodeURI(name)}&order=date_d&mode=all&p=${page}&s_mode=s_tc&type=manga&lang=zh`\n}\nfunction urlSearchUgoira(name, page) {\n    return `https://www.pixiv.net/ajax/search/artworks/${encodeURI(name)}?word=${encodeURI(name)}&order=date_d&mode=all&p=${page}&s_mode=s_tc&type=ugoira&lang=zh`\n}\n// ÂÆåÂÖ®ÂåπÈÖçÁî®Êà∑Âêç\nfunction urlSearchUser(name) {\n    return `https://www.pixiv.net/search/users?nick=${encodeURI(name)}&s_mode=s_usr&nick_mf=1`\n}\n\nfunction urlCoverUrl(url) {\n    return `${url}, {\"headers\": {\"Referer\":\"https://www.pixiv.net/\"}}`\n}\n\nfunction dateFormat(str) {\n    let addZero = function (num) {\n        return num < 10 ? '0' + num : num;\n    }\n    let time = new Date(str);\n    let Y = time.getFullYear() + \"Âπ¥\";\n    let M = addZero(time.getMonth() + 1) + \"Êúà\";\n    let D = addZero(time.getDate()) + \"Êó•\";\n    return Y + M + D;\n}\nfunction timeFormat(str) {\n    let addZero = function (num) {\n        return num < 10 ? '0' + num : num;\n    }\n    let time = new Date(str);\n    let YY = time.getFullYear()\n    let MM = addZero(time.getMonth() + 1)\n    let DD = addZero(time.getDate())\n    let hh = addZero(time.getHours())\n    let mm = addZero(time.getMinutes())\n    let ss = addZero(time.getSeconds())\n    return `${YY}-${MM}-${DD} ${hh}:${mm}:${ss}`\n}\nfunction timeTextFormat(text) {\n    return `${text.slice(0, 10)} ${text.slice(11, 19)}`\n}\nfunction sleep(time) {\n    let endTime = new Date().getTime() + time\n    while(true){\n        if (new Date().getTime() > endTime){\n            return;\n        }\n    }\n}\nfunction sleepToast(text, second) {\n    const {java} = this\n    java.log(text)\n    java.longToast(text)\n    if (second === undefined || second <= 2) {second = 2}\n    sleep(1000*second)\n}\n\nfunction updateSource() {\n    const {java, source} = this\n    let onlineSource, comment, sourceName, sourceNameCapitalize, index = 0\n    if (source.bookSourceUrl.includes(\"pixiv\")) sourceName = \"pixiv\"\n    else if (source.bookSourceUrl.includes(\"furrynovel\")) sourceName = \"linpx\"\n    sourceNameCapitalize = sourceName[0].toUpperCase() + sourceName.substring(1)\n\n    if (source.bookSourceName.includes(\"Â§áÁî®\")) index = 1\n    else if (source.bookSourceName.includes(\"Êº´Áîª\")) index = 2\n    if (source.bookSourceUrl.includes(\"furrynovel.com\")) {\n        sourceNameCapitalize = \"FurryNovel\"\n        index = 1\n    }\n\n    try {\n        let updateUrl = `https://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/${sourceName}.json`\n        onlineSource = JSON.parse(java.get(updateUrl,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body())[index]\n        comment = onlineSource.bookSourceComment.split(\"\\n\")\n    } catch (e) {\n        try {\n            let updateUrl = `https://raw.githubusercontent.com/windyhusky/PixivSource/main/${sourceName}.json`\n            onlineSource = JSON.parse(java.get(updateUrl,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body())[index]\n            comment = onlineSource.bookSourceComment.split(\"\\n\")\n        } catch (e) {\n            onlineSource = {lastUpdateTime: new Date().getTime()}\n            comment = source.bookSourceComment.split(\"\\n\")\n        }\n    }\n    // comment = source.bookSourceComment.split(\"\\n\")\n    let htm = `data:text/html; charset=utf-8,\n<html>\n<head>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Êõ¥Êñ∞ ${source.bookSourceName} ‰π¶Ê∫ê</title>\n    <style> \n    table { text-align: center; margin: 0 auto; } .ann { display: flex; justify-content: center; align-items: center; height: 5vh; } \n    button { background-color: rgb(76, 175, 80); color: white; border: none; border-radius: 4px; height: 6vh; width: 30vw; overflow: hidden; } \n    button span { cursor: pointer; display: inline-block; position: relative; transition: 0.4s; } \n    button span:after { content: '>'; position: absolute; opacity: 0; top: 0; right: 30px; transition: 0.2s; } \n    button:active span { padding-right: 20px; } \n    button:active span:after { opacity: 1; right: -40px; }\n    </style>\n</head>\n\n<body>\n    <table border=\"1\" cellspacing=\"0\">\n        <th colspan=\"2\"> ${source.bookSourceName} ‰π¶Ê∫ê <a href=\"https://github.com/windyhusky/PixivSource/blob/main/doc/FurryNovel.md\">üî∞ ‰ΩøÁî®ÊåáÂçó</a></th>\n        <tr>\n            <td>‚òÅÔ∏è ËøúÁ®ãÁâàÊú¨Ôºö${onlineSource.bookSourceComment.split(\"\\n\")[2].replace(\"‰π¶Ê∫êÁâàÊú¨Ôºö\", \"\")}</td>\n            <td>üìÜ Êõ¥Êñ∞Ôºö${timeFormat(onlineSource.lastUpdateTime)}</td>\n        </tr>\n        <tr>\n            <td>üì• Êú¨Âú∞ÁâàÊú¨Ôºö${source.bookSourceComment.split(\"\\n\")[2].replace(\"‰π¶Ê∫êÁâàÊú¨Ôºö\", \"\")}</td>\n            <td>üìÜ Êõ¥Êñ∞Ôºö${timeFormat(source.lastUpdateTime)}</td>\n        </tr> \n        <tr><td colspan=\"2\" style=\"text-align: left;\">${comment.slice(3, 8).join(\"<br>\")}</td></tr>\n        <tr><td colspan=\"2\" style=\"text-align: left;\">${comment.slice(comment.length-2, comment.length).join(\"<br>\")}</td></tr>\n    </table>\n    \n    <table border=\"0\" cellspacing=\"20\">\n        <th colspan=\"2\"> Êõ¥Êñ∞ ${source.bookSourceName} ‰π¶Ê∫ê </th>\n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/${sourceName}.json\">\n            <button><span>Êõ¥Êñ∞‰π¶Ê∫ê<br>(Jsdelivr CDN)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/windyhusky/PixivSource@main/btsrk.json\">\n            <button><span>Êõ¥Êñ∞ËÆ¢ÈòÖ<br>(Jsdelivr CDN)</span></button>\n            </a></div></td>\n        </tr>\n        \n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://raw.githubusercontent.com/windyhusky/PixivSource/main/${sourceName}.json\">\n            <button><span>‰π¶Ê∫êÈìæÊé•<br>(GitHub)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://raw.githubusercontent.com/windyhusky/PixivSource/main/btsrk.json\">\n            <button><span>ËÆ¢ÈòÖÈìæÊé•<br>(GitHub)</span></button>\n            </a></div></td>\n        </tr>\n        \n        <tr><td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://codeberg.org/DowneyRem/PixivSource/raw/branch/main/${sourceName}.json\">\n            <button><span>Â§áÁî®‰π¶Ê∫êÈìæÊé•<br>(Codeberg)</span></button>\n            </a></div></td>\n            \n            <td><div class=\"ann\">\n            <a href=\"legado://import/importonline?src=https://codeberg.org/DowneyRem/PixivSource/raw/branch/main/btsrk.json\">\n            <button><span>Â§áÁî®ËÆ¢ÈòÖÈìæÊé•<br>(Codeberg)</span></button>\n            </a></div></td>\n        </tr>\n    </table>\n</body>\n</html>`;\n    java.startBrowser(htm,'Êõ¥Êñ∞‰π¶Ê∫ê');\n    return []\n}",
        "lastUpdateTime": 1759852800251,
        "loginCheckJs": "var util = {}\n\nfunction objStringify(obj) {\n    return JSON.stringify(obj, (n, v) => {\n        if (typeof v == \"function\")\n            return v.toString();\n        return v;\n    });\n}\n\nfunction publicFunc() {\n    let u = {}, settings = {}\n    // ËæìÂá∫‰π¶Ê∫ê‰ø°ÊÅØ\n    java.log(`${source.bookSourceComment.split(\"\\n\")[0]}`)\n    java.log(`üìå ${source.bookSourceComment.split(\"\\n\")[2]}`)\n    java.log(`üìÜ Êõ¥Êñ∞Êó∂Èó¥Ôºö${timeFormat(source.lastUpdateTime)}`)\n\n    settings = JSON.parse(String(source.variableComment).match(RegExp(/{([\\s\\S]*?)}/gm)))\n    if (settings !== null) {\n        java.log(\"‚öôÔ∏è ‰ΩøÁî®Ëá™ÂÆö‰πâËÆæÁΩÆ\")\n    } else {\n        settings = {}\n        settings.CONVERT_CHINESE = true     // ÊêúÁ¥¢ÔºöÊêúÁ¥¢Êó∂ËøõË°åÁπÅÁÆÄËΩ¨Êç¢\n        settings.SEARCH_ILLUSTS = false     // ÊêúÁ¥¢ÊèíÁîª\n        settings.SHOW_ORIGINAL_LINK = true  // ÁõÆÂΩïÂ§ÑÊòæÁ§∫Ê∫êÈìæÊé•Ôºå‰ΩÜ‰ºöÂ¢ûÂä†ËØ∑Ê±ÇÊ¨°Êï∞\n        settings.DEBUG = false              // Ë∞ÉËØïÊ®°Âºè\n        java.log(\"‚öôÔ∏è ‰ΩøÁî®ÈªòËÆ§ËÆæÁΩÆÔºàÊó†Ëá™ÂÆö‰πâËÆæÁΩÆ Êàñ Ëá™ÂÆö‰πâËÆæÁΩÆÊúâËØØÔºâ\")\n    }\n    u.CONVERT_CHINESE = settings.CONVERT_CHINESE\n    u.SEARCH_ILLUSTS = settings.SEARCH_ILLUSTS\n    u.SHOW_ORIGINAL_LINK = settings.SHOW_ORIGINAL_LINK\n    u.DEBUG = settings.DEBUG\n\n    u.debugFunc = (func) => {\n        if (util.DEBUG === true) {\n            func()\n        }\n    }\n\n    // Ëé∑Âèñ Csrf TokenÔºå‰ª•‰æøËøõË°åÊî∂ËóèÁ≠âËØ∑Ê±Ç\n    // Ëé∑ÂèñÊñπÊ≥ïÊù•Ëá™ËÑöÊú¨ Pixiv Previewer\n    // https://github.com/Ocrosoft/PixivPreviewer\n    // https://greasyfork.org/zh-CN/scripts/30766-pixiv-previewer/code\n    u.getCsrfToken = function() {\n        let csfrToken = cache.get(\"csfrToken\")\n        if (!csfrToken) {\n            let html = java.webView(null, \"https://www.pixiv.net/\", null)\n            try {\n                csfrToken = html.match(/token\\\\\":\\\\\"([a-z0-9]{32})/)[1]\n                cache.put(\"csfrToken\", csfrToken)  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n            } catch (e) {\n                csfrToken = null\n                cache.delete(\"csfrToken\")  // ‰∏éÁôªÂΩïËÆæÂ§áÊúâÂÖ≥ÔºåÊó†Ê≥ïÂ≠òÂÇ® nul\n                // sleepToast(\"‚ö†Ô∏è Êú™ÁôªÂΩïË¥¶Âè∑(csfrToken)\")\n            }\n            java.log(`csfrToken:\\n${csfrToken}`)\n        }\n        return csfrToken\n    }\n\n    u.handIllusts = function (illusts) {\n        illusts.forEach(illust => {\n            // illust.id = illust.id\n            // illust.title = illust.title\n            // illust.userName = illust.userName\n            // illust.tags = illust.tags\n            if (!(illust.tags instanceof Array)) {\n                illust.tags = illust.tags.tags.map(item => item.tag)\n                illust.coverUrl = illust.url = illust.urls.regular  // ÂÖºÂÆπÊ≠£ÊñáÊêúÁ¥¢\n                illust.updateDate = illust.uploadDate\n            }\n            illust.textCount = null\n            // illust.pageCount = illust.pageCount\n            // illust.description = illust.description\n            illust.coverUrl = illust.url\n            illust.detailedUrl = urlIllustDetailed(illust.id)\n            // illust.createDate = illust.createDate\n            // illust.updateDate = illust.updateDate\n            // illust.aiType = illust.aiType\n\n            if (illust.seriesNavData === undefined || illust.seriesNavData === null) {\n                illust.latestChapter = illust.title\n            } else {\n                illust.seriesId = illust.seriesNavData.seriesId\n                illust.title = illust.seriesNavData.title\n            }\n\n            if (illust.seriesId !== undefined) {\n                let resp = getAjaxJson(urlSeriesDetailed(illust.seriesId)).body\n                let series = resp.illustSeries.filter(item => item.id === illust.seriesId)[0]\n                // illust.title = illust.title\n                illust.tags = illust.tags.concat(series.tags)\n                illust.latestChapter = resp.thumbnails.illust.filter(item => item.id === series.latestIllustId)[0].title\n                illust.description = series.description\n                if (series.url === undefined) {\n                    let firstChapter = getAjaxJson(urlIllustDetailed(series.firstIllustId)).body\n                    illust.coverUrl = firstChapter.urls.regular\n                    illust.tags = illust.tags.concat(firstChapter.tags.tags.map(item => item.tag))\n                }\n                illust.createDate = series.createDate\n                illust.updateDate = series.updateDate\n                illust.total = series.total\n            }\n        })\n        return illusts\n    }\n\n    u.formatIllusts = function (illusts) {\n        illusts.forEach(illust => {\n            illust.title = illust.title.replace(RegExp(/^\\s+|\\s+$/g), \"\")\n            illust.tags = Array.from(new Set(illust.tags))\n            illust.tags = illust.tags.join(\",\")\n            illust.coverUrl = urlCoverUrl(illust.coverUrl)\n            illust.createDate = dateFormat(illust.createDate)\n            illust.updateDate = dateFormat(illust.updateDate)\n            if (util.MORE_INFORMATION) {\n                illust.description = `\\n‰π¶ÂêçÔºö${illust.title}\\n‰ΩúËÄÖÔºö${illust.userName}\\nÊ†áÁ≠æÔºö${illust.tags}\\nÈ°µÈù¢Ôºö${illust.pageCount}\\n‰∏ä‰º†Ôºö${illust.createDate}\\nÊõ¥Êñ∞Ôºö${illust.updateDate}\\nÁÆÄ‰ªãÔºö${illust.description}`\n            } else {\n                illust.description = `\\n${illust.title}ÔºåÂÖ±${illust.pageCount}È°µ\\n${illust.description}\\n‰∏ä‰º†Êó∂Èó¥Ôºö${illust.createDate}\\nÊõ¥Êñ∞Êó∂Èó¥Ôºö${illust.updateDate}`\n            }\n        })\n        return illusts\n    }\n\n    u.getIllustRes = function (result) {\n        let illustId = 0, res = {}\n        let isJson = isJsonString(result)\n        let isHtml = result.startsWith(\"<!DOCTYPE html>\")\n        if (!isJson && isHtml) {\n            let pattern1 = \"(https?://)?(www\\\\.)?pixiv\\\\.net/(artworks|ajax/illust)/(\\\\d+)\"\n            let isIllust = baseUrl.match(new RegExp(pattern1))\n            let pattern2 = \"(https?://)?(www\\\\.)?pixiv\\\\.net/(user/\\\\d+|ajax)/series/(\\\\d+)\"\n            let isSeries = baseUrl.match(new RegExp(pattern2))\n\n            if (isIllust) {\n                illustId = isIllust[4]\n            } else if (isSeries) {\n                seriesId = isSeries[4]\n                java.log(`ÂåπÈÖçÁ≥ªÂàóIDÔºö${seriesId}`)\n                illustId = getAjaxJson(urlSeriesDetailed(seriesId)).body.page.series.reverse()[0].workId\n            }\n        }\n        if (isJson) {\n            res = JSON.parse(result)\n        }\n\n        if (illustId) {\n            java.log(`ÂåπÈÖçÊèíÁîªIDÔºö${illustId}`)\n            res = getAjaxJson(urlIllustDetailed(illustId))\n        }\n        if (res.error) {\n            java.log(`Êó†Ê≥ï‰ªé Pixiv Ëé∑ÂèñÂΩìÂâçÊº´Áîª`)\n            java.log(JSON.stringify(res))\n            return []\n        }\n        return res.body\n    }\n\n    util = u\n    java.put(\"util\", objStringify(u))\n}\n\n// Ëé∑ÂèñËØ∑Ê±ÇÁöÑuser idÊñπ‰æøÂÖ∂‰ªñajaxËØ∑Ê±ÇÊûÑÈÄ†\nfunction getPixivUid() {\n    let uid = cache.get(\"pixiv:uid\")\n    if (!uid || String(uid) === \"null\") {\n        let html = java.webView(null, \"https://www.pixiv.net/\", null)\n        try {\n            uid = html.match(/user_id:'(\\d+)'/)[1]\n        } catch (e) {\n            uid = null\n        }\n        cache.put(\"pixiv:uid\", String(uid))\n    }\n}\n\npublicFunc()\nif (result.code() === 200) {\n    getPixivUid(); util.getCsrfToken()\n}\njava.getStrResponse(null, null)",
        "loginUrl": "https://accounts.pixiv.net/login",
        "respondTime": 180000,
        "ruleBookInfo": {
            "author": "userName",
            "canReName": "true",
            "coverUrl": "coverUrl",
            "init": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction illustHandler(illust){\n    illust = util.formatIllusts(util.handIllusts([illust]))[0]\n    book.bookUrl = illust.detailedUrl = urlIllustUrl(illust.id)\n    book.tocUrl = illust.catalogUrl = urlIllustDetailed(illust.id)\n    return illust\n}\n\n(() => {\n    return illustHandler(util.getIllustRes(result))\n})()",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title",
            "tocUrl": "catalogUrl"
        },
        "ruleContent": {
            "content": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction getContent(res) {\n    let content = [\"\"]\n    // li = \"mini thumb small regular original\".split(\" \")\n    let illustLink = getAjaxJson(urlIllustDetailed(res.id)).body.urls.regular\n    for (let order = 0; order < res.pageCount; order++) {\n        content.push(`<img src=\"${illustLink}\">`)\n        illustLink = illustLink.replace(`_p${order}`, `_p${order + 1}`)\n    }\n    content = content.join(\"\\n\")\n    return content\n}\n\n(function () {\n    return getContent(util.getIllustRes(result))\n})()",
            "imageStyle": "FULL"
        },
        "ruleExplore": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\nvar seriesSet = new Set();  // Â≠òÂÇ®seriesID ÊúâBUGÊó†Ê≥ïÂ§ÑÁêÜÁøªÈ°µ\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction handlerFactory() {\n    if (baseUrl.includes(\"https://cdn.jsdelivr.net\")) {\n        return () => {updateSource(); return []}\n    }\n    if (!isLogin()) {\n        return handlerNoLogin()\n    }\n    if (baseUrl.includes(\"/follow_latest\")) {\n        return handlerFollowLatest()\n    }\n    if (baseUrl.includes(\"/watch_list\")) {\n        return handlerWatchList()\n    }\n    if (baseUrl.includes(\"/top\")) {\n        return handlerRecommend()\n    }\n    if (baseUrl.includes(\"/discovery\")) {\n        return handlerDiscovery()\n    }\n    if (baseUrl.includes(\"/bookmark\")) {\n        return handlerBookMarks()\n    }\n    if (baseUrl.includes(\"/new\")) {\n        return handlerDiscovery()\n    }\n    if (baseUrl.includes(\"/commission/\")) {\n        return handlerFollowLatest()\n    }\n    if (baseUrl.includes(\"/user_event/portal\")) {\n        return handlerFollowLatest()\n    }\n    // Ê≠£ÂàôÂåπÈÖçÁΩëÂùÄÂÜÖÂÆπ\n    if (baseUrl.includes(\"/ranking\") && (baseUrl.endsWith(\"json\"))) {\n        return handlerRanking()\n    }\n    if (baseUrl.includes(\"/ranking\")) {\n        return handlerRegexIllusts()\n    }\n    else {\n        return []\n    }\n}\n\nfunction handlerNoLogin() {\n    return () => {\n        sleepToast(\"Ê≠§ÂäüËÉΩÈúÄË¶ÅÂú®‰π¶Ê∫êÁôªÂΩïÂêéÊâçËÉΩ‰ΩøÁî®\")\n        sleepToast('ÂèëÁé∞ - ÈïøÊåâ\"Pixiv\" - ÁôªÂΩï - ÁôªÂΩïË¥¶Âè∑')\n        return []\n    }\n}\n\n//ÂÖ≥Ê≥®‰ΩúËÄÖÔºåÊº´ÁîªÂßîÊâòÔºåÊº´Áîª‰ºÅÂàí\nfunction handlerFollowLatest() {\n    return () => {\n        let res = JSON.parse(result)\n        return util.formatIllusts(util.handIllusts(res.body.thumbnails.illust))\n    }\n}\n\n// ËøΩÊõ¥ÂàóË°®\nfunction handlerWatchList() {\n    return () => {\n        let res = JSON.parse(result)\n        // li =  res.body.page.watchedSeriesIds\n        return util.formatIllusts(util.handIllusts(res.body.thumbnails.illust))\n    }\n}\n\n// Êé®ËçêÊº´Áîª\nfunction handlerRecommend() {\n    return () => {\n        let res = JSON.parse(result)\n        const recommend = res.body.page.recommend\n        const illusts = res.body.thumbnails.illust\n        let nidSet = new Set(recommend.ids)\n        // java.log(nidSet.size)\n        let list = illusts.filter(illust => nidSet.has(String(illust.id)))\n        // java.log(`ËøáÊª§ÁªìÊûú:${JSON.stringify(list)}`)\n        return util.formatIllusts(util.handIllusts(list))\n    }\n}\n\n//ÂèëÁé∞Êº´Áîª\nfunction handlerDiscovery() {\n    return () => {\n        let res = JSON.parse(result)\n        return util.formatIllusts(util.handIllusts(res.body.illusts))\n    }\n}\n\n// Êî∂ËóèÊº´Áîª\nfunction handlerBookMarks() {\n    return () => {\n        let res = JSON.parse(result).body.works\n        if (res === undefined || res.length === 0) {\n            //ÊµÅÁ®ãÊó†Ê≥ïÊú¨ÁéØËäÇ‰∏≠Ê≠¢ Âè™ËÉΩ‰∫§Áªô‰∏ã‰∏ÄÊµÅÁ®ãÂ§ÑÁêÜ\n            return []\n        }\n        return util.formatIllusts(util.handIllusts(res))\n    }\n}\n\n// ÊéíË°åÊ¶úÔºåÈ°∫Â∫èÁõ∏Âêå\nfunction handlerRanking() {\n    return () => {\n        let res = JSON.parse(result)\n        res.contents.forEach(item =>{\n            item.id = item.illust_id\n            // item.title = item.title\n            item.userName = item.user_name\n            // item.tags = item.tags\n            item.latestChapter = item.title\n            item.description = null\n            item.coverUrl = item.url\n            item.detailedUrl = urlIllustDetailed(item.id)\n            item.createDate = item.updateDate = item.illust_upload_timestamp * 1000\n\n            if (item.illust_series !== false) {\n                let series = item.illust_series\n                item.seriesId = series.illust_series_id\n                item.order = series.illust_series_content_order\n                item.total = series.illust_series_content_count\n                if (item.order === item.total) item.latestChapter = item.title\n                item.title = series.illust_series_title\n                item.description = series.illust_series_caption\n                item.pageCount = series.illust_page_count\n                item.createDate = item.updateDate = series.illust_series_create_datetime\n            }\n        })\n        return util.formatIllusts(util.handIllusts(res.contents))\n    }\n}\n\n//È¶ñÈ°µÔºåÁºñËæëÈÉ®Êé®ËçêÔºåÈ°∫Â∫èÈöèÊú∫\nfunction handlerRegexIllusts() {\n    return () => {\n        let illustIds = []  // Ê≠£ÂàôËé∑ÂèñÁΩëÂùÄ‰∏≠ÁöÑ illustId\n        let matched = result.match(RegExp(/\\/artworks\\/\\d{5,}/gm))\n        for (let i in matched) {\n            let illustId = matched[i].match(RegExp(/\\d{5,}/))[0]\n            if (illustIds.indexOf(illustId) === -1) {\n                illustIds.push(illustId)\n            }\n        }\n        let userIllusts = getWebviewJson(\n            urlIllustsDetailed(`${cache.get(\"pixiv:uid\")}`, illustIds), html => {\n                return (html.match(new RegExp(\">\\\\{.*?}<\"))[0].replace(\">\", \"\").replace(\"<\", \"\"))\n            }).body\n        return util.formatIllusts(util.handIllusts(Object.values(userIllusts)))\n    }\n}\n\n(() => {\n    return handlerFactory()()\n})()",
            "bookUrl": "detailedUrl",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title"
        },
        "ruleSearch": {
            "author": "userName",
            "bookList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction getManga() {\n    if (JSON.parse(result).error !== true) {\n        cache.put(urlSearchManga(java.get(\"key\"), java.get(\"page\")), result, cacheSaveSeconds)  // Âä†ÂÖ•ÁºìÂ≠ò\n        let illusts = JSON.parse(result).body.illustManga.data\n        illusts.forEach(illust => {illust.tags.unshift(\"Êº´Áîª\")})\n        return illusts\n    } else {\n        return []\n    }\n}\n\nfunction search(name, type, page) {\n    let resp = getAjaxJson(urlSearchManga(name, page))\n    java.log(urlSearchManga(name, page))\n    if (resp.error === true || resp.total === 0) {\n        return {\"data\": [], \"total\":0, \"lastPage\": 0}\n    }\n    return resp.body.illustManga.data\n}\n\nfunction getConvertManga() {\n    let illusts = []\n    let name = String(java.get(\"key\"))\n    let name1 = String(java.s2t(name))\n    let name2 = String(java.t2s(name))\n    if (name1 !== name) illusts = illusts.concat(search(name1, \"series\", 1).data)\n    if (name2 !== name) illusts = illusts.concat(search(name2, \"series\", 1).data)\n    illusts.forEach(illust => {illust.tags.unshift(\"Êº´Áîª\")})\n    return illusts\n}\n\nfunction getIllust() {\n    let MAXPAGES = 3, illusts = []\n    let name = String(java.get(\"key\"))\n    java.log(urlSearchIllust(name, 1))\n    let resp = getAjaxJson(urlSearchIllust(name, 1))\n    if (resp.error === true) {\n        return []\n    }\n    illusts = illusts.concat(resp.body.illustManga.data)\n    for (let page = Number(java.get(\"page\")) + 1; page < resp.body.illustManga.lastPage, page < MAXPAGES; page++) {\n        java.log(`Ê≠£Âú®ÊêúÁ¥¢Á¨¨${page}È°µ`)\n        let resp = getAjaxJson(urlSearchIllust(name, page))\n        if (resp.error === true) {\n            break\n        }\n        illusts = illusts.concat(resp.body.illustManga.data)\n    }\n    illusts.forEach(illust => {illust.tags.unshift(\"ÊèíÁîª\")})\n    return illusts\n}\n\n(() => {\n    let artworks = []\n    artworks = artworks.concat(getManga())\n    if (util.CONVERT_CHINESE) artworks = artworks.concat(getConvertManga())\n    if (util.SEARCH_ILLUSTS) artworks = artworks.concat(getIllust())\n    // java.log(JSON.stringify(artworks))\n    // ËøîÂõûÁ©∫ÂàóË°®‰∏≠Ê≠¢ÊµÅÁ®ã\n    if (artworks.length === 0) {\n        return []\n    }\n    return util.formatIllusts(util.handIllusts(artworks))\n})()",
            "bookUrl": "detailedUrl",
            "checkKeyWord": "ÊµãËØï",
            "coverUrl": "coverUrl",
            "intro": "description",
            "kind": "tags",
            "lastChapter": "latestChapter",
            "name": "title"
        },
        "ruleToc": {
            "chapterList": "@js:\nvar util = objParse(String(java.get(\"util\")))\n\nfunction objParse(obj) {\n    return JSON.parse(obj, (n, v) => {\n        if (typeof v == \"string\" && v.match(\"()\")) {\n            return eval(`(${v})`)\n        }\n        return v;\n    })\n}\n\nfunction urlIllust(novelId){\n    if (util.SHOW_ORIGINAL_LINK) {\n        return urlIllustUrl(novelId)\n    } else {\n        return urlIllustDetailed(novelId)\n    }\n}\n\nfunction oneShotHandler(res) {\n    return [{\n        title: res.title.replace(RegExp(/^\\s+|\\s+$/g), \"\"),\n        chapterUrl: urlIllust(res.id),\n        chapterInfo: `${timeTextFormat(res.createDate)}`\n    }]\n}\n\nfunction seriesHandler(res) {\n    let limit = 12, total = 0, illusts = []\n    let seriesId = res.seriesNavData.seriesId\n    if (res.seriesId === undefined) {\n        total = getAjaxJson(urlSeriesDetailed(res.seriesNavData.seriesId)).body.page.total\n    } else {\n        total = res.total\n    }\n    util.debugFunc(() => {\n        java.log(`Êú¨Á≥ªÂàó ${seriesId} ‰∏ÄÂÖ±Êúâ${total}Á´†`);\n    })\n\n    //Ë¶ÅÁà¨ÂèñÁöÑÊÄªÊ¨°Êï∞\n    let max = (total / limit) + 1\n    for (let page = 1; page < max; page++) {\n        // java.log(urlSeriesDetailed(seriesId, page))\n        res = getAjaxJson(urlSeriesDetailed(seriesId, page)).body\n        let illusts_id = res.page.series.map(item => item.workId)\n        illusts = illusts.concat(res.thumbnails.illust.filter(illust => illusts_id.includes(illust.id)))\n    }\n    illusts.reverse().forEach(illust => {\n        illust.title = illust.title.replace(RegExp(/^\\s+|\\s+$/g), \"\")\n        illust.chapterUrl = urlIllust(illust.id)\n        illust.chapterInfo = timeTextFormat(illust.createDate)\n    })\n    // java.log(JSON.stringify(illusts))\n    return illusts\n}\n\n(() => {\n    let res = util.getIllustRes(result)\n    if (res.seriesNavData !== null) {\n        return seriesHandler(res)\n    } else {\n        return oneShotHandler(res)\n    }\n})()",
            "chapterName": "title",
            "chapterUrl": "chapterUrl",
            "updateTime": "chapterInfo"
        },
        "searchUrl": "@js:\njava.put(\"key\", key)\njava.put(\"page\", page)\njava.log(`üîç ÊêúÁ¥¢ÂÜÖÂÆπÔºö${key}`)\nurlSearchManga(key, page)",
        "variableComment": "‚öôÔ∏è Ëá™ÂÆö‰πâ‰π¶Ê∫êËÆæÁΩÆÔºö\n‚öôÔ∏è Ëá™ÂÆö‰πâËÆæÁΩÆÔºöËØ∑Âú®Âü∫Êú¨-ÂèòÈáèËØ¥ÊòéÂ§Ñ‰øÆÊîπ‰ª£Á†Å\n‚öôÔ∏è Ëá™ÂÆö‰πâËÆæÁΩÆÔºöÂ∞Ü true Êîπ‰∏∫ falseÔºåÊàñÁõ∏Âèç\n‚ö†Ô∏è ËÆæÁΩÆÊ∫êÂèòÈáè„ÄêÊó†Ê≥ï„ÄëÊõ¥Êîπ‰π¶Ê∫êËá™ÂÆö‰πâËÆæÁΩÆ\n‚ö†Ô∏è Ê≥®ÊÑè‰∏çË¶ÅÊ∑ªÂä†ÊàñÂà†Èô§Â∞æÈöèÈÄóÂè∑\",\"\n‚ö†Ô∏è ÂèëÁé∞È°µÈúÄË¶ÅÈïøÊåâ\"Pixiv\"ÔºåÊâãÂä®Âà∑Êñ∞\n‰ª•‰∏ãÂÜÖÂÆπ‰∏∫‰π¶Ê∫êËÆæÁΩÆÔºö\n{\n\"CONVERT_CHINESE\": true,\n\"SEARCH_ILLUSTS\": false,\n\"SHOW_GENERAL_NEW\": false,\n\n\"DEBUG\": false,\n\n\"SHOW_GENERAL_RANK\": false,\n\"SHOW_ORIGINAL_LINK\": true\n}\n\n// CONVERT_CHINESE\n// ÊêúÁ¥¢ÔºöÊêúÁ¥¢Êó∂ËøõË°åÁπÅÁÆÄËΩ¨Êç¢\n// SEARCH_ILLUSTS\n// ÊêúÁ¥¢ÔºöÂêåÊó∂ÊêúÁ¥¢ÊèíÁîª\n// SHOW_ORIGINAL_LINK\n// ÁõÆÂΩïÔºöÊòæÁ§∫Ê∫êÈìæÊé•Ôºå‰ΩÜ‰ºöÂ¢ûÂä†ËØ∑Ê±ÇÊ¨°Êï∞\n\n// DEBUG\n// Ë∞ÉËØïÊ®°Âºè\n\n// SHOW_GENERAL_NEW\n// ÂèëÁé∞ÔºöÊúÄÊñ∞„ÄÅ‰ºÅÂàí„ÄÅÁ∫¶Á®øÊòæÁ§∫‰∏ÄËà¨Êº´Áîª\n// SHOW_GENERAL_RANK\n// ÂèëÁé∞ÔºöÊéíË°åÊ¶úÊòæÁ§∫‰∏ÄËà¨Êº´Áîª\n\n",
        "weight": 0
    }
]